;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="23148e47-2ef2-4919-4e64-110a06c91e7c")}catch(e){}}();
module.exports=[140891,a=>{a.v({actionRow:"widget-styles-module__4VxjhW__actionRow",addBtn:"widget-styles-module__4VxjhW__addBtn",btn:"widget-styles-module__4VxjhW__btn",btnDanger:"widget-styles-module__4VxjhW__btnDanger",btnGhost:"widget-styles-module__4VxjhW__btnGhost",btnLogo:"widget-styles-module__4VxjhW__btnLogo",btnPrimary:"widget-styles-module__4VxjhW__btnPrimary",btnPrimaryBlue:"widget-styles-module__4VxjhW__btnPrimaryBlue",btnSubtitle:"widget-styles-module__4VxjhW__btnSubtitle",btnSuccess:"widget-styles-module__4VxjhW__btnSuccess",btnText:"widget-styles-module__4VxjhW__btnText",btnTitle:"widget-styles-module__4VxjhW__btnTitle",button:"widget-styles-module__4VxjhW__button",chevron:"widget-styles-module__4VxjhW__chevron",companyCheckbox:"widget-styles-module__4VxjhW__companyCheckbox",companyCheckboxChecked:"widget-styles-module__4VxjhW__companyCheckboxChecked",companyFilter:"widget-styles-module__4VxjhW__companyFilter",companyFilterAction:"widget-styles-module__4VxjhW__companyFilterAction",companyFilterActions:"widget-styles-module__4VxjhW__companyFilterActions",companyFilterHeader:"widget-styles-module__4VxjhW__companyFilterHeader",companyFilterTitle:"widget-styles-module__4VxjhW__companyFilterTitle",companyItem:"widget-styles-module__4VxjhW__companyItem",companyItemSelected:"widget-styles-module__4VxjhW__companyItemSelected",companyList:"widget-styles-module__4VxjhW__companyList",companyName:"widget-styles-module__4VxjhW__companyName",companyOrgNr:"widget-styles-module__4VxjhW__companyOrgNr",confirmActions:"widget-styles-module__4VxjhW__confirmActions",confirmDialog:"widget-styles-module__4VxjhW__confirmDialog",confirmMessage:"widget-styles-module__4VxjhW__confirmMessage",confirmOverlay:"widget-styles-module__4VxjhW__confirmOverlay",confirmTitle:"widget-styles-module__4VxjhW__confirmTitle",detailLabel:"widget-styles-module__4VxjhW__detailLabel",detailRow:"widget-styles-module__4VxjhW__detailRow",detailValue:"widget-styles-module__4VxjhW__detailValue",detailValueHighlight:"widget-styles-module__4VxjhW__detailValueHighlight",expanded:"widget-styles-module__4VxjhW__expanded",expandedBody:"widget-styles-module__4VxjhW__expandedBody",expandedHeader:"widget-styles-module__4VxjhW__expandedHeader",expandedTitle:"widget-styles-module__4VxjhW__expandedTitle",expandedVisible:"widget-styles-module__4VxjhW__expandedVisible",fadeIn:"widget-styles-module__4VxjhW__fadeIn",formActions:"widget-styles-module__4VxjhW__formActions",formLabel:"widget-styles-module__4VxjhW__formLabel",formRow:"widget-styles-module__4VxjhW__formRow",headerActions:"widget-styles-module__4VxjhW__headerActions",headerBtn:"widget-styles-module__4VxjhW__headerBtn",input:"widget-styles-module__4VxjhW__input",inputGroup:"widget-styles-module__4VxjhW__inputGroup",loadingSpinner:"widget-styles-module__4VxjhW__loadingSpinner",loadingSpinnerBlue:"widget-styles-module__4VxjhW__loadingSpinnerBlue",logClear:"widget-styles-module__4VxjhW__logClear",logContent:"widget-styles-module__4VxjhW__logContent",logEmpty:"widget-styles-module__4VxjhW__logEmpty",logHeader:"widget-styles-module__4VxjhW__logHeader",logIn:"widget-styles-module__4VxjhW__logIn",logLine:"widget-styles-module__4VxjhW__logLine",logLineError:"widget-styles-module__4VxjhW__logLineError",logLineInfo:"widget-styles-module__4VxjhW__logLineInfo",logLineStep:"widget-styles-module__4VxjhW__logLineStep",logLineSuccess:"widget-styles-module__4VxjhW__logLineSuccess",logLineWarning:"widget-styles-module__4VxjhW__logLineWarning",logMsg:"widget-styles-module__4VxjhW__logMsg",logPanel:"widget-styles-module__4VxjhW__logPanel",logTime:"widget-styles-module__4VxjhW__logTime",logTitle:"widget-styles-module__4VxjhW__logTitle",menu:"widget-styles-module__4VxjhW__menu",menuClose:"widget-styles-module__4VxjhW__menuClose",menuDesc:"widget-styles-module__4VxjhW__menuDesc",menuHeader:"widget-styles-module__4VxjhW__menuHeader",menuIcon:"widget-styles-module__4VxjhW__menuIcon",menuIconBlue:"widget-styles-module__4VxjhW__menuIconBlue",menuItem:"widget-styles-module__4VxjhW__menuItem",menuItems:"widget-styles-module__4VxjhW__menuItems",menuLabel:"widget-styles-module__4VxjhW__menuLabel",menuTitle:"widget-styles-module__4VxjhW__menuTitle",menuTitleIcon:"widget-styles-module__4VxjhW__menuTitleIcon",menuTitleIconBlue:"widget-styles-module__4VxjhW__menuTitleIconBlue",menuTitleIconGreen:"widget-styles-module__4VxjhW__menuTitleIconGreen",menuVisible:"widget-styles-module__4VxjhW__menuVisible",newSchedule:"widget-styles-module__4VxjhW__newSchedule",progress:"widget-styles-module__4VxjhW__progress",progressBar:"widget-styles-module__4VxjhW__progressBar",progressFill:"widget-styles-module__4VxjhW__progressFill",progressFillBlue:"widget-styles-module__4VxjhW__progressFillBlue",progressText:"widget-styles-module__4VxjhW__progressText",progressWithText:"widget-styles-module__4VxjhW__progressWithText",project:"widget-styles-module__4VxjhW__project",projectDetails:"widget-styles-module__4VxjhW__projectDetails",projectExpanded:"widget-styles-module__4VxjhW__projectExpanded",projectHeader:"widget-styles-module__4VxjhW__projectHeader",projectId:"widget-styles-module__4VxjhW__projectId",projectTitle:"widget-styles-module__4VxjhW__projectTitle",projects:"widget-styles-module__4VxjhW__projects",pulse:"widget-styles-module__4VxjhW__pulse",rateLimitWarning:"widget-styles-module__4VxjhW__rateLimitWarning",retryBtn:"widget-styles-module__4VxjhW__retryBtn",scheduleItem:"widget-styles-module__4VxjhW__scheduleItem",scheduleList:"widget-styles-module__4VxjhW__scheduleList",scheduleName:"widget-styles-module__4VxjhW__scheduleName",scheduleTime:"widget-styles-module__4VxjhW__scheduleTime",sectionTitle:"widget-styles-module__4VxjhW__sectionTitle",select:"widget-styles-module__4VxjhW__select",slideDown:"widget-styles-module__4VxjhW__slideDown",spin:"widget-styles-module__4VxjhW__spin",statCard:"widget-styles-module__4VxjhW__statCard",statContent:"widget-styles-module__4VxjhW__statContent",statLabel:"widget-styles-module__4VxjhW__statLabel",statValue:"widget-styles-module__4VxjhW__statValue",statValueOnline:"widget-styles-module__4VxjhW__statValueOnline",statValueSuccess:"widget-styles-module__4VxjhW__statValueSuccess",statsGrid:"widget-styles-module__4VxjhW__statsGrid",statusDot:"widget-styles-module__4VxjhW__statusDot",statusDotOnline:"widget-styles-module__4VxjhW__statusDotOnline",statusDotWorking:"widget-styles-module__4VxjhW__statusDotWorking",statusDotWorkingBlue:"widget-styles-module__4VxjhW__statusDotWorkingBlue",summary:"widget-styles-module__4VxjhW__summary",summaryItem:"widget-styles-module__4VxjhW__summaryItem",summaryItemError:"widget-styles-module__4VxjhW__summaryItemError",summaryItemSuccess:"widget-styles-module__4VxjhW__summaryItemSuccess",toggle:"widget-styles-module__4VxjhW__toggle",toggleActive:"widget-styles-module__4VxjhW__toggleActive",view:"widget-styles-module__4VxjhW__view",widget:"widget-styles-module__4VxjhW__widget",widgetContainer:"widget-styles-module__4VxjhW__widgetContainer"})},814635,a=>{"use strict";var b=a.i(367636),c=a.i(725934),d=a.i(396112),e=a.i(945400),f=a.i(393902),g=a.i(561306);function h(){let{data:a,status:h}=(0,e.useSession)(),[i,j]=(0,d.useState)([]),[k,l]=(0,d.useState)(!1),m=(0,d.useRef)(!1);return((0,d.useEffect)(()=>{(async()=>{if(j((0,g.getLocalFavorites)()),"authenticated"===h&&a?.user&&!m.current)try{let a=await fetch("/api/bolag/favorites");if(a.ok){let b=await a.json();b.favorites&&(j(b.favorites),b.favorites,m.current=!0)}}catch{}l(!0)})()},[a?.user,h]),(0,d.useEffect)(()=>{(async()=>{if("authenticated"!==h||!a?.user||m.current)return;let b=(0,g.getLocalFavorites)();if(0!==b.length)try{let a=await fetch("/api/bolag/favorites");if(a.ok){let b=await a.json();if(b.favorites&&b.favorites.length>0)return}for(let a of b)await fetch("/api/bolag/favorites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgNumber:a.orgNumber,name:a.name})})}catch{}})()},[a?.user,h]),k&&0!==i.length)?(0,b.jsxs)(c.Card,{children:[(0,b.jsx)(c.CardHeader,{className:"pb-3",children:(0,b.jsx)(c.CardTitle,{className:"text-lg",children:"Bevakade bolag"})}),(0,b.jsx)(c.CardContent,{children:(0,b.jsx)("div",{className:"space-y-2",children:i.map(a=>{var c;let d;return(0,b.jsxs)(f.default,{href:`/bolag/${a.orgNumber}`,className:"block p-2 rounded hover:bg-secondary dark:hover:bg-gray-800 transition-colors",children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:10===(d=(c=a.orgNumber).replace(/\D/g,"")).length?`${d.slice(0,6)}-${d.slice(6)}`:c})]},a.orgNumber)})})})]}):null}function i(a){}function j({history:a,onClear:c}){return 0===a.length?null:(0,b.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Senaste sökningar"}),(0,b.jsx)("button",{onClick:c,className:"text-xs text-muted-foreground/70 hover:text-muted-foreground",children:"Rensa"})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:a.map(a=>{var c;let d;return(0,b.jsxs)(f.default,{href:`/bolag/${a.orgNr}`,className:"inline-flex items-center px-3 py-1.5 text-sm bg-secondary rounded-full hover:bg-secondary dark:hover:bg-gray-700 transition-colors",children:[(0,b.jsx)("span",{className:"font-medium truncate max-w-[150px]",children:a.name}),(0,b.jsx)("span",{className:"ml-2 text-muted-foreground/70 text-xs",children:10===(d=(c=a.orgNr).replace(/\D/g,"")).length?`${d.slice(0,6)}-${d.slice(6)}`:c})]},a.orgNr)})})]})}var k=a.i(997074),l=a.i(20663),m=a.i(898184),n=a.i(286808),o=a.i(506415),p=a.i(513041),q=a.i(585255),r=a.i(365279),s=a.i(231758);function t({placeholder:a="Sök företag...",recentSearches:c=[],onSelectResult:e,className:f}){let[g,h]=(0,d.useState)(""),[i,j]=(0,d.useState)([]),[t,u]=(0,d.useState)(!1),[v,w]=(0,d.useState)(!1),[x,y]=(0,d.useState)(-1),[z,A]=(0,d.useState)(null),B=(0,d.useRef)(null),C=(0,d.useRef)(null),D=(0,k.useRouter)();(0,d.useEffect)(()=>{let a=a=>{C.current&&!C.current.contains(a.target)&&w(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),(0,d.useEffect)(()=>{if(g.length<2){j([]),A(null);return}let a=new AbortController,b=setTimeout(async()=>{u(!0),A(null);try{let b=await fetch(`/api/bolag/search?q=${encodeURIComponent(g)}`,{signal:a.signal}),c=await b.json();b.ok?(j(c.results||[]),c.results?.length===0&&A("Inga företag hittades")):A(c.error||"Ett fel uppstod")}catch(a){"AbortError"!==a.name&&A("Ett fel uppstod vid sökning")}finally{u(!1)}},250);return()=>{a.abort(),clearTimeout(b)}},[g]);let E=(0,d.useCallback)(a=>{let b=g.length>=2?i:c;if("ArrowDown"===a.key)a.preventDefault(),y(a=>Math.min(a+1,b.length-1));else if("ArrowUp"===a.key)a.preventDefault(),y(a=>Math.max(a-1,-1));else if("Enter"===a.key){if(a.preventDefault(),x>=0&&b[x])F(b[x]);else if(g.length>=2){let a=g.replace(/\D/g,"");(10===a.length||12===a.length)&&(D.push(`/bolag/${a}`),w(!1))}}else"Escape"===a.key&&(w(!1),B.current?.blur())},[g,i,c,x,D]),F=a=>{e&&e(a),D.push(`/bolag/${a.orgNr}`),w(!1),h("")},G=v&&(g.length>=2||c.length>0),H=g.length>=2,I=H?i:c.slice(0,5);return(0,b.jsxs)("div",{ref:C,className:(0,q.cn)("relative",f),children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(l.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"}),(0,b.jsx)("input",{ref:B,type:"text",value:g,onChange:a=>{h(a.target.value),y(-1),w(!0)},onFocus:()=>w(!0),onKeyDown:E,placeholder:a,className:(0,q.cn)("w-full h-11 pl-10 pr-4 rounded-xl border border-border bg-background","text-sm placeholder:text-muted-foreground","focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent","transition-all duration-200",v&&"ring-2 ring-ring border-transparent")}),t&&(0,b.jsx)(n.Loader2,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground animate-spin"})]}),(0,b.jsx)(s.AnimatePresence,{children:G&&(0,b.jsxs)(r.motion.div,{initial:{opacity:0,y:-8,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.98},transition:{duration:.15,ease:[.25,.1,.25,1]},className:(0,q.cn)("absolute top-full left-0 right-0 mt-2 z-50","rounded-xl border border-border/50 shadow-xl overflow-hidden","bg-background/95 backdrop-blur-xl"),children:[(0,b.jsx)("div",{className:"px-3 py-2 border-b border-border/50",children:(0,b.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:H?t?"Söker...":z||`${i.length} tr\xe4ffar`:(0,b.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(o.Clock,{className:"h-3 w-3"}),"Senaste sökningar"]})})}),(0,b.jsx)("div",{className:"max-h-80 overflow-y-auto",children:I.length>0?(0,b.jsx)("div",{className:"py-1",children:I.map((a,c)=>{var d;let e;return(0,b.jsxs)("button",{onClick:()=>F(a),onMouseEnter:()=>y(c),className:(0,q.cn)("w-full px-3 py-2.5 flex items-center gap-3 text-left transition-colors",x===c?"bg-secondary":"hover:bg-secondary/50"),children:[(0,b.jsx)("div",{className:(0,q.cn)("w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0",x===c?"bg-foreground text-background":"bg-secondary"),children:(0,b.jsx)(m.Building2,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-sm truncate",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[10===(e=(d=a.orgNr).replace(/\D/g,"")).length?`${e.slice(0,6)}-${e.slice(6)}`:d,"location"in a&&a.location&&` • ${a.location}`]})]}),x===c&&(0,b.jsx)(p.ArrowRight,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"})]},a.orgNr)})}):!H||t||z?null:(0,b.jsx)("div",{className:"px-3 py-6 text-center text-sm text-muted-foreground",children:"Inga resultat"})}),(0,b.jsx)("div",{className:"px-3 py-2 border-t border-border/50 bg-secondary/30",children:(0,b.jsxs)("p",{className:"text-[11px] text-muted-foreground",children:[(0,b.jsx)("kbd",{className:"px-1.5 py-0.5 bg-background rounded text-[10px] font-mono",children:"↑↓"})," ","navigera",(0,b.jsx)("span",{className:"mx-2",children:"•"}),(0,b.jsx)("kbd",{className:"px-1.5 py-0.5 bg-background rounded text-[10px] font-mono",children:"↵"})," ","välj",(0,b.jsx)("span",{className:"mx-2",children:"•"}),(0,b.jsx)("kbd",{className:"px-1.5 py-0.5 bg-background rounded text-[10px] font-mono",children:"esc"})," ","stäng"]})})]})})]})}var u=a.i(800873),v=a.i(605948),w=a.i(681042),x=a.i(211454);function y(a,b,c=!0){(0,d.useEffect)(()=>{if(!c)return;function d(c){a.current&&!a.current.contains(c.target)&&b()}let e=setTimeout(()=>{document.addEventListener("mousedown",d)},10);return()=>{clearTimeout(e),document.removeEventListener("mousedown",d)}},[a,b,c])}var z=a.i(140891);function A(){let a=(0,k.useRouter)(),[c,e]=(0,d.useState)("button"),[f,g]=(0,d.useState)("search"),[h,i]=(0,d.useState)("online"),[j,n]=(0,d.useState)(!1),[p,q]=(0,d.useState)(!1),[r,s]=(0,d.useState)(""),[t,A]=(0,d.useState)([]),[B,C]=(0,d.useState)(!1),[D,E]=(0,d.useState)([]),[F,G]=(0,d.useState)([]),[H,I]=(0,d.useState)([]),[J,K]=(0,d.useState)(!1),[L,M]=(0,d.useState)(!1),N=(0,d.useRef)(0),O=(0,d.useRef)(null),P=(0,d.useRef)(null),Q=(0,d.useRef)(null);y(P,()=>{"menu"===c&&U(),"expanded"===c&&Y()},"button"!==c);let R=(0,d.useCallback)((a,b="info")=>{let c=new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),d={id:`log-${++N.current}`,time:c,message:a,type:b};E(a=>[...a.slice(-50),d])},[]);(0,d.useEffect)(()=>{O.current&&(O.current.scrollTop=O.current.scrollHeight)},[D]),(0,d.useEffect)(()=>{try{let a=localStorage.getItem("bolagsverket-recent-searches");if(a){let b=JSON.parse(a);G(b.slice(0,5))}}catch{}},[]),(0,d.useEffect)(()=>{M(B)},[B]);let S=(a,b)=>{let c={orgNr:a,name:b,timestamp:Date.now()};G(b=>{let d=[c,...b.filter(b=>b.orgNr!==a)].slice(0,5);try{localStorage.setItem("bolagsverket-recent-searches",JSON.stringify(d))}catch{}return d})},T=()=>E([]),U=()=>{n(!1),setTimeout(()=>e("button"),250)},V=a=>{n(!1),g(a),setTimeout(()=>{e("expanded"),setTimeout(()=>q(!0),10)},180),i("online")},W=(0,d.useCallback)(async()=>{K(!0);try{let a=await fetch("/api/bevakning");if(a.ok){let b=await a.json();I(b.companies||[])}}catch{}K(!1)},[]);(0,d.useEffect)(()=>{"expanded"===c&&"fetched"===f&&W()},[c,f,W]);let X=async()=>{R("Testar anslutning...","step"),i("working");try{let a=await fetch("/api/health");if(a.ok){let b=await a.json();R("API: OK","success"),R(`Databas: ${"connected"===b.database?"OK":"Fel"}`,"connected"===b.database?"success":"error"),b.proxy&&R(`Proxy: ${"active"===b.proxy.status?"OK":"Inaktiv"}`,"active"===b.proxy.status?"success":"warning"),R("Anslutning verifierad","success")}else R("Anslutning misslyckades","error")}catch{R("Kunde inte nå servern","error")}i("online")},Y=()=>{q(!1),setTimeout(()=>e("button"),220)},Z=(0,d.useCallback)(async(a,b=0)=>{if(!a.trim()||a.length<2)return void A([]);C(!0),i("working"),R(`S\xf6ker: "${a}"...`,"step");try{let b=await fetch(`/api/bolag/search?q=${encodeURIComponent(a.trim())}`);if(!b.ok)throw Error(`API error: ${b.status}`);let c=await b.json();c.results&&c.results.length>0?(A(c.results.slice(0,8)),R(`Hittade ${c.results.length} bolag`,"success")):(A([]),R("Inga bolag hittades","warning"))}catch(d){let c=d instanceof Error?d.message:"Okänt fel";if(b<2)return R(`Fel: ${c}. F\xf6rs\xf6ker igen...`,"warning"),await new Promise(a=>setTimeout(a,1e3)),Z(a,b+1);R(`Fel: ${c}`,"error"),A([])}i("online"),C(!1)},[R]);return(0,b.jsxs)("div",{className:z.default.widget,ref:P,children:["button"===c&&(0,b.jsxs)("button",{className:z.default.button,onClick:()=>{e("menu"),setTimeout(()=>n(!0),10)},disabled:L,children:[(0,b.jsx)("div",{className:z.default.btnLogo,children:(0,b.jsx)("img",{src:"/logos/bolagsverket.png",alt:"Bolagsverket"})}),(0,b.jsx)("span",{className:z.default.btnSubtitle,children:"Bolagssök"}),(0,b.jsx)(u.ChevronRight,{className:`${z.default.chevron} w-4 h-4`}),L&&(0,b.jsx)("div",{className:z.default.loadingSpinner})]}),"menu"===c&&(0,b.jsxs)("div",{className:`${z.default.menu} ${j?z.default.menuVisible:""}`,children:[(0,b.jsxs)("div",{className:z.default.menuHeader,children:[(0,b.jsxs)("div",{className:z.default.menuTitle,children:[(0,b.jsx)("div",{className:`${z.default.menuTitleIcon} ${z.default.menuTitleIconGreen}`,children:(0,b.jsx)(m.Building2,{className:"w-3 h-3"})}),"Bolagsverket"]}),(0,b.jsx)("button",{className:z.default.menuClose,onClick:U,children:(0,b.jsx)(w.X,{className:"w-3.5 h-3.5"})})]}),(0,b.jsxs)("div",{className:z.default.menuItems,children:[(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>V("search"),children:[(0,b.jsx)("div",{className:z.default.menuIcon,children:(0,b.jsx)(l.Search,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Sök bolag"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"Sök på namn eller org.nr"})]})]}),(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>V("fetched"),children:[(0,b.jsx)("div",{className:z.default.menuIcon,children:(0,b.jsx)(m.Building2,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Hämtade bolag"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"Visa bevakade bolag"})]})]}),(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>V("status"),children:[(0,b.jsx)("div",{className:z.default.menuIcon,children:(0,b.jsx)(x.Activity,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Status"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"Anslutning och hälsa"})]})]})]})]}),"expanded"===c&&(0,b.jsxs)("div",{className:`${z.default.expanded} ${p?z.default.expandedVisible:""}`,children:[(0,b.jsxs)("div",{className:z.default.expandedHeader,children:[(0,b.jsxs)("div",{className:z.default.expandedTitle,children:[(0,b.jsx)("div",{className:`${z.default.statusDot} ${"online"===h?z.default.statusDotOnline:"working"===h?z.default.statusDotWorking:""}`}),(0,b.jsx)("span",{children:"search"===f?"Sök bolag":"fetched"===f?"Hämtade bolag":"Status"})]}),(0,b.jsxs)("div",{className:z.default.headerActions,children:[(0,b.jsx)("button",{className:z.default.headerBtn,onClick:()=>{q(!1),setTimeout(()=>{e("menu"),setTimeout(()=>n(!0),10)},220)},children:(0,b.jsx)(v.ChevronLeft,{className:"w-3.5 h-3.5"})}),(0,b.jsx)("button",{className:z.default.headerBtn,onClick:Y,children:(0,b.jsx)(w.X,{className:"w-3.5 h-3.5"})})]})]}),(0,b.jsxs)("div",{className:z.default.expandedBody,children:["search"===f&&(0,b.jsxs)("div",{className:z.default.view,children:[(0,b.jsxs)("div",{className:z.default.inputGroup,children:[(0,b.jsx)("input",{type:"text",className:z.default.input,placeholder:"Företagsnamn eller org.nr...",value:r,onChange:a=>{var b;s(b=a.target.value),Q.current&&clearTimeout(Q.current),b.length>=2?Q.current=setTimeout(()=>{Z(b)},300):A([])},onKeyDown:a=>"Enter"===a.key&&Z(r),autoFocus:!0}),(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnPrimary}`,onClick:()=>Z(r),disabled:B||r.length<2,children:B?"...":"Sök"})]}),t.length>0&&(0,b.jsxs)("div",{className:z.default.projects,children:[(0,b.jsxs)("div",{className:z.default.sectionTitle,children:[(0,b.jsx)(m.Building2,{className:"w-3.5 h-3.5"}),"Resultat (",t.length,")"]}),t.map(c=>(0,b.jsx)("div",{className:z.default.project,onClick:()=>{S(c.orgNr,c.name),R(`\xd6ppnar: ${c.name}`,"success"),Y(),a.push(`/bolag/${c.orgNr}`)},children:(0,b.jsxs)("div",{className:z.default.projectHeader,children:[(0,b.jsx)("div",{className:z.default.projectTitle,children:c.name}),(0,b.jsx)("div",{className:z.default.projectId,children:c.orgNr})]})},c.orgNr))]}),0===t.length&&F.length>0&&!r&&(0,b.jsxs)("div",{className:z.default.projects,children:[(0,b.jsxs)("div",{className:z.default.sectionTitle,children:[(0,b.jsx)(o.Clock,{className:"w-3.5 h-3.5"}),"Senaste sökningar"]}),F.map(c=>(0,b.jsx)("div",{className:z.default.project,onClick:()=>{S(c.orgNr,c.name),Y(),a.push(`/bolag/${c.orgNr}`)},children:(0,b.jsxs)("div",{className:z.default.projectHeader,children:[(0,b.jsx)("div",{className:z.default.projectTitle,children:c.name}),(0,b.jsx)("div",{className:z.default.projectId,children:c.orgNr})]})},c.orgNr))]}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),D.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:T,children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,ref:O,children:0===D.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Sök efter ett företag för att se aktivitet"}):D.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]}),"fetched"===f&&(0,b.jsxs)("div",{className:z.default.view,children:[J?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Laddar bolag..."}):0===H.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Inga bevakade bolag ännu"}):(0,b.jsxs)("div",{className:z.default.projects,children:[(0,b.jsxs)("div",{className:z.default.sectionTitle,children:[(0,b.jsx)(m.Building2,{className:"w-3.5 h-3.5"}),"Bevakade bolag (",H.length,")"]}),H.map(c=>(0,b.jsx)("div",{className:z.default.project,onClick:()=>{Y(),a.push(`/bolag/${c.orgNumber}`)},children:(0,b.jsxs)("div",{className:z.default.projectHeader,children:[(0,b.jsx)("div",{className:z.default.projectTitle,children:c.name}),(0,b.jsx)("div",{className:z.default.projectId,children:c.orgNumber})]})},c.id))]}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),D.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:T,children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,ref:O,children:0===D.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Ingen aktivitet"}):D.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]}),"status"===f&&(0,b.jsxs)("div",{className:z.default.view,children:[(0,b.jsxs)("div",{className:z.default.statsGrid,children:[(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(x.Activity,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"API"}),(0,b.jsx)("div",{className:`${z.default.statValue} ${z.default.statValueOnline}`,children:"Ansluten"})]})]}),(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(m.Building2,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"Bevakade"}),(0,b.jsx)("div",{className:z.default.statValue,children:H.length})]})]})]}),(0,b.jsx)("div",{className:z.default.actionRow,children:(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnGhost}`,onClick:X,children:"Testa anslutning"})}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),D.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:T,children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,ref:O,children:0===D.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Ingen aktivitet"}):D.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]})]})]})]})}var B=a.i(345697);let C=(0,a.i(331969).default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var D=a.i(630384),E=a.i(742352),F=a.i(418900);function G(){let[a,c]=(0,d.useState)("button"),[e,f]=(0,d.useState)("search"),[g,h]=(0,d.useState)("online"),[i,j]=(0,d.useState)(!1),[k,n]=(0,d.useState)(!1),[p,q]=(0,d.useState)(""),[r,s]=(0,d.useState)([]),[t,A]=(0,d.useState)(0),[G,H]=(0,d.useState)(!1),[I,J]=(0,d.useState)([]),[K,L]=(0,d.useState)(null),[M,N]=(0,d.useState)(null),[O,P]=(0,d.useState)([]),[Q,R]=(0,d.useState)(!1),[S,T]=(0,d.useState)(0),[U,V]=(0,d.useState)("--:--"),[W,X]=(0,d.useState)([]),[Y,Z]=(0,d.useState)([]),[$,_]=(0,d.useState)(!1),aa=(0,d.useRef)(0),ab=(0,d.useRef)(null),ac=(0,d.useRef)(null),ad=(0,d.useRef)(!1);y(ac,()=>{"menu"===a&&ah(),"expanded"===a&&aj()},"button"!==a);let ae=(0,d.useCallback)((a,b,c="info")=>{let d=new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),e={id:`log-${++aa.current}`,time:d,message:b,type:c};"search"===a?J(a=>[...a.slice(-50),e]):"batch"===a?P(a=>[...a.slice(-50),e]):Z(a=>[...a.slice(-50),e])},[]);(0,d.useEffect)(()=>{ab.current&&(ab.current.scrollTop=ab.current.scrollHeight)},[I,O,Y]);let af=(0,d.useCallback)(async()=>{try{let a=await fetch("/api/bevakning");if(a.ok){let b=await a.json();X(b.companies||[])}}catch(a){console.error("Failed to fetch watched companies:",a)}},[]);(0,d.useEffect)(()=>{"expanded"===a&&"batch"===e&&af()},[a,e,af]),(0,d.useEffect)(()=>{_(G||Q)},[G,Q]);let ag=a=>{"search"===a?J([]):"batch"===a?P([]):Z([])},ah=()=>{j(!1),setTimeout(()=>c("button"),250)},ai=a=>{j(!1),f(a),setTimeout(()=>{c("expanded"),setTimeout(()=>n(!0),10)},180),h("online")},aj=()=>{n(!1),setTimeout(()=>c("button"),220)},ak=async(a=0)=>{if(p.trim()){H(!0),h("working"),s([]),L(null),A(0),N(null),ae("search",`Initierar s\xf6kning...`,"step"),await al(200),A(10),ae("search","Ansluter till Vinnova API...","step"),await al(300),A(25),ae("search",`S\xf6ker: "${p}"`,"info"),A(40);try{let a=new URLSearchParams;a.set("company",p.trim()),ae("search",`H\xe4mtar projektdata...`,"step");let b=await fetch(`/api/bolag/vinnova?${a.toString()}`);if(A(70),!b.ok)throw Error(`API error: ${b.status}`);ae("search","Bearbetar resultat...","step");let c=await b.json();if(A(90),await al(200),c.projects&&c.projects.length>0){let a=c.projects.slice(0,10);s(a);let b=a.reduce((a,b)=>a+(b.vinnovaBidrag||0),0);ae("search",`Hittade ${c.projects.length} projekt`,"success"),b>0&&ae("search",`Total finansiering: ${am(b)}`,"info")}else ae("search","Inga Vinnova-projekt hittades för detta bolag","warning");A(100)}catch(c){let b=c instanceof Error?c.message:"Okänt fel";if(a<2)return ae("search",`Fel: ${b}. F\xf6rs\xf6ker igen...`,"warning"),await al(1e3),ak(a+1);ae("search",`Fel: ${b}`,"error"),N(b)}await al(300),h("online"),H(!1),setTimeout(()=>A(0),500)}},al=a=>new Promise(b=>setTimeout(b,a)),am=a=>a>=1e6?`${(a/1e6).toFixed(1)} MSEK`:new Intl.NumberFormat("sv-SE",{style:"currency",currency:"SEK",maximumFractionDigits:0}).format(a),an=async()=>{ae("status","Testar anslutning...","step"),h("working"),await al(500);try{(await fetch("/api/health")).ok?(ae("status","API: OK","success"),ae("status","Databas: OK","success"),ae("status","Anslutning verifierad","success")):ae("status","Anslutning misslyckades","error")}catch{ae("status","Kunde inte nå servern","error")}h("online")},ao=async()=>{if(Q){ad.current=!1,R(!1),ae("batch","Avbruten av användare","warning"),h("online"),T(0);return}let a=W;if(0===a.length){ae("batch","Hämtar bevakade bolag...","step");try{let b=await fetch("/api/bevakning");b.ok&&(a=(await b.json()).companies||[],X(a))}catch{ae("batch","Kunde inte hämta bevakade bolag","error");return}}if(0===a.length)return void ae("batch","Inga bevakade bolag att söka","warning");ad.current=!0,R(!0),ae("batch",`Startar s\xf6kning f\xf6r ${a.length} bolag...`,"step"),h("working"),T(0);let b=0,c=0;for(let d=0;d<a.length&&ad.current;d++){let e=a[d],f=(d+1)/a.length*100;ae("batch",`S\xf6ker: ${e.name}...`,"info"),T(f-5);try{let a=await fetch(`/api/bolag/vinnova?company=${encodeURIComponent(e.name)}`);if(!ad.current)break;if(a.ok){let d=await a.json(),f=d.projects?.length||0;f>0?(ae("batch",`${e.name}: ${f} projekt`,"success"),c+=f):ae("batch",`${e.name}: Inga projekt`,"info"),b++}else ae("batch",`${e.name}: API-fel`,"warning")}catch{ae("batch",`${e.name}: Misslyckades`,"error")}T(f),ad.current&&d<a.length-1&&await al(500)}ad.current&&(ae("batch",`K\xf6rning slutf\xf6rd: ${b}/${a.length} bolag, ${c} projekt`,"success"),V(new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"}))),ad.current=!1,R(!1),h("online"),setTimeout(()=>T(0),1e3)};return(0,d.useEffect)(()=>()=>{ad.current=!1},[]),(0,b.jsxs)("div",{className:z.default.widget,ref:ac,children:["button"===a&&(0,b.jsxs)("button",{className:z.default.button,onClick:()=>{c("menu"),setTimeout(()=>j(!0),10)},disabled:$,children:[(0,b.jsx)("div",{className:z.default.btnLogo,children:(0,b.jsx)("img",{src:"/logos/vinnova.png",alt:"Vinnova"})}),(0,b.jsx)("span",{className:z.default.btnSubtitle,children:"Innovationsprojekt"}),(0,b.jsx)(u.ChevronRight,{className:`${z.default.chevron} w-4 h-4`}),$&&(0,b.jsx)("div",{className:z.default.loadingSpinner})]}),"menu"===a&&(0,b.jsxs)("div",{className:`${z.default.menu} ${i?z.default.menuVisible:""}`,children:[(0,b.jsxs)("div",{className:z.default.menuHeader,children:[(0,b.jsxs)("div",{className:z.default.menuTitle,children:[(0,b.jsx)("div",{className:`${z.default.menuTitleIcon} ${z.default.menuTitleIconGreen}`,children:(0,b.jsx)(D.Zap,{className:"w-3 h-3"})}),"Vinnova Scraper"]}),(0,b.jsx)("button",{className:z.default.menuClose,onClick:ah,children:(0,b.jsx)(w.X,{className:"w-3.5 h-3.5"})})]}),(0,b.jsxs)("div",{className:z.default.menuItems,children:[(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>ai("search"),children:[(0,b.jsx)("div",{className:z.default.menuIcon,children:(0,b.jsx)(l.Search,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Sök projekt"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"Hitta Vinnova-projekt för företag"})]})]}),(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>ai("batch"),children:[(0,b.jsx)("div",{className:z.default.menuIcon,children:(0,b.jsx)(F.RefreshCw,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Sök alla bevakade"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"Kör sökning för alla bevakade bolag"})]})]}),(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>ai("status"),children:[(0,b.jsx)("div",{className:z.default.menuIcon,children:(0,b.jsx)(x.Activity,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Status"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"Anslutning och hälsa"})]})]})]})]}),"expanded"===a&&(0,b.jsxs)("div",{className:`${z.default.expanded} ${k?z.default.expandedVisible:""}`,children:[(0,b.jsxs)("div",{className:z.default.expandedHeader,children:[(0,b.jsxs)("div",{className:z.default.expandedTitle,children:[(0,b.jsx)("div",{className:`${z.default.statusDot} ${"online"===g?z.default.statusDotOnline:"working"===g?z.default.statusDotWorking:""}`}),(0,b.jsx)("span",{children:{search:"Sök projekt",batch:"Sök alla bevakade",status:"Status"}[e]})]}),(0,b.jsxs)("div",{className:z.default.headerActions,children:[(0,b.jsx)("button",{className:z.default.headerBtn,onClick:()=>{n(!1),setTimeout(()=>{c("menu"),setTimeout(()=>j(!0),10)},220)},children:(0,b.jsx)(v.ChevronLeft,{className:"w-3.5 h-3.5"})}),(0,b.jsx)("button",{className:z.default.headerBtn,onClick:aj,children:(0,b.jsx)(w.X,{className:"w-3.5 h-3.5"})})]})]}),(0,b.jsxs)("div",{className:z.default.expandedBody,children:["search"===e&&(0,b.jsxs)("div",{className:z.default.view,children:[(0,b.jsxs)("div",{className:z.default.inputGroup,children:[(0,b.jsx)("input",{type:"text",className:z.default.input,placeholder:"Sök bolagsnamn...",value:p,onChange:a=>q(a.target.value),onKeyDown:a=>"Enter"===a.key&&ak()}),(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnPrimary}`,onClick:()=>ak(),disabled:G,children:G?"...":"Sök"})]}),M&&(0,b.jsxs)("button",{className:z.default.retryBtn,onClick:()=>{N(null),ak()},children:[(0,b.jsx)(F.RefreshCw,{className:"w-3.5 h-3.5"}),"Försök igen"]}),t>0&&(0,b.jsx)("div",{className:z.default.progress,children:(0,b.jsx)("div",{className:z.default.progressBar,children:(0,b.jsx)("div",{className:z.default.progressFill,style:{width:`${t}%`}})})}),r.length>0&&(0,b.jsxs)("div",{className:z.default.projects,children:[(0,b.jsxs)("div",{className:z.default.sectionTitle,children:[(0,b.jsx)(E.FileText,{className:"w-3.5 h-3.5"}),"Projekt (",r.length,")"]}),r.map(a=>(0,b.jsxs)("div",{className:`${z.default.project} ${K===a.diarienummer?z.default.projectExpanded:""}`,onClick:()=>L(K===a.diarienummer?null:a.diarienummer),children:[(0,b.jsxs)("div",{className:z.default.projectHeader,children:[(0,b.jsx)("div",{className:z.default.projectTitle,children:a.titel||a.diarienummer}),(0,b.jsx)("div",{className:z.default.projectId,children:a.diarienummer})]}),K===a.diarienummer&&(0,b.jsxs)("div",{className:z.default.projectDetails,children:[a.programnamn&&(0,b.jsxs)("div",{className:z.default.detailRow,children:[(0,b.jsx)("span",{className:z.default.detailLabel,children:"Program"}),(0,b.jsx)("span",{className:z.default.detailValue,children:a.programnamn})]}),a.koordinator&&(0,b.jsxs)("div",{className:z.default.detailRow,children:[(0,b.jsx)("span",{className:z.default.detailLabel,children:"Koordinator"}),(0,b.jsx)("span",{className:z.default.detailValue,children:a.koordinator})]}),a.vinnovaBidrag&&(0,b.jsxs)("div",{className:z.default.detailRow,children:[(0,b.jsx)("span",{className:z.default.detailLabel,children:"Bidrag"}),(0,b.jsx)("span",{className:`${z.default.detailValue} ${z.default.detailValueHighlight}`,children:am(a.vinnovaBidrag)})]}),a.totalbudget&&(0,b.jsxs)("div",{className:z.default.detailRow,children:[(0,b.jsx)("span",{className:z.default.detailLabel,children:"Total budget"}),(0,b.jsx)("span",{className:z.default.detailValue,children:am(a.totalbudget)})]})]})]},a.diarienummer))]}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),I.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:()=>ag("search"),children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,ref:ab,children:0===I.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Sök efter ett bolag för att se aktivitet"}):I.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]}),"batch"===e&&(0,b.jsxs)("div",{className:z.default.view,children:[(0,b.jsxs)("div",{className:z.default.statsGrid,children:[(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(m.Building2,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"Bevakade"}),(0,b.jsx)("div",{className:z.default.statValue,children:W.length||"..."})]})]}),(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(o.Clock,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"Senaste"}),(0,b.jsx)("div",{className:z.default.statValue,children:U})]})]})]}),(0,b.jsx)("div",{className:z.default.actionRow,children:(0,b.jsx)("button",{className:`${z.default.btn} ${Q?z.default.btnDanger:z.default.btnSuccess}`,onClick:ao,style:{flex:1},children:Q?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(C,{className:"w-3.5 h-3.5"}),"Stoppa"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(B.Play,{className:"w-3.5 h-3.5"}),"Starta sökning"]})})}),S>0&&(0,b.jsx)("div",{className:z.default.progress,children:(0,b.jsx)("div",{className:z.default.progressBar,children:(0,b.jsx)("div",{className:z.default.progressFill,style:{width:`${S}%`}})})}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),O.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:()=>ag("batch"),children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,children:0===O.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Starta sökning för att se aktivitet"}):O.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]}),"status"===e&&(0,b.jsxs)("div",{className:z.default.view,children:[(0,b.jsxs)("div",{className:z.default.statsGrid,children:[(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(x.Activity,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"API"}),(0,b.jsx)("div",{className:`${z.default.statValue} ${z.default.statValueOnline}`,children:"Ansluten"})]})]}),(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(m.Building2,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"Bevakade"}),(0,b.jsx)("div",{className:z.default.statValue,children:W.length})]})]})]}),(0,b.jsx)("div",{className:z.default.actionRow,children:(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnGhost}`,onClick:an,children:"Testa anslutning"})}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),Y.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:()=>ag("status"),children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,ref:ab,children:0===Y.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Starta en körning för att se aktivitet"}):Y.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]})]})]})]})}var H=a.i(620341),I=a.i(572773),J=a.i(345543),K=a.i(137079);function L(){let a=(0,k.useRouter)(),[c,e]=(0,d.useState)("button"),[f,g]=(0,d.useState)("search"),[h,i]=(0,d.useState)("online"),[j,n]=(0,d.useState)(!1),[p,q]=(0,d.useState)(!1),[r,s]=(0,d.useState)(""),[t,A]=(0,d.useState)([]),[D,E]=(0,d.useState)(!1),[G,L]=(0,d.useState)([]),M=(0,d.useRef)(null),[N,O]=(0,d.useState)(!1),[P,Q]=(0,d.useState)(0),[R,S]=(0,d.useState)([]),[T,U]=(0,d.useState)({total:0,enriched:0,failed:0,skipped:0}),[V,W]=(0,d.useState)("--:--"),[X,Y]=(0,d.useState)([]),[Z,$]=(0,d.useState)(new Set),[_,aa]=(0,d.useState)(!1),[ab,ac]=(0,d.useState)(!1),[ad,ae]=(0,d.useState)(!1),[af,ag]=(0,d.useState)(null),[ah,ai]=(0,d.useState)(!1),aj=(0,d.useRef)(0),ak=(0,d.useRef)(null),al=(0,d.useRef)(null),am=(0,d.useRef)(null);y(am,()=>{"menu"===c&&as(),"expanded"===c&&au()},"button"!==c);let an=(0,d.useCallback)((a,b="info")=>{let c=new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),d={id:`log-${++aj.current}`,time:c,message:a,type:b};S(a=>[...a.slice(-100),d])},[]);(0,d.useEffect)(()=>{ak.current&&(ak.current.scrollTop=ak.current.scrollHeight)},[R]),(0,d.useEffect)(()=>{ai(N||D)},[N,D]),(0,d.useEffect)(()=>{try{let a=localStorage.getItem("allabolag-recent-searches");if(a){let b=JSON.parse(a);L(b.slice(0,5))}}catch{}},[]);let ao=(a,b)=>{let c={orgNr:a,name:b,timestamp:Date.now()};L(b=>{let d=[c,...b.filter(b=>b.orgNr!==a)].slice(0,5);try{localStorage.setItem("allabolag-recent-searches",JSON.stringify(d))}catch{}return d})},ap=(0,d.useCallback)(async(a,b=0)=>{if(!a.trim()||a.length<2)return void A([]);E(!0),i("working"),an(`S\xf6ker: "${a}"...`,"step");try{let b=await fetch(`/api/bolag/search?q=${encodeURIComponent(a.trim())}`);if(!b.ok)throw Error(`API error: ${b.status}`);let c=await b.json();c.results&&c.results.length>0?(A(c.results.slice(0,8)),an(`Hittade ${c.results.length} bolag`,"success")):(A([]),an("Inga bolag hittades","warning"))}catch(d){let c=d instanceof Error?d.message:"Okänt fel";if(b<2)return an(`Fel: ${c}. F\xf6rs\xf6ker igen...`,"warning"),await new Promise(a=>setTimeout(a,1e3)),ap(a,b+1);an(`Fel: ${c}`,"error"),A([])}i("online"),E(!1)},[an]),aq=(0,d.useCallback)(async()=>{aa(!0);try{let a=await fetch("/api/bevakning");if(a.ok){let b=(await a.json()).companies||[];Y(b),$(new Set(b.map(a=>a.id)))}}catch{}aa(!1)},[]);(0,d.useEffect)(()=>{"expanded"===c&&"enrich"===f&&aq()},[c,f,aq]);let ar=()=>S([]),as=()=>{n(!1),setTimeout(()=>e("button"),250)},at=a=>{n(!1),g(a),setTimeout(()=>{e("expanded"),setTimeout(()=>q(!0),10)},180),i("online")},au=()=>{q(!1),setTimeout(()=>e("button"),220)},av=async(a=0)=>{O(!0),i("working"),Q(0),U({total:0,enriched:0,failed:0,skipped:0}),ae(!1),ag(null);let b=X.filter(a=>Z.has(a.id));an(`Startar berikning av ${b.length} bolag...`,"step");try{al.current=new AbortController;let b=await fetch("/api/bevakning/enrich/stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({batchSize:50,companyIds:Array.from(Z)}),signal:al.current.signal});if(429===b.status){let c=b.headers.get("Retry-After"),d=c?parseInt(c,10):60;if(ae(!0),ag(d),an(`Rate limited. V\xe4nta ${d} sekunder...`,"warning"),a<2)return await ax(1e3*d),ae(!1),av(a+1);O(!1),i("online");return}if(!b.ok)throw Error(`API error: ${b.status}`);let c=b.body?.getReader();if(!c)throw Error("No response body");let d=new TextDecoder;for(;;){let{done:a,value:b}=await c.read();if(a)break;for(let a of d.decode(b).split("\n").filter(Boolean))if(a.startsWith("data: "))try{let b=JSON.parse(a.slice(6));aw(b)}catch{}}W(new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"})),an("Berikning slutförd","success")}catch(b){if(b instanceof Error&&"AbortError"===b.name);else{let c=b instanceof Error?b.message:"Okänt fel";if(a<2)return an(`Fel: ${c}. F\xf6rs\xf6ker igen...`,"warning"),await ax(1e3),av(a+1);an(`Fel: ${c}`,"error")}}O(!1),i("online"),al.current=null,setTimeout(()=>Q(0),1e3)},aw=a=>{switch(a.type){case"start":an(a.message||"Startar...","step"),a.total&&U(b=>({...b,total:a.total}));break;case"progress":void 0!==a.progress&&Q(a.progress),a.company&&an(`Bearbetar: ${a.company}`,"info");break;case"success":an(a.message||`${a.company}: OK`,"success"),U(a=>({...a,enriched:a.enriched+1}));break;case"skip":an(a.message||`${a.company}: Hoppades \xf6ver`,"info"),U(a=>({...a,skipped:a.skipped+1}));break;case"warning":an(a.message||"Varning","warning");break;case"error":an(a.message||`${a.company}: Misslyckades`,"error"),U(a=>({...a,failed:a.failed+1}));break;case"complete":void 0!==a.enriched&&U({total:a.total||0,enriched:a.enriched||0,failed:a.failed||0,skipped:a.skipped||0}),Q(100)}},ax=a=>new Promise(b=>setTimeout(b,a)),ay=async()=>{an("Testar anslutning...","step"),i("working");try{let a=await fetch("/api/health");if(a.ok){let b=await a.json();an("API: OK","success"),an(`Databas: ${"connected"===b.database?"OK":"Fel"}`,"connected"===b.database?"success":"error"),an("Anslutning verifierad","success")}else an("Anslutning misslyckades","error")}catch{an("Kunde inte nå servern","error")}i("online")};return(0,b.jsxs)("div",{className:z.default.widget,ref:am,children:[ab&&(0,b.jsx)("div",{className:z.default.confirmOverlay,onClick:()=>ac(!1),children:(0,b.jsxs)("div",{className:z.default.confirmDialog,onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("div",{className:z.default.confirmTitle,children:"Bekräfta berikning"}),(0,b.jsxs)("div",{className:z.default.confirmMessage,children:["Du håller på att berika ",Z.size," bolag med data från Allabolag. Detta kan ta några minuter beroende på antalet bolag."]}),(0,b.jsxs)("div",{className:z.default.confirmActions,children:[(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnGhost}`,onClick:()=>ac(!1),children:"Avbryt"}),(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnPrimaryBlue}`,onClick:()=>{ac(!1),av()},children:"Starta berikning"})]})]})}),"button"===c&&(0,b.jsxs)("button",{className:z.default.button,onClick:()=>{e("menu"),setTimeout(()=>n(!0),10)},disabled:ah,children:[(0,b.jsx)("div",{className:z.default.btnLogo,children:(0,b.jsx)("img",{src:"/logos/allabolag.png",alt:"Allabolag"})}),(0,b.jsx)("span",{className:z.default.btnSubtitle,children:"Bolagsdata"}),(0,b.jsx)(u.ChevronRight,{className:`${z.default.chevron} w-4 h-4`}),ah&&(0,b.jsx)("div",{className:`${z.default.loadingSpinner} ${z.default.loadingSpinnerBlue}`})]}),"menu"===c&&(0,b.jsxs)("div",{className:`${z.default.menu} ${j?z.default.menuVisible:""}`,children:[(0,b.jsxs)("div",{className:z.default.menuHeader,children:[(0,b.jsxs)("div",{className:z.default.menuTitle,children:[(0,b.jsx)("div",{className:`${z.default.menuTitleIcon} ${z.default.menuTitleIconBlue}`,children:(0,b.jsx)(H.Database,{className:"w-3 h-3"})}),"Berika data"]}),(0,b.jsx)("button",{className:z.default.menuClose,onClick:as,children:(0,b.jsx)(w.X,{className:"w-3.5 h-3.5"})})]}),(0,b.jsxs)("div",{className:z.default.menuItems,children:[(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>at("search"),children:[(0,b.jsx)("div",{className:`${z.default.menuIcon} ${z.default.menuIconBlue}`,children:(0,b.jsx)(l.Search,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Sök bolag"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"Sök på namn eller org.nr"})]})]}),(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>at("enrich"),children:[(0,b.jsx)("div",{className:`${z.default.menuIcon} ${z.default.menuIconBlue}`,children:(0,b.jsx)(F.RefreshCw,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Berika bolag"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:X.length>0?`Uppdatera ${X.length} bolag fr\xe5n Allabolag`:"Hämta data från Allabolag"})]})]}),(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>at("status"),children:[(0,b.jsx)("div",{className:`${z.default.menuIcon} ${z.default.menuIconBlue}`,children:(0,b.jsx)(x.Activity,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Status"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"Anslutning och hälsa"})]})]})]})]}),"expanded"===c&&(0,b.jsxs)("div",{className:`${z.default.expanded} ${p?z.default.expandedVisible:""}`,children:[(0,b.jsxs)("div",{className:z.default.expandedHeader,children:[(0,b.jsxs)("div",{className:z.default.expandedTitle,children:[(0,b.jsx)("div",{className:`${z.default.statusDot} ${"online"===h?z.default.statusDotOnline:"working"===h?z.default.statusDotWorkingBlue:""}`}),(0,b.jsx)("span",{children:{search:"Sök bolag",enrich:"Berika bolag",status:"Status"}[f]})]}),(0,b.jsxs)("div",{className:z.default.headerActions,children:[(0,b.jsx)("button",{className:z.default.headerBtn,onClick:()=>{q(!1),setTimeout(()=>{e("menu"),setTimeout(()=>n(!0),10)},220)},children:(0,b.jsx)(v.ChevronLeft,{className:"w-3.5 h-3.5"})}),(0,b.jsx)("button",{className:z.default.headerBtn,onClick:au,children:(0,b.jsx)(w.X,{className:"w-3.5 h-3.5"})})]})]}),(0,b.jsxs)("div",{className:z.default.expandedBody,children:["search"===f&&(0,b.jsxs)("div",{className:z.default.view,children:[(0,b.jsxs)("div",{className:z.default.inputGroup,children:[(0,b.jsx)("input",{type:"text",className:z.default.input,placeholder:"Företagsnamn eller org.nr...",value:r,onChange:a=>{var b;s(b=a.target.value),M.current&&clearTimeout(M.current),b.length>=2?M.current=setTimeout(()=>{ap(b)},300):A([])},onKeyDown:a=>"Enter"===a.key&&ap(r),autoFocus:!0}),(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnPrimaryBlue}`,onClick:()=>ap(r),disabled:D||r.length<2,children:D?"...":"Sök"})]}),t.length>0&&(0,b.jsxs)("div",{className:z.default.projects,children:[(0,b.jsxs)("div",{className:z.default.sectionTitle,children:[(0,b.jsx)(m.Building2,{className:"w-3.5 h-3.5"}),"Resultat (",t.length,")"]}),t.map(c=>(0,b.jsx)("div",{className:z.default.project,onClick:()=>{ao(c.orgNr,c.name),an(`\xd6ppnar: ${c.name}`,"success"),au(),a.push(`/bolag/${c.orgNr}`)},children:(0,b.jsxs)("div",{className:z.default.projectHeader,children:[(0,b.jsx)("div",{className:z.default.projectTitle,children:c.name}),(0,b.jsx)("div",{className:z.default.projectId,children:c.orgNr})]})},c.orgNr))]}),0===t.length&&G.length>0&&!r&&(0,b.jsxs)("div",{className:z.default.projects,children:[(0,b.jsxs)("div",{className:z.default.sectionTitle,children:[(0,b.jsx)(o.Clock,{className:"w-3.5 h-3.5"}),"Senaste sökningar"]}),G.map(c=>(0,b.jsx)("div",{className:z.default.project,onClick:()=>{ao(c.orgNr,c.name),au(),a.push(`/bolag/${c.orgNr}`)},children:(0,b.jsxs)("div",{className:z.default.projectHeader,children:[(0,b.jsx)("div",{className:z.default.projectTitle,children:c.name}),(0,b.jsx)("div",{className:z.default.projectId,children:c.orgNr})]})},c.orgNr))]}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),R.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:ar,children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,ref:ak,children:0===R.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Sök efter ett företag för att se aktivitet"}):R.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]}),"enrich"===f&&(0,b.jsxs)("div",{className:z.default.view,children:[ad&&(0,b.jsxs)("div",{className:z.default.rateLimitWarning,children:[(0,b.jsx)(J.AlertTriangle,{className:"w-4 h-4"}),(0,b.jsxs)("span",{children:["Rate limited. ",af?`F\xf6rs\xf6ker igen om ${af}s...`:"Vänta innan du försöker igen."]})]}),(0,b.jsxs)("div",{className:z.default.statsGrid,children:[(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(m.Building2,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"Valda"}),(0,b.jsxs)("div",{className:z.default.statValue,children:[Z.size," / ",X.length]})]})]}),(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(I.CheckCircle,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"Berikade"}),(0,b.jsx)("div",{className:`${z.default.statValue} ${z.default.statValueSuccess}`,children:T.enriched})]})]})]}),!N&&(0,b.jsxs)("div",{className:z.default.companyFilter,children:[(0,b.jsxs)("div",{className:z.default.companyFilterHeader,children:[(0,b.jsx)("span",{className:z.default.companyFilterTitle,children:"Välj bolag"}),(0,b.jsxs)("div",{className:z.default.companyFilterActions,children:[(0,b.jsx)("button",{className:z.default.companyFilterAction,onClick:()=>{$(new Set(X.map(a=>a.id)))},children:"Alla"}),(0,b.jsx)("button",{className:z.default.companyFilterAction,onClick:()=>{$(new Set)},children:"Inga"})]})]}),_?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Laddar bolag..."}):(0,b.jsx)("div",{className:z.default.companyList,children:X.map(a=>(0,b.jsxs)("div",{className:`${z.default.companyItem} ${Z.has(a.id)?z.default.companyItemSelected:""}`,onClick:()=>{var b;return b=a.id,void $(a=>{let c=new Set(a);return c.has(b)?c.delete(b):c.add(b),c})},children:[(0,b.jsx)("div",{className:`${z.default.companyCheckbox} ${Z.has(a.id)?z.default.companyCheckboxChecked:""}`,children:Z.has(a.id)&&(0,b.jsx)(K.Check,{className:"w-3 h-3 text-white"})}),(0,b.jsx)("span",{className:z.default.companyName,children:a.name}),(0,b.jsx)("span",{className:z.default.companyOrgNr,children:a.orgNumber})]},a.id))})]}),(0,b.jsx)("div",{className:z.default.actionRow,children:(0,b.jsx)("button",{className:`${z.default.btn} ${N?z.default.btnDanger:z.default.btnPrimaryBlue}`,onClick:()=>{if(N){al.current&&al.current.abort(),O(!1),i("online"),an("Avbruten av användare","warning");return}0===Z.size?an("Inga bolag valda","warning"):ac(!0)},style:{flex:1},disabled:ad,children:N?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(C,{className:"w-3.5 h-3.5"}),"Stoppa"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(B.Play,{className:"w-3.5 h-3.5"}),"Starta berikning"]})})}),P>0&&(0,b.jsxs)("div",{className:`${z.default.progress} ${z.default.progressWithText}`,children:[(0,b.jsx)("div",{className:z.default.progressBar,children:(0,b.jsx)("div",{className:`${z.default.progressFill} ${z.default.progressFillBlue}`,style:{width:`${P}%`}})}),(0,b.jsxs)("span",{className:z.default.progressText,children:[Math.round(P),"%"]})]}),(T.enriched>0||T.failed>0||T.skipped>0)&&(0,b.jsxs)("div",{className:z.default.summary,children:[(0,b.jsxs)("span",{className:`${z.default.summaryItem} ${z.default.summaryItemSuccess}`,children:[T.enriched," berikade"]}),T.skipped>0&&(0,b.jsxs)("span",{className:z.default.summaryItem,children:[T.skipped," hoppades över"]}),T.failed>0&&(0,b.jsxs)("span",{className:`${z.default.summaryItem} ${z.default.summaryItemError}`,children:[T.failed," misslyckades"]})]}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),R.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:ar,children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,ref:ak,children:0===R.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Starta berikning för att se aktivitet"}):R.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]}),"status"===f&&(0,b.jsxs)("div",{className:z.default.view,children:[(0,b.jsxs)("div",{className:z.default.statsGrid,children:[(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(x.Activity,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"API"}),(0,b.jsx)("div",{className:`${z.default.statValue} ${z.default.statValueOnline}`,children:"Ansluten"})]})]}),(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(o.Clock,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"Senaste"}),(0,b.jsx)("div",{className:z.default.statValue,children:V})]})]})]}),(0,b.jsx)("div",{className:z.default.actionRow,children:(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnGhost}`,onClick:ay,children:"Testa anslutning"})}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),R.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:ar,children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,children:0===R.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Ingen aktivitet"}):R.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]})]})]})]})}var M=a.i(73067),N=a.i(772213),O=a.i(56433),P=a.i(775702);function Q(){let[a,c]=(0,d.useState)("button"),[e,f]=(0,d.useState)("search"),[g,h]=(0,d.useState)("online"),[i,j]=(0,d.useState)(!1),[k,n]=(0,d.useState)(!1),[p,q]=(0,d.useState)(""),[r,s]=(0,d.useState)(null),[t,A]=(0,d.useState)(!1),[D,E]=(0,d.useState)([]),[G,H]=(0,d.useState)([]),[I,J]=(0,d.useState)(!1),[K,L]=(0,d.useState)(0),[Q,R]=(0,d.useState)("--:--"),[S,T]=(0,d.useState)([]),[U,V]=(0,d.useState)([]),[W,X]=(0,d.useState)([]),[Y,Z]=(0,d.useState)({}),[$,_]=(0,d.useState)(""),[aa,ab]=(0,d.useState)(null),[ac,ad]=(0,d.useState)([]),[ae,af]=(0,d.useState)(!1),[ag,ah]=(0,d.useState)(!1),ai=(0,d.useRef)(0),aj=(0,d.useRef)(null),ak=(0,d.useRef)(null),al=(0,d.useRef)(!1);y(ak,()=>{"menu"===a&&ap(),"expanded"===a&&ar()},"button"!==a);let am=(0,d.useCallback)((a,b,c="info")=>{let d=new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),e={id:`log-${++ai.current}`,time:d,message:b,type:c};"search"===a?E(a=>[...a.slice(-50),e]):"batch"===a?H(a=>[...a.slice(-50),e]):"linkedin"===a?ad(a=>[...a.slice(-50),e]):X(a=>[...a.slice(-50),e])},[]);(0,d.useEffect)(()=>{aj.current&&(aj.current.scrollTop=aj.current.scrollHeight)},[D,G,W,ac]);let an=(0,d.useCallback)(async()=>{try{let a=await fetch("/api/bevakning");if(a.ok){let b=await a.json();T(b.companies||[])}}catch(a){console.error("Failed to fetch watched companies:",a)}},[]);(0,d.useEffect)(()=>{"expanded"===a&&"batch"===e&&an()},[a,e,an]),(0,d.useEffect)(()=>{ah(t||I||ae)},[t,I,ae]);let ao=a=>{"search"===a?E([]):"batch"===a?H([]):"linkedin"===a?ad([]):X([])},ap=()=>{j(!1),setTimeout(()=>c("button"),250)},aq=a=>{j(!1),f(a),setTimeout(()=>{c("expanded"),setTimeout(()=>n(!0),10)},180),h("online")},ar=()=>{n(!1),setTimeout(()=>c("button"),220)},as=async(a=0)=>{if(p.trim()){A(!0),h("working"),s(null),am("search",`S\xf6ker logo f\xf6r: "${p}"...`,"step");try{let a=await fetch(`/api/media/logo?domain=${encodeURIComponent(p.trim())}&all=true`);if(!a.ok)throw Error(`API error: ${a.status}`);let b=await a.json();if(b.success&&b.files.length>0)for(let a of(s(b),am("search",`Hittade ${b.files.length} logotyp(er) via ${b.source}`,"success"),b.files)){let b=a.width?`${a.width}x${a.height}`:"okänd storlek";am("search",`  ${a.format.toUpperCase()} (${a.type}) - ${b}`,"info")}else am("search",b.error||"Ingen logo hittades","warning")}catch(c){let b=c instanceof Error?c.message:"Okänt fel";if(a<2)return am("search",`Fel: ${b}. F\xf6rs\xf6ker igen...`,"warning"),await av(1e3),as(a+1);am("search",`Fel: ${b}`,"error")}h("online"),A(!1)}},at=async()=>{if(I){al.current=!1,J(!1),am("batch","Avbruten av användare","warning"),h("online"),L(0);return}let a=S;if(0===a.length){am("batch","Hämtar bevakade bolag...","step");try{let b=await fetch("/api/bevakning");b.ok&&(a=(await b.json()).companies||[],T(a))}catch{am("batch","Kunde inte hämta bevakade bolag","error");return}}if(0===a.length)return void am("batch","Inga bevakade bolag att hämta logos för","warning");al.current=!0,J(!0),V([]),am("batch",`Startar logo-h\xe4mtning f\xf6r ${a.length} bolag...`,"step"),h("working"),L(0);let b=0,c=[],d={};for(let e=0;e<a.length&&al.current;e++){let f=a[e],g=(e+1)/a.length*100,h=f.domain||ax(f.name);am("batch",`S\xf6ker: ${f.name} (${h})...`,"info"),L(g-5);try{let a=await fetch(`/api/media/logo?domain=${encodeURIComponent(h)}`);if(!al.current)break;if(a.ok){let e=await a.json();if(c.push(e),e.success){am("batch",`${f.name}: OK (${e.source})`,"success"),b++;let a=e.source||"unknown";d[a]||(d[a]={success:0,fail:0}),d[a].success++}else am("batch",`${f.name}: Ingen logo`,"warning")}else am("batch",`${f.name}: API-fel`,"warning")}catch{am("batch",`${f.name}: Misslyckades`,"error")}L(g),al.current&&e<a.length-1&&await av(300)}al.current&&(V(c),Z(d),am("batch",`K\xf6rning slutf\xf6rd: ${b}/${a.length} logos h\xe4mtade`,"success"),R(new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"}))),al.current=!1,J(!1),h("online"),setTimeout(()=>L(0),1e3)},au=async()=>{for(let a of(am("status","Testar API-anslutningar...","step"),h("working"),[{name:"Brandfetch API",domain:"google.com"},{name:"Unavatar",domain:"spotify.com"},{name:"Google Favicons",domain:"github.com"}])){am("status",`Testar ${a.name}...`,"info"),await av(300);try{let b=await fetch(`/api/media/logo?domain=${a.domain}`);if(b.ok){let c=await b.json();c.success?am("status",`${a.name}: OK (${c.source})`,"success"):am("status",`${a.name}: Ingen logo`,"warning")}else am("status",`${a.name}: Fel (${b.status})`,"error")}catch{am("status",`${a.name}: Kunde inte n\xe5`,"error")}}am("status","Test slutfört","success"),h("online")},av=a=>new Promise(b=>setTimeout(b,a)),aw=async()=>{if($.trim()){af(!0),h("working"),ab(null),am("linkedin",`S\xf6ker LinkedIn-profil f\xf6r: "${$}"...`,"step");try{let a=await fetch(`/api/media/linkedin?company=${encodeURIComponent($.trim())}`);if(!a.ok)throw Error(`API error: ${a.status}`);let b=await a.json();b.success&&b.data?(ab(b),am("linkedin",`Hittade: ${b.data.name||$}`,"success"),b.data.industry&&am("linkedin",`Bransch: ${b.data.industry}`,"info"),b.data.company_size&&am("linkedin",`Storlek: ${b.data.company_size}`,"info"),b.data.headquarters&&am("linkedin",`HQ: ${b.data.headquarters}`,"info")):am("linkedin",b.error||"Ingen LinkedIn-profil hittades","warning")}catch(b){let a=b instanceof Error?b.message:"Okänt fel";am("linkedin",`Fel: ${a}`,"error")}h("online"),af(!1)}},ax=a=>{let b=a.toLowerCase().replace(/\s*(ab|aktiebolag|hb|kb|ek\.?\s*för\.?|ekonomisk förening)\s*$/i,"").trim().replace(/\s+/g,"").replace(/[åä]/g,"a").replace(/ö/g,"o").replace(/[^a-z0-9]/g,"");return`${b}.se`},ay=async(a,b)=>{try{let c=await fetch(a.url),d=await c.blob(),e=window.URL.createObjectURL(d),f=document.createElement("a");f.href=e,f.download=`${b.replace(/\./g,"_")}_logo.${a.format}`,document.body.appendChild(f),f.click(),document.body.removeChild(f),window.URL.revokeObjectURL(e),am("search",`Laddade ner ${a.format.toUpperCase()} logo`,"success")}catch{am("search","Kunde inte ladda ner logo","error")}};return(0,d.useEffect)(()=>()=>{al.current=!1},[]),(0,b.jsxs)("div",{className:z.default.widget,ref:ak,children:["button"===a&&(0,b.jsxs)("button",{className:z.default.button,onClick:()=>{c("menu"),setTimeout(()=>j(!0),10)},disabled:ag,children:[(0,b.jsx)("div",{className:z.default.btnLogo,children:(0,b.jsx)(M.Image,{className:"w-8 h-8",strokeWidth:1.5})}),(0,b.jsx)("span",{className:z.default.btnSubtitle,children:"Media & Logos"}),(0,b.jsx)(u.ChevronRight,{className:`${z.default.chevron} w-4 h-4`}),ag&&(0,b.jsx)("div",{className:z.default.loadingSpinner})]}),"menu"===a&&(0,b.jsxs)("div",{className:`${z.default.menu} ${i?z.default.menuVisible:""}`,children:[(0,b.jsxs)("div",{className:z.default.menuHeader,children:[(0,b.jsxs)("div",{className:z.default.menuTitle,children:[(0,b.jsx)("div",{className:`${z.default.menuTitleIcon} ${z.default.menuTitleIconGreen}`,children:(0,b.jsx)(M.Image,{className:"w-3 h-3"})}),"Media"]}),(0,b.jsx)("button",{className:z.default.menuClose,onClick:ap,children:(0,b.jsx)(w.X,{className:"w-3.5 h-3.5"})})]}),(0,b.jsxs)("div",{className:z.default.menuItems,children:[(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>aq("search"),children:[(0,b.jsx)("div",{className:z.default.menuIcon,children:(0,b.jsx)(l.Search,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Hämta logo"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"Sök på domän eller bolagsnamn"})]})]}),(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>aq("batch"),children:[(0,b.jsx)("div",{className:z.default.menuIcon,children:(0,b.jsx)(F.RefreshCw,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Batch-hämtning"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"Hämta logos för alla bevakade bolag"})]})]}),(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>aq("linkedin"),children:[(0,b.jsx)("div",{className:z.default.menuIcon,children:(0,b.jsx)(P.Linkedin,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"LinkedIn"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"Hämta bolagsprofil från LinkedIn"})]})]}),(0,b.jsxs)("div",{className:z.default.menuItem,onClick:()=>aq("status"),children:[(0,b.jsx)("div",{className:z.default.menuIcon,children:(0,b.jsx)(x.Activity,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:z.default.menuLabel,children:"Status"}),(0,b.jsx)("div",{className:z.default.menuDesc,children:"API-status och statistik"})]})]})]})]}),"expanded"===a&&(0,b.jsxs)("div",{className:`${z.default.expanded} ${k?z.default.expandedVisible:""}`,children:[(0,b.jsxs)("div",{className:z.default.expandedHeader,children:[(0,b.jsxs)("div",{className:z.default.expandedTitle,children:[(0,b.jsx)("div",{className:`${z.default.statusDot} ${"online"===g?z.default.statusDotOnline:"working"===g?z.default.statusDotWorking:""}`}),(0,b.jsx)("span",{children:{search:"Hämta logo",batch:"Batch-hämtning",status:"Status",linkedin:"LinkedIn"}[e]})]}),(0,b.jsxs)("div",{className:z.default.headerActions,children:[(0,b.jsx)("button",{className:z.default.headerBtn,onClick:()=>{n(!1),setTimeout(()=>{c("menu"),setTimeout(()=>j(!0),10)},220)},children:(0,b.jsx)(v.ChevronLeft,{className:"w-3.5 h-3.5"})}),(0,b.jsx)("button",{className:z.default.headerBtn,onClick:ar,children:(0,b.jsx)(w.X,{className:"w-3.5 h-3.5"})})]})]}),(0,b.jsxs)("div",{className:z.default.expandedBody,children:["search"===e&&(0,b.jsxs)("div",{className:z.default.view,children:[(0,b.jsxs)("div",{className:z.default.inputGroup,children:[(0,b.jsx)("input",{type:"text",className:z.default.input,placeholder:"Domän (t.ex. volvo.com)...",value:p,onChange:a=>q(a.target.value),onKeyDown:a=>"Enter"===a.key&&as(),autoFocus:!0}),(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnPrimary}`,onClick:()=>as(),disabled:t,children:t?"...":"Sök"})]}),r&&r.success&&r.files.length>0&&(0,b.jsxs)("div",{className:z.default.projects,children:[(0,b.jsxs)("div",{className:z.default.sectionTitle,children:[(0,b.jsx)(M.Image,{className:"w-3.5 h-3.5"}),"Resultat (",r.files.length,")"]}),(0,b.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"12px"},children:r.files.slice(0,4).map((a,c)=>(0,b.jsxs)("div",{style:{background:"var(--widget-surface)",borderRadius:"8px",padding:"12px",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",flex:"1 1 calc(50% - 4px)",minWidth:"120px"},children:[(0,b.jsx)("div",{style:{width:"80px",height:"60px",display:"flex",alignItems:"center",justifyContent:"center",background:"white",borderRadius:"4px",padding:"8px"},children:(0,b.jsx)("img",{src:a.url,alt:`Logo ${a.type}`,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"},onError:a=>{a.target.style.display="none"}})}),(0,b.jsxs)("div",{style:{fontSize:"10px",color:"var(--widget-text-dim)",textAlign:"center"},children:[a.format.toUpperCase()," ",a.width?`(${a.width}px)`:""]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"4px"},children:[(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnGhost}`,style:{padding:"4px 8px",fontSize:"10px"},onClick:()=>ay(a,r.domain),children:(0,b.jsx)(N.Download,{className:"w-3 h-3"})}),(0,b.jsx)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:`${z.default.btn} ${z.default.btnGhost}`,style:{padding:"4px 8px",fontSize:"10px"},children:(0,b.jsx)(O.ExternalLink,{className:"w-3 h-3"})})]})]},c))})]}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),D.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:()=>ao("search"),children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,ref:aj,children:0===D.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Sök efter en domän för att hämta logo"}):D.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]}),"batch"===e&&(0,b.jsxs)("div",{className:z.default.view,children:[(0,b.jsxs)("div",{className:z.default.statsGrid,children:[(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(m.Building2,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"Bevakade"}),(0,b.jsx)("div",{className:z.default.statValue,children:S.length||"..."})]})]}),(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(o.Clock,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"Senaste"}),(0,b.jsx)("div",{className:z.default.statValue,children:Q})]})]})]}),(0,b.jsx)("div",{className:z.default.actionRow,children:(0,b.jsx)("button",{className:`${z.default.btn} ${I?z.default.btnDanger:z.default.btnSuccess}`,onClick:at,style:{flex:1},children:I?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(C,{className:"w-3.5 h-3.5"}),"Stoppa"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(B.Play,{className:"w-3.5 h-3.5"}),"Starta hämtning"]})})}),K>0&&(0,b.jsx)("div",{className:z.default.progress,children:(0,b.jsx)("div",{className:z.default.progressBar,children:(0,b.jsx)("div",{className:z.default.progressFill,style:{width:`${K}%`}})})}),U.length>0&&!I&&(0,b.jsxs)("div",{className:z.default.summary,children:[(0,b.jsxs)("span",{className:`${z.default.summaryItem} ${z.default.summaryItemSuccess}`,children:[U.filter(a=>a.success).length," hämtade"]}),(0,b.jsxs)("span",{className:z.default.summaryItem,children:[U.filter(a=>!a.success).length," missade"]})]}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),G.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:()=>ao("batch"),children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,children:0===G.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Starta hämtning för att se aktivitet"}):G.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]}),"linkedin"===e&&(0,b.jsxs)("div",{className:z.default.view,children:[(0,b.jsxs)("div",{className:z.default.inputGroup,children:[(0,b.jsx)("input",{type:"text",className:z.default.input,placeholder:"Bolagsnamn (t.ex. volvo, klarna)...",value:$,onChange:a=>_(a.target.value),onKeyDown:a=>"Enter"===a.key&&aw(),autoFocus:!0}),(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnPrimary}`,onClick:aw,disabled:ae,children:ae?"...":"Sök"})]}),aa&&aa.success&&aa.data&&(0,b.jsxs)("div",{className:z.default.projects,children:[(0,b.jsxs)("div",{className:z.default.sectionTitle,children:[(0,b.jsx)(P.Linkedin,{className:"w-3.5 h-3.5"}),aa.data.name||aa.company]}),(0,b.jsxs)("div",{style:{background:"var(--widget-surface)",borderRadius:"8px",padding:"12px",marginBottom:"12px"},children:[aa.data.about_us&&(0,b.jsx)("p",{style:{fontSize:"12px",color:"var(--widget-text)",lineHeight:"1.5",marginBottom:"12px"},children:aa.data.about_us.length>200?aa.data.about_us.slice(0,200)+"...":aa.data.about_us}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",fontSize:"11px"},children:[aa.data.industry&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"Bransch:"})," ",(0,b.jsx)("span",{style:{color:"var(--widget-text)"},children:aa.data.industry})]}),aa.data.company_size&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"Storlek:"})," ",(0,b.jsx)("span",{style:{color:"var(--widget-text)"},children:aa.data.company_size})]}),aa.data.headquarters&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"HQ:"})," ",(0,b.jsx)("span",{style:{color:"var(--widget-text)"},children:aa.data.headquarters})]}),aa.data.founded&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"Grundat:"})," ",(0,b.jsx)("span",{style:{color:"var(--widget-text)"},children:aa.data.founded})]}),aa.data.headcount&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"Anställda:"})," ",(0,b.jsx)("span",{style:{color:"var(--widget-text)"},children:aa.data.headcount.toLocaleString()})]}),aa.data.website&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"Webb:"})," ",(0,b.jsx)("a",{href:aa.data.website,target:"_blank",rel:"noopener noreferrer",style:{color:"var(--widget-accent)"},children:aa.data.website.replace(/^https?:\/\//,"")})]})]}),aa.data.specialties&&aa.data.specialties.length>0&&(0,b.jsx)("div",{style:{marginTop:"8px",display:"flex",flexWrap:"wrap",gap:"4px"},children:aa.data.specialties.slice(0,5).map((a,c)=>(0,b.jsx)("span",{style:{background:"var(--widget-bg)",padding:"2px 6px",borderRadius:"4px",fontSize:"10px",color:"var(--widget-text-dim)"},children:a},c))}),aa.linkedinUrl&&(0,b.jsx)("div",{style:{marginTop:"12px"},children:(0,b.jsxs)("a",{href:aa.linkedinUrl,target:"_blank",rel:"noopener noreferrer",className:`${z.default.btn} ${z.default.btnGhost}`,style:{fontSize:"11px"},children:[(0,b.jsx)(O.ExternalLink,{className:"w-3 h-3"}),"Öppna på LinkedIn"]})})]})]}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),ac.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:()=>ao("linkedin"),children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,ref:aj,children:0===ac.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Sök efter ett bolag för att hämta LinkedIn-profil"}):ac.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]}),"status"===e&&(0,b.jsxs)("div",{className:z.default.view,children:[(0,b.jsxs)("div",{className:z.default.statsGrid,children:[(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(x.Activity,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"API"}),(0,b.jsx)("div",{className:`${z.default.statValue} ${z.default.statValueOnline}`,children:"6 källor"})]})]}),(0,b.jsxs)("div",{className:z.default.statCard,children:[(0,b.jsx)(M.Image,{className:"w-4 h-4"}),(0,b.jsxs)("div",{className:z.default.statContent,children:[(0,b.jsx)("div",{className:z.default.statLabel,children:"Format"}),(0,b.jsx)("div",{className:z.default.statValue,children:"SVG, PNG"})]})]})]}),(0,b.jsxs)("div",{className:z.default.projects,style:{marginBottom:"12px"},children:[(0,b.jsxs)("div",{className:z.default.sectionTitle,children:[(0,b.jsx)(x.Activity,{className:"w-3.5 h-3.5"}),"API-källor (prioritetsordning)"]}),[{name:"Brandfetch API",desc:"SVG/PNG, flera storlekar"},{name:"Brandfetch CDN",desc:"Snabb, en fil"},{name:"Unavatar",desc:"Aggregerar källor"},{name:"Google Favicons",desc:"128px ikoner"},{name:"DuckDuckGo",desc:"ICO-ikoner"},{name:"Logo.dev",desc:"Backup"}].map((a,c)=>(0,b.jsx)("div",{className:z.default.project,style:{cursor:"default"},children:(0,b.jsxs)("div",{className:z.default.projectHeader,children:[(0,b.jsxs)("div",{className:z.default.projectTitle,children:[c+1,". ",a.name]}),(0,b.jsx)("div",{className:z.default.projectId,children:a.desc})]})},c))]}),(0,b.jsx)("div",{className:z.default.actionRow,children:(0,b.jsx)("button",{className:`${z.default.btn} ${z.default.btnGhost}`,onClick:au,children:"Testa anslutningar"})}),(0,b.jsxs)("div",{className:z.default.logPanel,children:[(0,b.jsxs)("div",{className:z.default.logHeader,children:[(0,b.jsx)("span",{className:z.default.logTitle,children:"Aktivitet"}),W.length>0&&(0,b.jsx)("button",{className:z.default.logClear,onClick:()=>ao("status"),children:"Rensa"})]}),(0,b.jsx)("div",{className:z.default.logContent,ref:aj,children:0===W.length?(0,b.jsx)("div",{className:z.default.logEmpty,children:"Testa anslutningar för att se status"}):W.map(a=>(0,b.jsxs)("div",{className:`${z.default.logLine} ${"success"===a.type?z.default.logLineSuccess:"warning"===a.type?z.default.logLineWarning:"error"===a.type?z.default.logLineError:"step"===a.type?z.default.logLineStep:z.default.logLineInfo}`,children:[(0,b.jsx)("span",{className:z.default.logTime,children:a.time}),(0,b.jsx)("span",{className:z.default.logMsg,children:a.message})]},a.id))})]})]})]})]})]})}var R=a.i(640247),S=a.i(766479);function T(){let{history:a,addToHistory:f,clearHistory:g}=function(){let{data:a,status:b}=(0,e.useSession)(),[c,f]=(0,d.useState)([]),[g,h]=(0,d.useState)(!1),j=(0,d.useRef)(!1);return(0,d.useEffect)(()=>{(async()=>{if(f([]),"authenticated"===b&&a?.user&&!j.current)try{let a=await fetch("/api/bolag/history");if(a.ok){let b=await a.json();b.history&&b.history.length>0&&(f(b.history),i(b.history),j.current=!0)}}catch{}h(!0)})()},[a?.user,b]),(0,d.useEffect)(()=>{(async()=>{if("authenticated"!==b||!a?.user||j.current)return;let c=[];if(0!==c.length)try{let a=await fetch("/api/bolag/history");if(a.ok){let b=await a.json();if(b.history&&b.history.length>0)return}for(let a of c)await fetch("/api/bolag/history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgNr:a.orgNr,name:a.name})})}catch{}})()},[a?.user,b]),{history:c,addToHistory:(0,d.useCallback)(async(b,c)=>{let d={orgNr:b,name:c,timestamp:Date.now()};if(f(a=>{let c=[d,...a.filter(a=>a.orgNr!==b)].slice(0,8);return i(c),c}),a?.user)try{await fetch("/api/bolag/history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgNr:b,name:c})})}catch{}},[a?.user]),clearHistory:(0,d.useCallback)(async()=>{if(f([]),localStorage.removeItem("bolagsinfo-search-history"),a?.user)try{await fetch("/api/bolag/history",{method:"DELETE"})}catch{}},[a?.user]),isLoaded:g}}();return(0,b.jsx)("main",{className:"min-h-screen bg-background text-foreground",children:(0,b.jsxs)("div",{className:"page-wrapper page-content",children:[(0,b.jsxs)("header",{className:"page-header text-center max-w-2xl mx-auto",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 text-white mb-6 shadow-lg",children:(0,b.jsx)(m.Building2,{className:"w-8 h-8"})}),(0,b.jsx)("h1",{className:"page-title",children:"Bolagsinfo"}),(0,b.jsx)("p",{className:"page-subtitle",children:"Utforska svenska bolag med data från flera officiella källor"})]}),(0,b.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,b.jsxs)(c.Card,{className:"shadow-lg border-2 border-border/50 hover:border-blue-200 dark:hover:border-blue-800/50 transition-colors",children:[(0,b.jsxs)(c.CardHeader,{className:"text-center pb-2",children:[(0,b.jsxs)("div",{className:"inline-flex items-center justify-center gap-2 text-muted-foreground mb-2",children:[(0,b.jsx)(l.Search,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-xs font-medium uppercase tracking-wider",children:"Sök företag"})]}),(0,b.jsx)(c.CardDescription,{className:"text-base",children:"Sök på företagsnamn eller organisationsnummer"})]}),(0,b.jsxs)(c.CardContent,{className:"pt-0",children:[(0,b.jsx)(t,{placeholder:"T.ex. Spotify eller 556703-7485...",recentSearches:a,onSelectResult:a=>f(a.orgNr,a.name)}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(j,{history:a,onClear:g})})]})]}),(0,b.jsxs)("div",{className:"mt-8",children:[(0,b.jsxs)("h2",{className:"text-section mb-4 flex items-center gap-2",children:[(0,b.jsx)(H.Database,{className:"w-4 h-4 text-muted-foreground"}),"Verktyg"]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[(0,b.jsx)(A,{}),(0,b.jsx)(G,{}),(0,b.jsx)(L,{}),(0,b.jsx)(Q,{})]})]}),(0,b.jsx)("div",{className:"mt-8",children:(0,b.jsx)(h,{})})]}),(0,b.jsxs)("div",{className:"mt-16",children:[(0,b.jsxs)("div",{className:"text-center mb-8",children:[(0,b.jsx)("h2",{className:"section-title mb-2",children:"Datakällor"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Information aggregeras från flera officiella källor"})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4 max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"source-card group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-emerald-500/10 dark:bg-emerald-500/20 flex items-center justify-center group-hover:scale-110 transition-transform",children:(0,b.jsx)(E.FileText,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-400"})}),(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:"Bolagsverket"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Officiell registreringsinformation, styrelse och kungörelser"})]}),(0,b.jsxs)("div",{className:"source-card group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-orange-500/10 dark:bg-orange-500/20 flex items-center justify-center group-hover:scale-110 transition-transform",children:(0,b.jsx)(S.TrendingUp,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:"Allabolag"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Bokslut, nyckeltal, ägare och befattningshavare"})]}),(0,b.jsxs)("div",{className:"source-card group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-green-500/10 dark:bg-green-500/20 flex items-center justify-center group-hover:scale-110 transition-transform",children:(0,b.jsx)(R.Lightbulb,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:"Vinnova"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Innovationsbidrag och forskningsprojekt"})]}),(0,b.jsxs)("div",{className:"source-card group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-purple-500/10 dark:bg-purple-500/20 flex items-center justify-center group-hover:scale-110 transition-transform",children:(0,b.jsx)(M.Image,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:"Media"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Logotyper och varumärken via 6 API-källor"})]})]})]}),(0,b.jsx)("div",{className:"mt-16 pt-8 border-t border-border",children:(0,b.jsxs)("div",{className:"flex flex-wrap justify-center gap-8 text-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-foreground font-mono",children:"1.2M+"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Registrerade bolag"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-foreground font-mono",children:"4"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Datakällor"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-foreground font-mono",children:"Realtid"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Uppdateringar"})]})]})})]})})}a.s(["default",()=>T],814635)}];

//# debugId=23148e47-2ef2-4919-4e64-110a06c91e7c
//# sourceMappingURL=CLAUDE_projects_1_%20Loop%20Desk_src_5dc8456a._.js.map