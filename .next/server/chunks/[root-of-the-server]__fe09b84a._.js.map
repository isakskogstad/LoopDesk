{
  "version": 3,
  "sources": [],
  "debugId": "c91153ae-2517-202d-7a81-f77e44e1a10b",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../../../CLAUDE/projects/LoopDesk/node_modules/next/src/shared/lib/action-revalidation-kind.ts","../../../../../../CLAUDE/projects/LoopDesk/node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../../../../CLAUDE/projects/LoopDesk/node_modules/next/src/server/route-modules/app-page/vendored/rsc/react.ts","../../../../../../CLAUDE/projects/LoopDesk/src/lib/auth/rate-limit.ts","../../../../../../CLAUDE/projects/LoopDesk/src/lib/kungorelser/proxy-init.ts","../../../../../../CLAUDE/projects/LoopDesk/src/lib/kungorelser/proxy-manager.ts","../../../../../../CLAUDE/projects/LoopDesk/src/lib/kungorelser/scheduler.ts","../../../../../../CLAUDE/projects/LoopDesk/src/app/api/kungorelser/schedule/run-now/route.ts","../../../../../../CLAUDE/projects/LoopDesk/node_modules/next/src/build/templates/app-route.ts"],"sourcesContent":["export type ActionRevalidationKind = 0 | 1 | 2\n\nexport const ActionDidNotRevalidate = 0\nexport const ActionDidRevalidateStaticAndDynamic = 1\nexport const ActionDidRevalidateDynamicOnly = 2\n","if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-rsc']!.React\n","/**\n * Rate limiting and account lockout for authentication\n *\n * Rules:\n * - Max 5 failed attempts per minute (rate limit)\n * - Max 10 total failed attempts before account lockout\n * - Lockout duration: 15 minutes\n */\n\nimport { prisma } from \"@/lib/db\";\n\ninterface RateLimitResult {\n  allowed: boolean;\n  error?: \"RATE_LIMITED\" | \"ACCOUNT_LOCKED\" | \"ACCOUNT_NOT_FOUND\" | \"INVALID_CREDENTIALS\";\n  remainingAttempts?: number;\n  lockoutMinutes?: number;\n  retryAfterSeconds?: number;\n}\n\n// In-memory store for rate limiting (per-minute tracking)\n// In production, consider using Redis for distributed systems\nconst rateLimitStore = new Map<string, { attempts: number; windowStart: number }>();\n\nconst RATE_LIMIT_WINDOW_MS = 60 * 1000; // 1 minute\nconst MAX_ATTEMPTS_PER_WINDOW = 5;\nconst MAX_FAILED_ATTEMPTS_BEFORE_LOCKOUT = 10;\nconst LOCKOUT_DURATION_MS = 15 * 60 * 1000; // 15 minutes\n\n/**\n * Check if a login attempt is allowed based on rate limiting\n */\nfunction checkRateLimit(email: string): { allowed: boolean; retryAfterSeconds?: number } {\n  const now = Date.now();\n  const key = email.toLowerCase();\n  const record = rateLimitStore.get(key);\n\n  if (!record) {\n    rateLimitStore.set(key, { attempts: 1, windowStart: now });\n    return { allowed: true };\n  }\n\n  // Check if we're in a new window\n  if (now - record.windowStart > RATE_LIMIT_WINDOW_MS) {\n    rateLimitStore.set(key, { attempts: 1, windowStart: now });\n    return { allowed: true };\n  }\n\n  // Check if rate limit exceeded\n  if (record.attempts >= MAX_ATTEMPTS_PER_WINDOW) {\n    const retryAfterSeconds = Math.ceil((record.windowStart + RATE_LIMIT_WINDOW_MS - now) / 1000);\n    return { allowed: false, retryAfterSeconds };\n  }\n\n  // Increment attempts\n  record.attempts++;\n  return { allowed: true };\n}\n\n/**\n * Reset rate limit for an email (called on successful login)\n */\nfunction resetRateLimit(email: string): void {\n  rateLimitStore.delete(email.toLowerCase());\n}\n\n/**\n * Check if account is locked and handle failed attempt tracking\n */\nexport async function checkLoginAttempt(email: string): Promise<RateLimitResult> {\n  // First check rate limit\n  const rateLimitCheck = checkRateLimit(email);\n  if (!rateLimitCheck.allowed) {\n    return {\n      allowed: false,\n      error: \"RATE_LIMITED\",\n      retryAfterSeconds: rateLimitCheck.retryAfterSeconds,\n    };\n  }\n\n  // Check if user exists and if account is locked\n  try {\n    const user = await prisma.user.findUnique({\n      where: { email: email.toLowerCase() },\n      select: {\n        id: true,\n        failedLoginAttempts: true,\n        lockedUntil: true,\n      },\n    });\n\n    if (!user) {\n      return { allowed: true }; // Let auth handle \"user not found\"\n    }\n\n    // Check if account is locked\n    if (user.lockedUntil && new Date(user.lockedUntil) > new Date()) {\n      const lockoutMinutes = Math.ceil(\n        (new Date(user.lockedUntil).getTime() - Date.now()) / (60 * 1000)\n      );\n      return {\n        allowed: false,\n        error: \"ACCOUNT_LOCKED\",\n        lockoutMinutes,\n      };\n    }\n\n    // If lock has expired, reset it\n    if (user.lockedUntil && new Date(user.lockedUntil) <= new Date()) {\n      await prisma.user.update({\n        where: { id: user.id },\n        data: {\n          failedLoginAttempts: 0,\n          lockedUntil: null,\n        },\n      });\n    }\n\n    const remainingAttempts = MAX_FAILED_ATTEMPTS_BEFORE_LOCKOUT - (user.failedLoginAttempts || 0);\n    return { allowed: true, remainingAttempts };\n  } catch (error) {\n    console.error(\"[RateLimit] Error checking login attempt:\", error);\n    return { allowed: true }; // Fail open - allow attempt if DB error\n  }\n}\n\n/**\n * Record a failed login attempt\n */\nexport async function recordFailedAttempt(email: string): Promise<RateLimitResult> {\n  try {\n    const user = await prisma.user.findUnique({\n      where: { email: email.toLowerCase() },\n      select: { id: true, failedLoginAttempts: true },\n    });\n\n    if (!user) {\n      return { allowed: false, error: \"ACCOUNT_NOT_FOUND\" };\n    }\n\n    const newFailedAttempts = (user.failedLoginAttempts || 0) + 1;\n    const shouldLock = newFailedAttempts >= MAX_FAILED_ATTEMPTS_BEFORE_LOCKOUT;\n\n    await prisma.user.update({\n      where: { id: user.id },\n      data: {\n        failedLoginAttempts: newFailedAttempts,\n        lockedUntil: shouldLock ? new Date(Date.now() + LOCKOUT_DURATION_MS) : null,\n      },\n    });\n\n    if (shouldLock) {\n      return {\n        allowed: false,\n        error: \"ACCOUNT_LOCKED\",\n        lockoutMinutes: 15,\n      };\n    }\n\n    return {\n      allowed: false,\n      error: \"INVALID_CREDENTIALS\",\n      remainingAttempts: MAX_FAILED_ATTEMPTS_BEFORE_LOCKOUT - newFailedAttempts,\n    };\n  } catch (error) {\n    console.error(\"[RateLimit] Error recording failed attempt:\", error);\n    return { allowed: false, error: \"INVALID_CREDENTIALS\" };\n  }\n}\n\n/**\n * Record a successful login (reset failed attempts)\n */\nexport async function recordSuccessfulLogin(email: string): Promise<void> {\n  resetRateLimit(email);\n\n  try {\n    await prisma.user.update({\n      where: { email: email.toLowerCase() },\n      data: {\n        failedLoginAttempts: 0,\n        lockedUntil: null,\n        lastLoginAt: new Date(),\n      },\n    });\n  } catch (error) {\n    console.error(\"[RateLimit] Error recording successful login:\", error);\n  }\n}\n\n/**\n * Get error message for display\n */\nexport function getErrorMessage(error: RateLimitResult[\"error\"], details?: RateLimitResult): string {\n  switch (error) {\n    case \"RATE_LIMITED\":\n      return `För många försök. Vänta ${details?.retryAfterSeconds || 60} sekunder.`;\n    case \"ACCOUNT_LOCKED\":\n      return `Kontot är låst i ${details?.lockoutMinutes || 15} minuter pga för många misslyckade försök.`;\n    case \"ACCOUNT_NOT_FOUND\":\n      return \"Inget konto hittades med denna e-postadress.\";\n    case \"INVALID_CREDENTIALS\":\n      if (details?.remainingAttempts !== undefined && details.remainingAttempts <= 3) {\n        return `Fel lösenord. ${details.remainingAttempts} försök kvar innan kontot låses.`;\n      }\n      return \"Fel e-postadress eller lösenord.\";\n    default:\n      return \"Något gick fel. Försök igen.\";\n  }\n}\n","/**\n * Proxy Manager Initialization - Auto-refresh for Railway deployments\n *\n * Railway assigns new IP on each deploy → proxies need refreshing\n * This module ensures proxies are always fresh\n */\n\nimport { proxyManager } from './proxy-manager';\n\n// Track last refresh\nlet lastRefresh = 0;\nlet refreshInterval: NodeJS.Timeout | null = null;\n\n// Refresh interval: 4 hours (14400000ms)\nconst REFRESH_INTERVAL_MS = 4 * 60 * 60 * 1000;\n\n/**\n * Initialize proxy auto-refresh\n * Called once when app starts\n */\nexport async function initializeProxyManager(): Promise<void> {\n  // Only initialize if 2captcha API key is configured\n  if (!process.env.TWOCAPTCHA_API_KEY) {\n    console.log('[ProxyInit] Skipping proxy initialization (no API key)');\n    return;\n  }\n  if (process.env.PROXY_SERVER && process.env.PROXY_SERVER !== 'disabled') {\n    console.log('[ProxyInit] Static proxy configured, loading...');\n    await proxyManager.fetchProxies();\n    await proxyManager.activate('Static proxy configured');\n    const status = proxyManager.getStatus();\n    console.log(`[ProxyInit] Static proxy ready - ${status.available}/${status.total} proxies`);\n    return;\n  }\n\n  console.log('[ProxyInit] Initializing proxy auto-refresh...');\n\n  // Initial refresh\n  try {\n    await refreshProxies();\n  } catch (error) {\n    console.error('[ProxyInit] Initial refresh failed:', error);\n  }\n\n  // Set up periodic refresh (every 4 hours)\n  if (refreshInterval) {\n    clearInterval(refreshInterval);\n  }\n\n  refreshInterval = setInterval(async () => {\n    try {\n      await refreshProxies();\n    } catch (error) {\n      console.error('[ProxyInit] Periodic refresh failed:', error);\n    }\n  }, REFRESH_INTERVAL_MS);\n\n  console.log(`[ProxyInit] Auto-refresh scheduled every ${REFRESH_INTERVAL_MS / 1000 / 60 / 60} hours`);\n}\n\n/**\n * Refresh proxies if needed\n */\nasync function refreshProxies(): Promise<void> {\n  const now = Date.now();\n\n  // Skip if refreshed recently (within 5 minutes)\n  if (now - lastRefresh < 5 * 60 * 1000) {\n    console.log('[ProxyInit] Skipping refresh (too recent)');\n    return;\n  }\n\n  console.log('[ProxyInit] Refreshing proxies...');\n  await proxyManager.refresh();\n  lastRefresh = now;\n\n  const status = proxyManager.getStatus();\n  console.log(`[ProxyInit] Refresh complete - ${status.available}/${status.total} proxies available`);\n}\n\n/**\n * Force refresh proxies (called on-demand)\n * This calls proxyManager.fetchProxies() to actually update the proxy pool\n */\nexport async function forceRefreshProxies(): Promise<void> {\n  console.log('[ProxyInit] Force refreshing proxies via proxyManager...');\n  lastRefresh = 0; // Reset to allow immediate refresh\n\n  const apiKey = process.env.TWOCAPTCHA_API_KEY;\n  if (!apiKey) {\n    console.log('[ProxyInit] No API key configured - cannot fetch proxies');\n    return;\n  }\n\n  try {\n    // Use proxyManager.fetchProxies() to actually populate the proxy pool\n    const proxies = await proxyManager.fetchProxies();\n    console.log(`[ProxyInit] ProxyManager now has ${proxies.length} proxies`);\n\n    // Also ensure proxy mode is active\n    if (proxies.length > 0 && !proxyManager.getStatus().isActive) {\n      await proxyManager.activate('Force refresh - proxies available');\n    }\n  } catch (error) {\n    console.error('[ProxyInit] Failed to refresh proxies:', error);\n  }\n}\n\n/**\n * Stop auto-refresh (cleanup)\n */\nexport function stopProxyRefresh(): void {\n  if (refreshInterval) {\n    clearInterval(refreshInterval);\n    refreshInterval = null;\n    console.log('[ProxyInit] Auto-refresh stopped');\n  }\n}\n\n// Auto-initialize on import (happens once per Node.js process)\nif (typeof window === 'undefined') {\n  // Only run in server environment\n  initializeProxyManager().catch(err => {\n    console.error('[ProxyInit] Failed to initialize:', err);\n  });\n}\n","// Remove top-level constants that might be stale\n// const API_KEY = process.env.TWOCAPTCHA_API_KEY || '';\n// const STATIC_PROXY_SERVER = process.env.PROXY_SERVER || '';\n// ...\n\nfunction normalizeProxyServer(server: string): string {\n  if (!server) return server;\n  if (server.includes('://')) {\n    return server;\n  }\n  return `http://${server}`;\n}\n\nexport interface Proxy {\n  id: string;\n  host: string;\n  port: number;\n  url: string;\n  source: string;\n  username?: string;\n  password?: string;\n}\n\nexport interface BlockingStats {\n  http429Count: number;\n  consecutiveCaptchas: number;\n  lastCaptchaTime: number;\n  sessionBlocked: boolean;\n}\n\n// Thresholds for proxy activation\nconst THRESHOLDS = {\n  HTTP_429_COUNT: 3,        // Activate after 3 rate limit responses\n  CONSECUTIVE_CAPTCHAS: 5,  // Activate after 5 consecutive CAPTCHAs\n  CAPTCHA_BURST_WINDOW: 60000, // 1 minute window for burst detection\n  CAPTCHA_BURST_COUNT: 3,   // 3 CAPTCHAs in 1 minute triggers activation\n};\n\nclass ProxyManager {\n  private proxies: Proxy[] = [];\n  private currentIndex = 0;\n  private isActive = false;\n  private lastFetchTime = 0;\n  private fetchCooldown = 300000; // 5 minutes between fetches\n  private balance = 0;\n  private blockingStats: BlockingStats = {\n    http429Count: 0,\n    consecutiveCaptchas: 0,\n    lastCaptchaTime: 0,\n    sessionBlocked: false,\n  };\n  private captchaTimes: number[] = [];\n  private failedProxies = new Set<string>();\n  private proxyFailures = new Map<string, number>();\n  private maxFailures = 3;\n  private activationReason: string | null = null;\n\n  // ... (methods shouldActivate, recordCaptcha, etc. - no changes needed)\n\n  /**\n   * Check if proxy should be activated based on blocking stats\n   */\n  shouldActivate(): { shouldActivate: boolean; reason: string | null } {\n    if (this.isActive) {\n      return { shouldActivate: false, reason: null };\n    }\n\n    // Check HTTP 429 count\n    if (this.blockingStats.http429Count >= THRESHOLDS.HTTP_429_COUNT) {\n      return {\n        shouldActivate: true,\n        reason: `Rate limited ${this.blockingStats.http429Count} times`,\n      };\n    }\n\n    // Check consecutive CAPTCHAs\n    if (this.blockingStats.consecutiveCaptchas >= THRESHOLDS.CONSECUTIVE_CAPTCHAS) {\n      return {\n        shouldActivate: true,\n        reason: `${this.blockingStats.consecutiveCaptchas} consecutive CAPTCHAs`,\n      };\n    }\n\n    // Check CAPTCHA burst (many CAPTCHAs in short time)\n    const now = Date.now();\n    const recentCaptchas = this.captchaTimes.filter(\n      (t) => now - t < THRESHOLDS.CAPTCHA_BURST_WINDOW\n    );\n    if (recentCaptchas.length >= THRESHOLDS.CAPTCHA_BURST_COUNT) {\n      return {\n        shouldActivate: true,\n        reason: `${recentCaptchas.length} CAPTCHAs in ${THRESHOLDS.CAPTCHA_BURST_WINDOW / 1000}s`,\n      };\n    }\n\n    // Check session blocked flag\n    if (this.blockingStats.sessionBlocked) {\n      return {\n        shouldActivate: true,\n        reason: 'Session blocked',\n      };\n    }\n\n    return { shouldActivate: false, reason: null };\n  }\n\n  /**\n   * Record a CAPTCHA encounter\n   */\n  recordCaptcha(): void {\n    const now = Date.now();\n    this.blockingStats.consecutiveCaptchas++;\n    this.blockingStats.lastCaptchaTime = now;\n    this.captchaTimes.push(now);\n\n    // Clean old captcha times\n    this.captchaTimes = this.captchaTimes.filter(\n      (t) => now - t < THRESHOLDS.CAPTCHA_BURST_WINDOW * 2\n    );\n\n    console.log(\n      `[ProxyManager] CAPTCHA recorded: consecutive=${this.blockingStats.consecutiveCaptchas}`\n    );\n  }\n\n  /**\n   * Record a successful request (resets consecutive counter)\n   */\n  recordSuccess(): void {\n    this.blockingStats.consecutiveCaptchas = 0;\n  }\n\n  /**\n   * Record an HTTP 429 response\n   */\n  recordRateLimit(): void {\n    this.blockingStats.http429Count++;\n    console.log(\n      `[ProxyManager] Rate limit recorded: count=${this.blockingStats.http429Count}`\n    );\n  }\n\n  /**\n   * Record session blocked\n   */\n  recordSessionBlocked(): void {\n    this.blockingStats.sessionBlocked = true;\n    console.log('[ProxyManager] Session blocked recorded');\n  }\n\n  /**\n   * Reset blocking stats\n   */\n  resetStats(): void {\n    this.blockingStats = {\n      http429Count: 0,\n      consecutiveCaptchas: 0,\n      lastCaptchaTime: 0,\n      sessionBlocked: false,\n    };\n    this.captchaTimes = [];\n  }\n\n  /**\n   * Fetch proxies from 2captcha API (credential-based residential proxies)\n   */\n  async fetchProxies(): Promise<Proxy[]> {\n    // Read env vars fresh\n    const STATIC_PROXY_SERVER = process.env.PROXY_SERVER || '';\n    const STATIC_PROXY_USERNAME = process.env.PROXY_USERNAME || '';\n    const STATIC_PROXY_PASSWORD = process.env.PROXY_PASSWORD || '';\n    const API_KEY = process.env.TWOCAPTCHA_API_KEY || '';\n\n    // Priority 1: Static Env Var\n    if (STATIC_PROXY_SERVER && STATIC_PROXY_SERVER !== 'disabled') {\n      const server = normalizeProxyServer(STATIC_PROXY_SERVER);\n      const hostPort = server.replace(/^[a-z]+:\\/\\//, '').split('/')[0];\n      const [host, portRaw] = hostPort.split(':');\n      const port = parseInt(portRaw || '80', 10);\n\n      this.proxies = [\n        {\n          id: server,\n          host,\n          port,\n          url: server,\n          source: 'static',\n          username: STATIC_PROXY_USERNAME || undefined,\n          password: STATIC_PROXY_PASSWORD || undefined,\n        },\n      ];\n      this.lastFetchTime = Date.now();\n      this.failedProxies.clear();\n      this.proxyFailures.clear();\n      console.log('[ProxyManager] Using static proxy from environment');\n      return this.proxies;\n    }\n\n    // Priority 2: No API key - proxy functionality disabled\n    if (!API_KEY) {\n      console.log('[ProxyManager] No API key configured - proxy functionality disabled');\n      console.log('[ProxyManager] Set TWOCAPTCHA_API_KEY or PROXY_SERVER to enable proxies');\n      this.proxies = [];\n      return this.proxies;\n    }\n\n    const now = Date.now();\n    if (now - this.lastFetchTime < this.fetchCooldown && this.proxies.length > 0) {\n      console.log('[ProxyManager] Using cached proxies');\n      return this.proxies;\n    }\n\n    try {\n      console.log('[ProxyManager] Fetching 10 SE proxies from 2captcha...');\n\n      const url = new URL('https://api.2captcha.com/proxy');\n      url.searchParams.set('key', API_KEY);\n      url.searchParams.set('country', 'se');\n      url.searchParams.set('type', 'residential');\n      url.searchParams.set('limit', '10');\n\n      const response = await fetch(url.toString());\n      const data = await response.json();\n\n      if (data.status === 'OK' && Array.isArray(data.data)) {\n        const proxies = data.data\n          .map((entry: string | Record<string, unknown>) => {\n            if (typeof entry === 'string') {\n              const [host, port] = entry.split(':');\n              if (!host || !port) return null;\n              return {\n                id: entry,\n                host,\n                port: parseInt(port, 10),\n                url: `http://${entry}`,\n                source: '2captcha',\n              };\n            }\n\n            const proxyObj = entry as Record<string, unknown>;\n            const proxyString = (proxyObj.proxy || proxyObj.proxy_string || proxyObj.ip_port) as\n              | string\n              | undefined;\n            const host =\n              (proxyObj.host as string | undefined) ||\n              (proxyObj.ip as string | undefined) ||\n              (proxyString ? proxyString.split(':')[0] : undefined);\n            const portValue =\n              (proxyObj.port as number | string | undefined) ||\n              (proxyString ? proxyString.split(':')[1] : undefined);\n\n            if (!host || !portValue) return null;\n\n            const port = typeof portValue === 'string' ? parseInt(portValue, 10) : portValue;\n            const protocol =\n              (proxyObj.protocol as string | undefined) ||\n              (proxyObj.type as string | undefined) ||\n              'http';\n            const username =\n              (proxyObj.login as string | undefined) ||\n              (proxyObj.username as string | undefined) ||\n              (proxyObj.user as string | undefined);\n            const password =\n              (proxyObj.password as string | undefined) ||\n              (proxyObj.pass as string | undefined);\n\n            return {\n              id: `${host}:${port}`,\n              host,\n              port,\n              url: `${protocol}://${host}:${port}`,\n              source: '2captcha',\n              username,\n              password,\n            };\n          })\n          .filter((proxy: Proxy | null): proxy is Proxy => Boolean(proxy));\n\n        this.proxies = proxies;\n        this.lastFetchTime = now;\n        this.failedProxies.clear();\n        this.proxyFailures.clear();\n        console.log(`[ProxyManager] Got ${this.proxies.length} proxies from 2captcha`);\n      } else {\n        console.error(`[ProxyManager] 2captcha error: ${data.message || JSON.stringify(data)}`);\n      }\n    } catch (error) {\n      console.error('[ProxyManager] Error fetching proxies:', error);\n    }\n\n    return this.proxies;\n  }\n\n  /**\n   * Check 2captcha balance\n   */\n  async checkBalance(): Promise<number> {\n    const API_KEY = process.env.TWOCAPTCHA_API_KEY || '';\n    if (!API_KEY) return 0;\n\n    try {\n      const url = new URL('https://2captcha.com/res.php');\n      url.searchParams.set('key', API_KEY);\n      url.searchParams.set('action', 'getbalance');\n      url.searchParams.set('json', '1');\n\n      const response = await fetch(url.toString());\n      const result = await response.json();\n\n      if (result.status === 1) {\n        this.balance = parseFloat(result.request);\n        return this.balance;\n      }\n    } catch (error) {\n      console.error('[ProxyManager] Error checking balance:', error);\n    }\n\n    return 0;\n  }\n\n  /**\n   * Activate proxy mode (like Electron app)\n   */\n  async activate(reason: string): Promise<boolean> {\n    if (this.isActive) {\n      console.log('[ProxyManager] Already active');\n      return true;\n    }\n\n    console.log(`[ProxyManager] ACTIVATING PROXY - Reason: ${reason}`);\n    this.isActive = true;\n    this.activationReason = reason;\n\n    const proxies = await this.fetchProxies();\n    if (proxies.length === 0) {\n      console.warn('[ProxyManager] No proxies available');\n      return false;\n    }\n\n    this.currentIndex = 0;\n    this.resetStats();\n\n    console.log(`[ProxyManager] Activated with ${proxies.length} proxies`);\n    return true;\n  }\n\n  /**\n   * Deactivate proxy mode\n   */\n  deactivate(): void {\n    console.log('[ProxyManager] Deactivating proxy');\n    this.isActive = false;\n    this.activationReason = null;\n    this.resetStats();\n  }\n\n  /**\n   * Get current proxy for Playwright (supports credentials)\n   */\n  getCurrentProxy(): { server: string; username?: string; password?: string } | null {\n    if (!this.isActive || this.proxies.length === 0) {\n      return null;\n    }\n\n    const proxy = this.proxies[this.currentIndex];\n    return {\n      server: proxy.url,\n      username: proxy.username,\n      password: proxy.password,\n    };\n  }\n\n  /**\n   * Mark proxy as failed\n   */\n  markFailed(proxy: Proxy | { server: string } | null): void {\n    if (!proxy) return;\n\n    const proxyUrl = 'server' in proxy ? proxy.server : proxy.url;\n    const failures = (this.proxyFailures.get(proxyUrl) || 0) + 1;\n    this.proxyFailures.set(proxyUrl, failures);\n\n    if (failures >= this.maxFailures) {\n      console.log(`[ProxyManager] Proxy ${proxyUrl} marked as failed`);\n      this.failedProxies.add(proxyUrl);\n    }\n  }\n\n  /**\n   * Mark proxy as successful\n   */\n  markSuccess(proxy: Proxy | { server: string } | null): void {\n    if (!proxy) return;\n\n    const proxyUrl = 'server' in proxy ? proxy.server : proxy.url;\n    this.proxyFailures.set(proxyUrl, 0);\n  }\n\n  /**\n   * Get Playwright browser context options with proxy\n   */\n  getPlaywrightConfig(\n    proxy?: Proxy | { server: string; username?: string; password?: string } | null\n  ): { proxy?: { server: string; username?: string; password?: string } } {\n    // If no proxy provided, use current proxy\n    const proxyToUse = proxy || this.getCurrentProxy();\n    if (!proxyToUse) return {};\n\n    const server = 'server' in proxyToUse ? proxyToUse.server : proxyToUse.url;\n    const username = (proxyToUse as { username?: string }).username;\n    const password = (proxyToUse as { password?: string }).password;\n    return {\n      proxy: {\n        server,\n        username,\n        password,\n      },\n    };\n  }\n\n  /**\n   * Get next proxy and rotate (skip failed proxies like Electron)\n   */\n  getNext(): Proxy | null {\n    if (!this.isActive || this.proxies.length === 0) {\n      return null;\n    }\n\n    // Find next non-failed proxy\n    let attempts = 0;\n    while (attempts < this.proxies.length) {\n      const proxy = this.proxies[this.currentIndex];\n      this.currentIndex = (this.currentIndex + 1) % this.proxies.length;\n\n      if (!this.failedProxies.has(proxy.url)) {\n        return proxy;\n      }\n      attempts++;\n    }\n\n    // All proxies failed, reset and return first\n    console.log('[ProxyManager] All proxies exhausted, resetting...');\n    this.failedProxies.clear();\n    this.proxyFailures.clear();\n    return this.proxies[0] || null;\n  }\n\n  /**\n   * Rotate to next proxy\n   */\n  rotateProxy(): void {\n    if (this.proxies.length === 0) return;\n    this.currentIndex = (this.currentIndex + 1) % this.proxies.length;\n    console.log(`[ProxyManager] Rotated to proxy ${this.currentIndex + 1}/${this.proxies.length}`);\n  }\n\n  /**\n   * Get current status (like Electron app)\n   */\n  getStatus(): {\n    isActive: boolean;\n    enabled: boolean;\n    reason: string | null;\n    total: number;\n    failed: number;\n    available: number;\n  } {\n    return {\n      isActive: this.isActive,\n      enabled: this.isActive,\n      reason: this.activationReason,\n      total: this.proxies.length,\n      failed: this.failedProxies.size,\n      available: this.proxies.length - this.failedProxies.size,\n    };\n  }\n\n  /**\n   * Refresh proxies if running low\n   */\n  async refresh(): Promise<void> {\n    const now = Date.now();\n    if (now - this.lastFetchTime < this.fetchCooldown && this.proxies.length >= 3) {\n      return;\n    }\n\n    try {\n      // Check balance first\n      const balance = await this.checkBalance();\n      if (balance < 0.1) {\n        console.warn(`[ProxyManager] Low balance: $${balance} - proxy disabled`);\n        return;\n      }\n\n      const newProxies = await this.fetchProxies();\n\n      if (newProxies.length > 0) {\n        this.proxies = newProxies;\n        this.currentIndex = 0;\n        this.lastFetchTime = now;\n        this.failedProxies.clear();\n        this.proxyFailures.clear();\n        console.log(`[ProxyManager] Refreshed ${newProxies.length} proxies`);\n      }\n    } catch (err) {\n      console.error(`[ProxyManager] Refresh failed:`, err);\n    }\n  }\n\n  /**\n   * Get stats for monitoring\n   */\n  getStats() {\n    return {\n      enabled: this.isActive,\n      reason: this.activationReason,\n      total: this.proxies.length,\n      failed: this.failedProxies.size,\n      available: this.proxies.length - this.failedProxies.size,\n    };\n  }\n}\n\n// Singleton instance\nexport const proxyManager = new ProxyManager();\n\nexport default proxyManager;\n","/**\n * Kungörelser Scheduler - Optimized for 1210+ companies\n *\n * Features:\n * - Parallel processing (3 concurrent)\n * - Smart cache invalidation (24h stale threshold)\n * - Priority ordering (oldest scraped first)\n * - Circuit breaker pattern\n * - Database-persisted state for Railway restarts\n */\n\nimport { prisma } from '@/lib/db';\nimport { searchAndSaveAnnouncements } from './index';\n\n// Configuration limits\nconst LIMITS = {\n  SCRAPER_TIMEOUT_MS: 5 * 60 * 1000,           // 5 min max per scrape\n  SCHEDULE_MAX_RUNTIME_MS: 8 * 60 * 60 * 1000, // 8 hours max for scheduled runs\n  MAX_CONSECUTIVE_FAILURES: 10,                 // Circuit breaker threshold\n  CACHE_STALE_HOURS: 24,                        // Re-scrape if cache older than this\n  SCHEDULE_CONCURRENCY: 3,                      // Process multiple companies in parallel\n  DELAY_BETWEEN_COMPANIES_MS: 1500,             // 1.5 sec delay\n  DELAY_BETWEEN_BATCHES_MS: 30000,              // 30 sec between batches\n};\n\n// Schedule intervals in milliseconds\nconst INTERVALS: Record<string, number> = {\n  hourly: 60 * 60 * 1000,\n  every2h: 2 * 60 * 60 * 1000,\n  every4h: 4 * 60 * 60 * 1000,\n  every6h: 6 * 60 * 60 * 1000,\n  every8h: 8 * 60 * 60 * 1000,\n  every12h: 12 * 60 * 60 * 1000,\n  daily: 24 * 60 * 60 * 1000,\n  weekly: 7 * 24 * 60 * 60 * 1000,\n};\n\n// In-memory state (resets on restart, but DB state is persistent)\nlet scheduleTimer: NodeJS.Timeout | null = null;\nlet isRunning = false;\nlet shouldStop = false;\nlet runProgress = {\n  currentBatch: 0,\n  totalBatches: 0,\n  companiesProcessed: 0,\n  companiesSkipped: 0,\n  newAnnouncementsFound: 0,\n  startTime: null as Date | null,\n  consecutiveFailures: 0,\n};\n\nexport interface ScheduleState {\n  enabled: boolean;\n  interval: string;\n  lastRun: Date | null;\n  nextRun: Date | null;\n  isRunning: boolean;\n  currentBatch: number;\n  totalBatches: number;\n  companiesProcessed: number;\n  companiesSkipped: number;\n  newAnnouncementsFound: number;\n  estimatedTimeRemaining: number | null;\n}\n\n/**\n * Get schedule state from database\n */\nexport async function getScheduleState(): Promise<ScheduleState> {\n  const stats = await prisma.announcementScrapeStats.findUnique({\n    where: { id: 'stats' },\n  });\n\n  const now = new Date();\n  const interval = stats?.delayMs ? getIntervalName(stats.delayMs) : 'daily';\n  const intervalMs = INTERVALS[interval] || INTERVALS.daily;\n  const nextRun = stats?.lastSearchAt\n    ? new Date(stats.lastSearchAt.getTime() + intervalMs)\n    : null;\n\n  // Calculate estimated time remaining\n  let estimatedTimeRemaining: number | null = null;\n  if (isRunning && runProgress.startTime && runProgress.companiesProcessed > 0) {\n    const elapsedMs = now.getTime() - runProgress.startTime.getTime();\n    const avgTimePerCompany = elapsedMs / runProgress.companiesProcessed;\n    const remainingCompanies = (runProgress.totalBatches * LIMITS.SCHEDULE_CONCURRENCY) - runProgress.companiesProcessed;\n    estimatedTimeRemaining = Math.round((avgTimePerCompany * remainingCompanies) / 60000); // minutes\n  }\n\n  return {\n    enabled: stats?.isRunning ?? false,\n    interval,\n    lastRun: stats?.lastSearchAt ?? null,\n    nextRun,\n    isRunning,\n    currentBatch: runProgress.currentBatch,\n    totalBatches: runProgress.totalBatches,\n    companiesProcessed: runProgress.companiesProcessed,\n    companiesSkipped: runProgress.companiesSkipped,\n    newAnnouncementsFound: runProgress.newAnnouncementsFound,\n    estimatedTimeRemaining,\n  };\n}\n\n/**\n * Get interval name from milliseconds\n */\nfunction getIntervalName(ms: number): string {\n  for (const [name, value] of Object.entries(INTERVALS)) {\n    if (value === ms) return name;\n  }\n  return 'daily';\n}\n\n/**\n * Update schedule configuration\n */\nexport async function updateScheduleConfig(config: { enabled?: boolean; interval?: string }): Promise<ScheduleState> {\n  const intervalMs = config.interval ? (INTERVALS[config.interval] || INTERVALS.daily) : undefined;\n\n  await prisma.announcementScrapeStats.upsert({\n    where: { id: 'stats' },\n    create: {\n      id: 'stats',\n      totalSearches: 0,\n      totalAnnouncements: 0,\n      isRunning: config.enabled ?? false,\n      delayMs: intervalMs ?? INTERVALS.daily,\n    },\n    update: {\n      isRunning: config.enabled,\n      delayMs: intervalMs,\n    },\n  });\n\n  // Handle timer based on enabled state\n  if (config.enabled === false) {\n    stopScheduleTimer();\n  } else if (config.enabled === true) {\n    startScheduleTimer();\n  }\n\n  return getScheduleState();\n}\n\n/**\n * Start schedule timer\n */\nfunction startScheduleTimer() {\n  if (scheduleTimer) clearInterval(scheduleTimer);\n\n  // Check every minute if it's time to run\n  scheduleTimer = setInterval(async () => {\n    try {\n      const state = await getScheduleState();\n      if (state.enabled && !isRunning && state.nextRun && new Date() >= state.nextRun) {\n        await runScheduledScrape();\n      }\n    } catch (error) {\n      console.error('[Scheduler] Timer check error:', error);\n    }\n  }, 60000);\n}\n\n/**\n * Stop schedule timer\n */\nfunction stopScheduleTimer() {\n  if (scheduleTimer) {\n    clearInterval(scheduleTimer);\n    scheduleTimer = null;\n  }\n}\n\n/**\n * Stop current running scrape\n */\nexport async function stopScheduledRun(): Promise<{ success: boolean; message: string }> {\n  if (!isRunning) {\n    return { success: false, message: 'No scheduled run is currently running' };\n  }\n\n  shouldStop = true;\n  return { success: true, message: 'Stop signal sent, will stop after current batch' };\n}\n\n/**\n * Run scheduled scrape immediately\n */\nexport async function runScheduledScrape(): Promise<{ success: boolean; message: string }> {\n  if (isRunning) {\n    return { success: false, message: 'Scheduled run already in progress' };\n  }\n\n  // Reset progress\n  isRunning = true;\n  shouldStop = false;\n  runProgress = {\n    currentBatch: 0,\n    totalBatches: 0,\n    companiesProcessed: 0,\n    companiesSkipped: 0,\n    newAnnouncementsFound: 0,\n    startTime: new Date(),\n    consecutiveFailures: 0,\n  };\n\n  // Run asynchronously\n  runScrapeLoop().catch((error) => {\n    console.error('[Scheduler] Scrape loop error:', error);\n    isRunning = false;\n  });\n\n  return { success: true, message: 'Scheduled run started' };\n}\n\n/**\n * Main scrape loop - processes all watched companies\n */\nasync function runScrapeLoop() {\n  const startTime = Date.now();\n  console.log('[Scheduler] Starting scheduled run...');\n\n  try {\n    // Get watched companies ordered by last scraped (oldest first)\n    const companies = await prisma.watchedCompany.findMany({\n      select: {\n        orgNumber: true,\n        name: true,\n        lastScraped: true,\n      },\n      orderBy: [\n        { lastScraped: 'asc' },  // Oldest first (nulls first in Postgres)\n        { createdAt: 'asc' },\n      ],\n    });\n\n    console.log(`[Scheduler] Found ${companies.length} watched companies`);\n\n    // Calculate batches\n    const totalBatches = Math.ceil(companies.length / LIMITS.SCHEDULE_CONCURRENCY);\n    runProgress.totalBatches = totalBatches;\n\n    // Process in parallel batches\n    for (let batchIndex = 0; batchIndex < totalBatches; batchIndex++) {\n      // Check stop conditions\n      if (shouldStop) {\n        console.log('[Scheduler] Stop requested, finishing...');\n        break;\n      }\n\n      if (Date.now() - startTime > LIMITS.SCHEDULE_MAX_RUNTIME_MS) {\n        console.log('[Scheduler] Max runtime reached, stopping...');\n        break;\n      }\n\n      if (runProgress.consecutiveFailures >= LIMITS.MAX_CONSECUTIVE_FAILURES) {\n        console.log('[Scheduler] Circuit breaker triggered, stopping...');\n        break;\n      }\n\n      runProgress.currentBatch = batchIndex + 1;\n      const batchStart = batchIndex * LIMITS.SCHEDULE_CONCURRENCY;\n      const batchEnd = Math.min(batchStart + LIMITS.SCHEDULE_CONCURRENCY, companies.length);\n      const batch = companies.slice(batchStart, batchEnd);\n\n      console.log(`[Scheduler] Processing batch ${batchIndex + 1}/${totalBatches} (${batch.length} companies)`);\n\n      // Process batch in parallel\n      const results = await Promise.allSettled(\n        batch.map((company) => processCompany(company))\n      );\n\n      // Update progress based on results\n      for (const result of results) {\n        if (result.status === 'fulfilled') {\n          if (result.value.skipped) {\n            runProgress.companiesSkipped++;\n          } else {\n            runProgress.newAnnouncementsFound += result.value.newAnnouncements;\n          }\n          runProgress.consecutiveFailures = 0;\n        } else {\n          runProgress.consecutiveFailures++;\n        }\n        runProgress.companiesProcessed++;\n      }\n\n      // Delay between batches\n      if (batchIndex < totalBatches - 1) {\n        await new Promise((r) => setTimeout(r, LIMITS.DELAY_BETWEEN_BATCHES_MS));\n      }\n    }\n\n    // Update stats\n    await prisma.announcementScrapeStats.update({\n      where: { id: 'stats' },\n      data: {\n        lastSearchAt: new Date(),\n        totalSearches: { increment: runProgress.companiesProcessed - runProgress.companiesSkipped },\n      },\n    });\n\n    console.log(`[Scheduler] Completed: ${runProgress.companiesProcessed} processed, ${runProgress.companiesSkipped} skipped, ${runProgress.newAnnouncementsFound} new announcements`);\n  } finally {\n    isRunning = false;\n  }\n}\n\n/**\n * Process a single company\n */\nasync function processCompany(company: { orgNumber: string; name: string; lastScraped: Date | null }): Promise<{ skipped: boolean; newAnnouncements: number }> {\n  const { orgNumber, lastScraped } = company;\n\n  // Check if cache is fresh enough\n  if (lastScraped) {\n    const ageHours = (Date.now() - lastScraped.getTime()) / (1000 * 60 * 60);\n    if (ageHours < LIMITS.CACHE_STALE_HOURS) {\n      console.log(`[Scheduler] Skipping ${orgNumber} - cache fresh (${ageHours.toFixed(1)}h old)`);\n      return { skipped: true, newAnnouncements: 0 };\n    }\n  }\n\n  try {\n    // Get existing announcement count\n    const existingCount = await prisma.announcement.count({\n      where: { orgNumber },\n    });\n\n    // Scrape with timeout\n    const announcements = await Promise.race([\n      searchAndSaveAnnouncements(orgNumber, { forceRefresh: true }),\n      new Promise<never>((_, reject) =>\n        setTimeout(() => reject(new Error('Scrape timeout')), LIMITS.SCRAPER_TIMEOUT_MS)\n      ),\n    ]);\n\n    // Update lastScraped on WatchedCompany\n    await prisma.watchedCompany.update({\n      where: { orgNumber },\n      data: { lastScraped: new Date() },\n    });\n\n    const newAnnouncements = Math.max(0, announcements.length - existingCount);\n    console.log(`[Scheduler] ${orgNumber}: ${announcements.length} total, ${newAnnouncements} new`);\n\n    // Small delay between companies\n    await new Promise((r) => setTimeout(r, LIMITS.DELAY_BETWEEN_COMPANIES_MS));\n\n    return { skipped: false, newAnnouncements };\n  } catch (error) {\n    console.error(`[Scheduler] Error scraping ${orgNumber}:`, error);\n    throw error;\n  }\n}\n\n/**\n * Get scheduler limits configuration\n */\nexport function getSchedulerLimits() {\n  return {\n    cacheStaleHours: LIMITS.CACHE_STALE_HOURS,\n    concurrency: LIMITS.SCHEDULE_CONCURRENCY,\n    maxRuntimeHours: LIMITS.SCHEDULE_MAX_RUNTIME_MS / (60 * 60 * 1000),\n    delayBetweenCompaniesMs: LIMITS.DELAY_BETWEEN_COMPANIES_MS,\n    delayBetweenBatchesMs: LIMITS.DELAY_BETWEEN_BATCHES_MS,\n  };\n}\n","import { NextResponse } from \"next/server\";\nimport { auth } from \"@/auth\";\nimport { runScheduledScrape } from \"@/lib/kungorelser/scheduler\";\n\n/**\n * POST /api/kungorelser/schedule/run-now\n *\n * Trigger an immediate scheduled run\n */\nexport async function POST() {\n  try {\n    const session = await auth();\n    if (!session?.user?.id) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    const result = await runScheduledScrape();\n\n    if (result.success) {\n      return NextResponse.json({\n        success: true,\n        message: result.message,\n      });\n    } else {\n      return NextResponse.json(\n        { error: result.message },\n        { status: 409 }  // Conflict - already running\n      );\n    }\n  } catch (error) {\n    console.error(\"Error starting scheduled run:\", error);\n    return NextResponse.json(\n      { error: \"Failed to start scheduled run\" },\n      { status: 500 }\n    );\n  }\n}\n","import {\n  AppRouteRouteModule,\n  type AppRouteRouteHandlerContext,\n  type AppRouteRouteModuleOptions,\n} from '../../server/route-modules/app-route/module.compiled'\nimport { RouteKind } from '../../server/route-kind'\nimport { patchFetch as _patchFetch } from '../../server/lib/patch-fetch'\nimport type { IncomingMessage, ServerResponse } from 'node:http'\nimport { addRequestMeta, getRequestMeta } from '../../server/request-meta'\nimport { getTracer, type Span, SpanKind } from '../../server/lib/trace/tracer'\nimport { setManifestsSingleton } from '../../server/app-render/manifests-singleton'\nimport { normalizeAppPath } from '../../shared/lib/router/utils/app-paths'\nimport { NodeNextRequest, NodeNextResponse } from '../../server/base-http/node'\nimport {\n  NextRequestAdapter,\n  signalFromNodeResponse,\n} from '../../server/web/spec-extension/adapters/next-request'\nimport { BaseServerSpan } from '../../server/lib/trace/constants'\nimport { getRevalidateReason } from '../../server/instrumentation/utils'\nimport { sendResponse } from '../../server/send-response'\nimport {\n  fromNodeOutgoingHttpHeaders,\n  toNodeOutgoingHttpHeaders,\n} from '../../server/web/utils'\nimport { getCacheControlHeader } from '../../server/lib/cache-control'\nimport { INFINITE_CACHE, NEXT_CACHE_TAGS_HEADER } from '../../lib/constants'\nimport { NoFallbackError } from '../../shared/lib/no-fallback-error.external'\nimport {\n  CachedRouteKind,\n  type ResponseCacheEntry,\n  type ResponseGenerator,\n} from '../../server/response-cache'\n\nimport * as userland from 'VAR_USERLAND'\n\n// These are injected by the loader afterwards. This is injected as a variable\n// instead of a replacement because this could also be `undefined` instead of\n// an empty string.\ndeclare const nextConfigOutput: AppRouteRouteModuleOptions['nextConfigOutput']\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\n// INJECT:nextConfigOutput\n\nconst routeModule = new AppRouteRouteModule({\n  definition: {\n    kind: RouteKind.APP_ROUTE,\n    page: 'VAR_DEFINITION_PAGE',\n    pathname: 'VAR_DEFINITION_PATHNAME',\n    filename: 'VAR_DEFINITION_FILENAME',\n    bundlePath: 'VAR_DEFINITION_BUNDLE_PATH',\n  },\n  distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n  relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n  resolvedPagePath: 'VAR_RESOLVED_PAGE_PATH',\n  nextConfigOutput,\n  userland,\n})\n\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule\n\nfunction patchFetch() {\n  return _patchFetch({\n    workAsyncStorage,\n    workUnitAsyncStorage,\n  })\n}\n\nexport {\n  routeModule,\n  workAsyncStorage,\n  workUnitAsyncStorage,\n  serverHooks,\n  patchFetch,\n}\n\nexport async function handler(\n  req: IncomingMessage,\n  res: ServerResponse,\n  ctx: {\n    waitUntil: (prom: Promise<void>) => void\n  }\n) {\n  if (routeModule.isDev) {\n    addRequestMeta(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint())\n  }\n  let srcPage = 'VAR_DEFINITION_PAGE'\n\n  // turbopack doesn't normalize `/index` in the page name\n  // so we need to to process dynamic routes properly\n  // TODO: fix turbopack providing differing value from webpack\n  if (process.env.TURBOPACK) {\n    srcPage = srcPage.replace(/\\/index$/, '') || '/'\n  } else if (srcPage === '/index') {\n    // we always normalize /index specifically\n    srcPage = '/'\n  }\n  const multiZoneDraftMode = process.env\n    .__NEXT_MULTI_ZONE_DRAFT_MODE as any as boolean\n\n  const prepareResult = await routeModule.prepare(req, res, {\n    srcPage,\n    multiZoneDraftMode,\n  })\n\n  if (!prepareResult) {\n    res.statusCode = 400\n    res.end('Bad Request')\n    ctx.waitUntil?.(Promise.resolve())\n    return null\n  }\n\n  const {\n    buildId,\n    params,\n    nextConfig,\n    parsedUrl,\n    isDraftMode,\n    prerenderManifest,\n    routerServerContext,\n    isOnDemandRevalidate,\n    revalidateOnlyGenerated,\n    resolvedPathname,\n    clientReferenceManifest,\n    serverActionsManifest,\n  } = prepareResult\n\n  const normalizedSrcPage = normalizeAppPath(srcPage)\n\n  let isIsr = Boolean(\n    prerenderManifest.dynamicRoutes[normalizedSrcPage] ||\n      prerenderManifest.routes[resolvedPathname]\n  )\n\n  const render404 = async () => {\n    // TODO: should route-module itself handle rendering the 404\n    if (routerServerContext?.render404) {\n      await routerServerContext.render404(req, res, parsedUrl, false)\n    } else {\n      res.end('This page could not be found')\n    }\n    return null\n  }\n\n  if (isIsr && !isDraftMode) {\n    const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname])\n    const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage]\n\n    if (prerenderInfo) {\n      if (prerenderInfo.fallback === false && !isPrerendered) {\n        if (nextConfig.experimental.adapterPath) {\n          return await render404()\n        }\n        throw new NoFallbackError()\n      }\n    }\n  }\n\n  let cacheKey: string | null = null\n\n  if (isIsr && !routeModule.isDev && !isDraftMode) {\n    cacheKey = resolvedPathname\n    // ensure /index and / is normalized to one key\n    cacheKey = cacheKey === '/index' ? '/' : cacheKey\n  }\n\n  const supportsDynamicResponse: boolean =\n    // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true ||\n    // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr\n\n  // This is a revalidation request if the request is for a static\n  // page and it is not being resumed from a postponed render and\n  // it is not a dynamic RSC request then it is a revalidation\n  // request.\n  const isStaticGeneration = isIsr && !supportsDynamicResponse\n\n  // Before rendering (which initializes component tree modules), we have to\n  // set the reference manifests to our global store so Server Action's\n  // encryption util can access to them at the top level of the page module.\n  if (serverActionsManifest && clientReferenceManifest) {\n    setManifestsSingleton({\n      page: srcPage,\n      clientReferenceManifest,\n      serverActionsManifest,\n    })\n  }\n\n  const method = req.method || 'GET'\n  const tracer = getTracer()\n  const activeSpan = tracer.getActiveScopeSpan()\n\n  const context: AppRouteRouteHandlerContext = {\n    params,\n    prerenderManifest,\n    renderOpts: {\n      experimental: {\n        authInterrupts: Boolean(nextConfig.experimental.authInterrupts),\n      },\n      cacheComponents: Boolean(nextConfig.cacheComponents),\n      supportsDynamicResponse,\n      incrementalCache: getRequestMeta(req, 'incrementalCache'),\n      cacheLifeProfiles: nextConfig.cacheLife,\n      waitUntil: ctx.waitUntil,\n      onClose: (cb) => {\n        res.on('close', cb)\n      },\n      onAfterTaskError: undefined,\n      onInstrumentationRequestError: (\n        error,\n        _request,\n        errorContext,\n        silenceLog\n      ) =>\n        routeModule.onRequestError(\n          req,\n          error,\n          errorContext,\n          silenceLog,\n          routerServerContext\n        ),\n    },\n    sharedContext: {\n      buildId,\n    },\n  }\n  const nodeNextReq = new NodeNextRequest(req)\n  const nodeNextRes = new NodeNextResponse(res)\n\n  const nextReq = NextRequestAdapter.fromNodeNextRequest(\n    nodeNextReq,\n    signalFromNodeResponse(res)\n  )\n\n  try {\n    const invokeRouteModule = async (span?: Span) => {\n      return routeModule.handle(nextReq, context).finally(() => {\n        if (!span) return\n\n        span.setAttributes({\n          'http.status_code': res.statusCode,\n          'next.rsc': false,\n        })\n\n        const rootSpanAttributes = tracer.getRootSpanAttributes()\n        // We were unable to get attributes, probably OTEL is not enabled\n        if (!rootSpanAttributes) {\n          return\n        }\n\n        if (\n          rootSpanAttributes.get('next.span_type') !==\n          BaseServerSpan.handleRequest\n        ) {\n          console.warn(\n            `Unexpected root span type '${rootSpanAttributes.get(\n              'next.span_type'\n            )}'. Please report this Next.js issue https://github.com/vercel/next.js`\n          )\n          return\n        }\n\n        const route = rootSpanAttributes.get('next.route')\n        if (route) {\n          const name = `${method} ${route}`\n\n          span.setAttributes({\n            'next.route': route,\n            'http.route': route,\n            'next.span_name': name,\n          })\n          span.updateName(name)\n        } else {\n          span.updateName(`${method} ${srcPage}`)\n        }\n      })\n    }\n    const isMinimalMode = Boolean(\n      process.env.MINIMAL_MODE || getRequestMeta(req, 'minimalMode')\n    )\n\n    const handleResponse = async (currentSpan?: Span) => {\n      const responseGenerator: ResponseGenerator = async ({\n        previousCacheEntry,\n      }) => {\n        try {\n          if (\n            !isMinimalMode &&\n            isOnDemandRevalidate &&\n            revalidateOnlyGenerated &&\n            !previousCacheEntry\n          ) {\n            res.statusCode = 404\n            // on-demand revalidate always sets this header\n            res.setHeader('x-nextjs-cache', 'REVALIDATED')\n            res.end('This page could not be found')\n            return null\n          }\n\n          const response = await invokeRouteModule(currentSpan)\n\n          ;(req as any).fetchMetrics = (context.renderOpts as any).fetchMetrics\n          let pendingWaitUntil = context.renderOpts.pendingWaitUntil\n\n          // Attempt using provided waitUntil if available\n          // if it's not we fallback to sendResponse's handling\n          if (pendingWaitUntil) {\n            if (ctx.waitUntil) {\n              ctx.waitUntil(pendingWaitUntil)\n              pendingWaitUntil = undefined\n            }\n          }\n          const cacheTags = context.renderOpts.collectedTags\n\n          // If the request is for a static response, we can cache it so long\n          // as it's not edge.\n          if (isIsr) {\n            const blob = await response.blob()\n\n            // Copy the headers from the response.\n            const headers = toNodeOutgoingHttpHeaders(response.headers)\n\n            if (cacheTags) {\n              headers[NEXT_CACHE_TAGS_HEADER] = cacheTags\n            }\n\n            if (!headers['content-type'] && blob.type) {\n              headers['content-type'] = blob.type\n            }\n\n            const revalidate =\n              typeof context.renderOpts.collectedRevalidate === 'undefined' ||\n              context.renderOpts.collectedRevalidate >= INFINITE_CACHE\n                ? false\n                : context.renderOpts.collectedRevalidate\n\n            const expire =\n              typeof context.renderOpts.collectedExpire === 'undefined' ||\n              context.renderOpts.collectedExpire >= INFINITE_CACHE\n                ? undefined\n                : context.renderOpts.collectedExpire\n\n            // Create the cache entry for the response.\n            const cacheEntry: ResponseCacheEntry = {\n              value: {\n                kind: CachedRouteKind.APP_ROUTE,\n                status: response.status,\n                body: Buffer.from(await blob.arrayBuffer()),\n                headers,\n              },\n              cacheControl: { revalidate, expire },\n            }\n\n            return cacheEntry\n          } else {\n            // send response without caching if not ISR\n            await sendResponse(\n              nodeNextReq,\n              nodeNextRes,\n              response,\n              context.renderOpts.pendingWaitUntil\n            )\n            return null\n          }\n        } catch (err) {\n          // if this is a background revalidate we need to report\n          // the request error here as it won't be bubbled\n          if (previousCacheEntry?.isStale) {\n            const silenceLog = false\n            await routeModule.onRequestError(\n              req,\n              err,\n              {\n                routerKind: 'App Router',\n                routePath: srcPage,\n                routeType: 'route',\n                revalidateReason: getRevalidateReason({\n                  isStaticGeneration,\n                  isOnDemandRevalidate,\n                }),\n              },\n              silenceLog,\n              routerServerContext\n            )\n          }\n          throw err\n        }\n      }\n\n      const cacheEntry = await routeModule.handleResponse({\n        req,\n        nextConfig,\n        cacheKey,\n        routeKind: RouteKind.APP_ROUTE,\n        isFallback: false,\n        prerenderManifest,\n        isRoutePPREnabled: false,\n        isOnDemandRevalidate,\n        revalidateOnlyGenerated,\n        responseGenerator,\n        waitUntil: ctx.waitUntil,\n        isMinimalMode,\n      })\n\n      // we don't create a cacheEntry for ISR\n      if (!isIsr) {\n        return null\n      }\n\n      if (cacheEntry?.value?.kind !== CachedRouteKind.APP_ROUTE) {\n        throw new Error(\n          `Invariant: app-route received invalid cache entry ${cacheEntry?.value?.kind}`\n        )\n      }\n\n      if (!isMinimalMode) {\n        res.setHeader(\n          'x-nextjs-cache',\n          isOnDemandRevalidate\n            ? 'REVALIDATED'\n            : cacheEntry.isMiss\n              ? 'MISS'\n              : cacheEntry.isStale\n                ? 'STALE'\n                : 'HIT'\n        )\n      }\n\n      // Draft mode should never be cached\n      if (isDraftMode) {\n        res.setHeader(\n          'Cache-Control',\n          'private, no-cache, no-store, max-age=0, must-revalidate'\n        )\n      }\n\n      const headers = fromNodeOutgoingHttpHeaders(cacheEntry.value.headers)\n\n      if (!(isMinimalMode && isIsr)) {\n        headers.delete(NEXT_CACHE_TAGS_HEADER)\n      }\n\n      // If cache control is already set on the response we don't\n      // override it to allow users to customize it via next.config\n      if (\n        cacheEntry.cacheControl &&\n        !res.getHeader('Cache-Control') &&\n        !headers.get('Cache-Control')\n      ) {\n        headers.set(\n          'Cache-Control',\n          getCacheControlHeader(cacheEntry.cacheControl)\n        )\n      }\n\n      await sendResponse(\n        nodeNextReq,\n        nodeNextRes,\n        // @ts-expect-error - Argument of type 'Buffer<ArrayBufferLike>' is not assignable to parameter of type 'BodyInit | null | undefined'.\n        new Response(cacheEntry.value.body, {\n          headers,\n          status: cacheEntry.value.status || 200,\n        })\n      )\n      return null\n    }\n\n    // TODO: activeSpan code path is for when wrapped by\n    // next-server can be removed when this is no longer used\n    if (activeSpan) {\n      await handleResponse(activeSpan)\n    } else {\n      await tracer.withPropagatedContext(req.headers, () =>\n        tracer.trace(\n          BaseServerSpan.handleRequest,\n          {\n            spanName: `${method} ${srcPage}`,\n            kind: SpanKind.SERVER,\n            attributes: {\n              'http.method': method,\n              'http.target': req.url,\n            },\n          },\n          handleResponse\n        )\n      )\n    }\n  } catch (err) {\n    if (!(err instanceof NoFallbackError)) {\n      const silenceLog = false\n      await routeModule.onRequestError(\n        req,\n        err,\n        {\n          routerKind: 'App Router',\n          routePath: normalizedSrcPage,\n          routeType: 'route',\n          revalidateReason: getRevalidateReason({\n            isStaticGeneration,\n            isOnDemandRevalidate,\n          }),\n        },\n        silenceLog,\n        routerServerContext\n      )\n    }\n\n    // rethrow so that we can handle serving error page\n\n    // If this is during static generation, throw the error again.\n    if (isIsr) throw err\n\n    // Otherwise, send a 500 response.\n    await sendResponse(\n      nodeNextReq,\n      nodeNextRes,\n      new Response(null, { status: 500 })\n    )\n    return null\n  }\n}\n"],"names":["ActionDidNotRevalidate","ActionDidRevalidateDynamicOnly","ActionDidRevalidateStaticAndDynamic","process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","React","AppRouteRouteModule","RouteKind","patchFetch","_patchFetch","addRequestMeta","getRequestMeta","getTracer","SpanKind","setManifestsSingleton","normalizeAppPath","NodeNextRequest","NodeNextResponse","NextRequestAdapter","signalFromNodeResponse","BaseServerSpan","getRevalidateReason","sendResponse","fromNodeOutgoingHttpHeaders","toNodeOutgoingHttpHeaders","getCacheControlHeader","INFINITE_CACHE","NEXT_CACHE_TAGS_HEADER","NoFallbackError","CachedRouteKind","userland","routeModule","definition","kind","APP_ROUTE","page","pathname","filename","bundlePath","distDir","__NEXT_RELATIVE_DIST_DIR","relativeProjectDir","__NEXT_RELATIVE_PROJECT_DIR","resolvedPagePath","nextConfigOutput","workAsyncStorage","workUnitAsyncStorage","serverHooks","handler","req","res","ctx","isDev","hrtime","bigint","srcPage","replace","multiZoneDraftMode","__NEXT_MULTI_ZONE_DRAFT_MODE","prepareResult","prepare","statusCode","end","waitUntil","Promise","resolve","buildId","params","nextConfig","parsedUrl","isDraftMode","prerenderManifest","routerServerContext","isOnDemandRevalidate","revalidateOnlyGenerated","resolvedPathname","clientReferenceManifest","serverActionsManifest","normalizedSrcPage","isIsr","Boolean","dynamicRoutes","routes","render404","isPrerendered","prerenderInfo","fallback","experimental","adapterPath","cacheKey","supportsDynamicResponse","isStaticGeneration","method","tracer","activeSpan","getActiveScopeSpan","context","renderOpts","authInterrupts","cacheComponents","incrementalCache","cacheLifeProfiles","cacheLife","onClose","cb","on","onAfterTaskError","undefined","onInstrumentationRequestError","error","_request","errorContext","silenceLog","onRequestError","sharedContext","nodeNextReq","nodeNextRes","nextReq","fromNodeNextRequest","invokeRouteModule","span","handle","finally","setAttributes","rootSpanAttributes","getRootSpanAttributes","get","handleRequest","console","warn","route","name","updateName","isMinimalMode","MINIMAL_MODE","handleResponse","currentSpan","cacheEntry","responseGenerator","previousCacheEntry","setHeader","response","fetchMetrics","pendingWaitUntil","cacheTags","collectedTags","blob","headers","type","revalidate","collectedRevalidate","expire","collectedExpire","value","status","body","Buffer","from","arrayBuffer","cacheControl","err","isStale","routerKind","routePath","routeType","revalidateReason","routeKind","isFallback","isRoutePPREnabled","Error","isMiss","delete","getHeader","set","Response","withPropagatedContext","trace","spanName","SERVER","attributes","url"],"mappings":"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","ignoreList":[0,1,2,8]}}]
}