;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="024ff523-9566-0636-d332-07e70e2d91e0")}catch(e){}}();
module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},916429,(e,t,r)=>{"use strict";t.exports=e.r(918622)},974947,(e,t,r)=>{"use strict";t.exports=e.r(916429).vendored["react-rsc"].React},703524,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={ActionDidNotRevalidate:function(){return o},ActionDidRevalidateDynamicOnly:function(){return s},ActionDidRevalidateStaticAndDynamic:function(){return i}};for(var n in a)Object.defineProperty(r,n,{enumerable:!0,get:a[n]});let o=0,i=1,s=2},68599,e=>{"use strict";var t=e.i(520522);let r=3600,a=e=>[`company-${e}`,"company"],n="https://gw.api.bolagsverket.se/vardefulla-datamangder/v1",o=process.env.BOLAGSVERKET_CLIENT_ID,i=process.env.BOLAGSVERKET_CLIENT_SECRET,s=null;async function l(){if(!o||!i)throw Error("Bolagsverket credentials not configured");if(s&&s.expiresAt>Date.now()+6e4)return s.token;let e=await fetch("https://portal.api.bolagsverket.se/oauth2/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"client_credentials",client_id:o,client_secret:i,scope:"vardefulla-datamangder:read vardefulla-datamangder:ping"})});if(!e.ok)throw Error(`Failed to get Bolagsverket token: ${e.status}`);let t=await e.json();return s={token:t.access_token,expiresAt:Date.now()+1e3*t.expires_in},t.access_token}function c(){return!!(o&&i)}async function u(e){if(!c())return console.warn("Bolagsverket API not configured"),null;try{var t;let r,a,o,i,s,c,u,d,p,m=await l(),g=await fetch(`${n}/organisationer`,{method:"POST",headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json","X-Request-Id":crypto.randomUUID()},body:JSON.stringify({identitetsbeteckning:e.replace("-","")})});if(!g.ok){if(400===g.status)return null;throw Error(`Bolagsverket API returned ${g.status}`)}let f=await g.json();if(!f.organisationer||0===f.organisationer.length)return null;return t=f.organisationer[0],r=t.organisationsnamn?.organisationsnamnLista?.find(e=>e.organisationsnamntyp?.kod==="FORETAGSNAMN"),a=r?.namn||t.organisationsnamn?.organisationsnamnLista?.[0]?.namn||"",i=(o=t.postadressOrganisation?.postadress)?{street:o.utdelningsadress,coAddress:o.coAdress,zipCode:o.postnummer,city:o.postort,country:o.land||"Sverige"}:void 0,s=t.naringsgrenOrganisation?.sni?.map(e=>({code:e.kod,name:e.klartext}))||[],c=t.verksamOrganisation?.kod==="JA",u=!!t.avregistreradOrganisation?.avregistreringsdatum,d=t.pagaendeAvvecklingsEllerOmstruktureringsforfarande?.pagaendeAvvecklingsEllerOmstruktureringsforfarandeLista,p="Aktiv",u?p=t.avregistreringsorsak?.klartext||"Avregistrerad":d&&d.length>0?p=d.map(e=>e.klartext).join(", "):c||(p="Ej verksam"),{basic:{orgNr:t.organisationsidentitet.identitetsbeteckning,name:a,companyType:{code:t.organisationsform?.kod||"",name:t.organisationsform?.klartext||""},status:{active:c&&!u,status:p,statusDate:t.avregistreradOrganisation?.avregistreringsdatum},registrationDate:t.organisationsdatum?.registreringsdatum,purpose:t.verksamhetsbeskrivning?.beskrivning},postalAddress:i,industries:s,flags:{marketingProtection:t.reklamsparr?.kod==="JA"},sources:{bolagsverket:!0}}}catch(e){return console.error("Error fetching from Bolagsverket:",e),null}}async function d(e){let n,o;return n=e,o=()=>u(e),(0,t.unstable_cache)(o,[`company-info-${n}`],{revalidate:r,tags:a(n)})()}async function p(e){if(!c())return[];try{let t=await l(),r=await fetch(`${n}/dokumentlista`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json","X-Request-Id":crypto.randomUUID()},body:JSON.stringify({identitetsbeteckning:e.replace("-","")})});if(!r.ok)return[];return((await r.json()).dokument||[]).map(e=>({dokumentId:e.dokumentId,filformat:e.filformat,period:e.rapporteringsperiodTom,date:e.registreringstidpunkt}))}catch(e){return console.error("Error fetching annual reports list:",e),[]}}async function m(e){if(!c())return null;try{let t=await l(),r=await fetch(`${n}/dokument/${e}`,{headers:{Authorization:`Bearer ${t}`,"X-Request-Id":crypto.randomUUID()}});if(!r.ok)return console.error("Failed to download document:",r.status),null;let a=await r.arrayBuffer(),o=r.headers.get("content-type")||"application/zip";return{data:Buffer.from(a),contentType:o}}catch(e){return console.error("Error downloading annual report:",e),null}}async function g(t){let r=await m(t);if(!r)return null;try{let t=(await e.A(684262)).default,a=await t.loadAsync(r.data),n=Object.keys(a.files).find(e=>e.endsWith(".xhtml")||e.endsWith(".html"));if(!n)return console.error("No XHTML file found in ZIP"),null;return{content:await a.files[n].async("string"),filename:n}}catch(e){return console.error("Error extracting annual report:",e),null}}e.s(["fetchFromBolagsverket",()=>d,"getAnnualReportContent",()=>g,"getAnnualReportsList",()=>p,"isBolagsverketConfigured",()=>c],68599)},868098,e=>{"use strict";let t=process.env.VINNOVA_GDP_API_KEY;async function r(e){if(!t)return console.warn("Vinnova GDP API not configured"),[];try{let r=e.replace(/-/g,""),a=10===r.length?`${r.slice(0,6)}-${r.slice(6)}`:e,n=`https://api.vinnova.se/gdp_vinnova/finansieradeaktiviteter?organisationsnummer=${a}&limit=100&authorization=${t}`,i=await fetch(n,{next:{revalidate:3600}});if(!i.ok)throw 401===i.status&&console.error("Vinnova GDP API: Invalid API key"),Error(`Vinnova GDP API returned ${i.status}`);let s=await i.json();if(!s||0===s.length)return[];return s.map(o)}catch(e){return console.error("Error fetching from Vinnova GDP API:",e),[]}}async function a(e,a){if(a&&t){let e=await r(a);if(e.length>0)return e}return n(e)}async function n(e){try{let t=new Date;t.setFullYear(t.getFullYear()-2);let r=t.toISOString().split("T")[0],a=await fetch(`https://data.vinnova.se/api/projekt/${r}`,{cache:"no-store"});if(!a.ok)throw Error(`Vinnova API returned ${a.status}`);let n=await a.json(),o=e.toLowerCase();return n.filter(e=>e.KoordinatorOrg?.toLowerCase().includes(o)||e.KoordinatorArb?.toLowerCase().includes(o)).map(i)}catch(e){return console.error("Error fetching from Vinnova legacy API:",e),[]}}function o(e){let t=e.organisationer?.find(e=>"Koordinator"===e.roll),r=e.beslutadFinansiering?.reduce((e,t)=>e+(t.belopp||0),0)||0;return{diarienummer:e.diarienummer,title:e.titel||"",titleEn:e.titelEng,description:e.beskrivning||e.beskrivningEng,grantedAmount:r,projectStart:e.startdatum||"",projectEnd:e.slutdatum||"",status:e.status||"",coordinator:t?.namn||"",programme:void 0}}function i(e){return{diarienummer:e.Diarienummer,title:e.Ärenderubrik,titleEn:e.ÄrenderubrikEngelska,description:e.Projektreferat,grantedAmount:e.BeviljatBidrag,projectStart:e.ProjektStart,projectEnd:e.ProjektSlut,status:e.Status,coordinator:e.KoordinatorOrg,programme:e.DiarienummerProgram,goals:e.MalSvenska||void 0,results:e.ResultatSvenska||void 0,implementation:e.ImplementationSvenska||void 0,links:e.LankLista?.map(e=>({name:e.Lanknamn,url:e.Lankadress}))}}e.s(["getVinnovaProjectsForCompany",()=>a])},291372,e=>{"use strict";let t="https://www.allabolag.se";function r(e){if(null===e||"-"===e||""===e)return null;let t=e.replace(/,/g,".").replace(/\s/g,"");return t.endsWith("%")?parseFloat(t.replace("%","")):parseFloat(t)}function a(e){if(e)return{street:e.addressLine||void 0,boxAddress:e.boxAddressLine||void 0,zipCode:e.zipCode||void 0,city:e.postPlace||void 0,country:"Sverige"}}function n(e){if(e)return{name:e.name,role:e.role,birthDate:e.birthDate,id:e.id,type:e.type,businessPerson:e.businessPerson}}function o(e,t){if(!e)return;let r=e.find(e=>e.name===t);if(r)return r.roles.map(e=>({name:e.name,role:e.role,birthDate:e.birthDate,id:e.id,type:e.type,businessPerson:e.businessPerson}))}function i(e,t){return e?e.map(e=>({year:e.year,periodStart:e.periodStart,periodEnd:e.periodEnd,currency:e.currency||"SEK",accounts:e.accounts.map(e=>({code:e.code,codeName:t[e.code]||void 0,amount:r(e.amount)}))})):[]}async function s(e){try{let r=await fetch(`${t}/what/${encodeURIComponent(e)}`,{headers:{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36",Accept:"text/html,application/xhtml+xml"},next:{revalidate:300}});if(!r.ok)return[];let a=(await r.text()).match(/<script id="__NEXT_DATA__"[^>]*>([\s\S]*?)<\/script>/);if(!a)return[];let n=JSON.parse(a[1]),o=n.props?.pageProps?.hydrationData?.searchStore;return(o?.companies?.companies||[]).slice(0,20).map(e=>({orgnr:e.orgnr,name:e.name||e.legalName||"",companyType:e.companyType?.name,status:e.status?.status,location:e.location?.municipality}))}catch(e){return console.error("Error searching Allabolag:",e),[]}}async function l(e){let s=e.replace("-","");try{let e=await fetch(`${t}/${s}`,{headers:{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36",Accept:"text/html,application/xhtml+xml"},next:{revalidate:3600}});if(!e.ok){if(404===e.status)return null;throw Error(`Allabolag returned ${e.status}`)}let l=(await e.text()).match(/<script id="__NEXT_DATA__"[^>]*>([\s\S]*?)<\/script>/);if(!l)throw Error("Could not find __NEXT_DATA__ in response");let c=JSON.parse(l[1]),u=c.props.pageProps.company,d=c.props.i18n?.initialStore?.sv?.common?.AccountingFigures?.figures?.SE||{},p=(u.industries||[]).map(e=>({code:e.code,name:e.name,description:e.description}));u.currentIndustry&&!p.find(e=>e.code===u.currentIndustry?.code)&&p.unshift({code:u.currentIndustry.code,name:u.currentIndustry.name});let m=(u.announcements||[]).map(e=>({id:e.id,date:e.date,text:e.text,type:e.type})),g=(u.registryStatusEntries||[]).map(e=>({label:e.label,value:e.value})),f=(u.shareholders||[]).map(e=>({name:e.name,orgNr:e.orgnr,ownership:e.ownership,votes:e.votes,country:e.country})),h=(c.props.pageProps.trademarks?.trademarks||[]).map(e=>({name:e.name,registrationNumber:e.registrationNumber,status:e.status,classes:e.classes,type:e.type,expirationDate:e.expirationDate})),v=(u.statusRemarks||[]).map(e=>({code:e.code,description:e.desc,date:e.date})),y=(u.mergers||[]).map(e=>({date:e.date,type:e.type,description:e.description,otherCompanyName:e.otherCompanyName,otherCompanyOrgNr:e.otherCompanyOrgnr})),k=(u.certificates||[]).map(e=>({name:e.name,issuer:e.issuer,validUntil:e.validUntil})),b=(c.props.pageProps.relatedCompanies?.companies||[]).map(e=>({orgNr:e.orgnr,name:e.name,relation:e.relation}));return{basic:{orgNr:u.orgnr,name:u.name,legalName:u.legalName,companyType:{code:u.companyType?.code||"",name:u.companyType?.name||"",parentCode:u.companyType?.parentCode},status:{active:u.status?.statusCode==="ACTIVE",status:u.status?.status||"",statusDate:u.status?.statusDate},registrationDate:u.registrationDate,foundationDate:u.foundationDate,foundationYear:u.foundationYear,purpose:u.purpose,tagLine:u.tagLine||void 0,description:u.description||void 0},postalAddress:a(u.postalAddress),visitorAddress:a(u.visitorAddress),legalPostalAddress:a(u.legalPostalAddress),legalVisitorAddress:a(u.legalVisitorAddress),contact:{phone:u.phone||void 0,phone2:u.phone2||void 0,mobile:u.mobile||void 0,fax:u.faxNumber||void 0,email:u.email||void 0,website:u.homePage||void 0,socialMedia:u.socialMediaLinks?{facebook:u.socialMediaLinks.facebook,linkedin:u.socialMediaLinks.linkedin,twitter:u.socialMediaLinks.twitter,instagram:u.socialMediaLinks.instagram,youtube:u.socialMediaLinks.youtube}:void 0},location:u.location?{county:u.location.county,municipality:u.location.municipality,countryPart:u.location.countryPart,coordinates:u.location.coordinates}:void 0,domicile:u.domicile?{municipality:u.domicile.municipality,county:u.domicile.county}:void 0,industries:p,naceIndustries:u.naceIndustries,people:{chairman:n(u.roles?.chairman),ceo:n(u.roles?.manager),contactPerson:n(u.contactPerson),boardMembers:o(u.roles?.roleGroups,"Board"),management:o(u.roles?.roleGroups,"Management"),auditors:o(u.roles?.roleGroups,"Revision"),otherRoles:o(u.roles?.roleGroups,"Other"),signatories:u.signatories,procuration:u.procuration,numberOfRoles:u.roles?.numberOfRoles},shareholders:{list:f.length>0?f:void 0,totalCount:u.totalShareholders,lastUpdated:u.shareholdersLastUpdatedDate},financials:{revenue:u.revenue,profit:u.profit,employees:u.employees,numberOfEmployees:u.numberOfEmployees,shareCapital:u.shareCapital,estimatedTurnover:u.estimatedTurnover,turnoverYear:u.turnoverYear,annualReports:i(u.companyAccounts,d),corporateAccounts:i(u.corporateAccounts,d),keyFigures:function(e){if(!e||0===e.length)return;let t=e[0],a=e=>{let a=t.accounts.find(t=>t.code===e);if(a&&null!==a.amount)return r(a.amount)??void 0};return{ebitda:a("EBITDA"),returnOnEquity:a("avk_eget_kapital"),returnOnAssets:a("avk_totalt_kapital"),growthRate:a("TR"),salariesBoard:a("loner_styrelse_vd"),salariesOther:a("loner_ovriga"),longTermDebt:a("summa_langfristiga_skulder"),financialAssets:a("summa_finansiella_anltillg")}}(u.companyAccounts)},flags:{mortgages:u.mortgages,paymentRemarks:u.paymentRemarks,vatRegistered:u.registeredForVat,vatDescription:u.registeredForVatDescription,marketingProtection:u.marketingProtection,gaselle:u.gaselle,registeredForPayrollTax:u.registeredForPayrollTax,registeredForNav:u.registeredForNav},statusRemarks:v.length>0?v:void 0,vehicles:u.vehicles?.numberOfVehicles?u.vehicles:void 0,rating:u.rating||void 0,registryStatus:g,announcements:m,corporateStructure:u.corporateStructure?{numberOfCompanies:u.corporateStructure.numberOfCompanies,numberOfSubsidiaries:u.corporateStructure.numberOfSubsidiaries,parentCompanyName:u.corporateStructure.parentCompanyName,parentCompanyOrgNr:u.corporateStructure.parentCompanyOrganisationNumber,parentCompanyCountry:u.corporateStructure.parentCompanyCountryCode}:void 0,businessUnits:(u.businessUnits||[]).map(e=>({id:e.businessUnitId,name:e.name,type:e.businessUnitType})),trademarks:h.length>0?h:void 0,mergers:y.length>0?y:void 0,certificates:k.length>0?k:void 0,relatedCompanies:b.length>0?b:void 0,alternativeNames:u.alternativeNames?.length?u.alternativeNames:void 0,sources:{allabolag:!0}}}catch(e){throw console.error("Error fetching from Allabolag:",e),e}}var c=e.i(68599);async function u(e){let t,r=e.replace(/\D/g,"");if(10!==r.length&&12!==r.length)throw Error("Ogiltigt organisationsnummer");let[a,n]=await Promise.all([l(r).catch(e=>(console.error("Allabolag fetch failed:",e),null)),(0,c.fetchFromBolagsverket)(r).catch(e=>(console.error("Bolagsverket fetch failed:",e),null))]);if(!a&&!n)return null;if(a){if(t={...a},n&&(t.sources.bolagsverket=!0,n.basic&&n.basic.purpose&&!t.basic.purpose&&(t.basic.purpose=n.basic.purpose),n.industries&&n.industries.length>0)){let e=new Set(t.industries?.map(e=>e.code)),r=n.industries.filter(t=>!e.has(t.code));t.industries=[...t.industries||[],...r]}}else{if(!n)return null;t={basic:n.basic,postalAddress:n.postalAddress,industries:n.industries,flags:n.flags,sources:{bolagsverket:!0}}}return t}async function d(e){let t=e.replace(/\D/g,"");if(10===t.length||12===t.length){let e=await u(t);if(e)return[{orgNr:e.basic.orgNr,name:e.basic.name,companyType:e.basic.companyType.name,status:e.basic.status.status,location:e.location?.municipality}]}return(await s(e)).map(e=>({orgNr:e.orgnr,name:e.name,companyType:e.companyType?.name,status:e.status?.status,location:e.location?.municipality}))}e.i(868098),e.s(["getCompanyData",()=>u,"searchCompanies",()=>d],291372)},540354,e=>{"use strict";var t=e.i(594236),r=e.i(731205),a=e.i(299044),n=e.i(789986),o=e.i(372874),i=e.i(96846),s=e.i(887304),l=e.i(879328),c=e.i(361547),u=e.i(70569),d=e.i(143981),p=e.i(443147),m=e.i(773331),g=e.i(716859),f=e.i(13751),h=e.i(193695);e.i(882560);var v=e.i(851855),y=e.i(450526),k=e.i(291372);async function b(e){let t=e.nextUrl.searchParams.get("q");if(!t||t.length<2)return y.NextResponse.json({error:"Sökfrågan måste vara minst 2 tecken"},{status:400});try{let e=await (0,k.searchCompanies)(t);return y.NextResponse.json({results:e})}catch(e){return console.error("Error searching companies:",e),y.NextResponse.json({error:"Kunde inte söka efter företag"},{status:500})}}e.s(["GET",()=>b],999431);var A=e.i(999431);let w=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/bolag/search/route",pathname:"/api/bolag/search",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/CLAUDE/projects/1. Loop Desk/src/app/api/bolag/search/route.ts",nextConfigOutput:"standalone",userland:A}),{workAsyncStorage:x,workUnitAsyncStorage:E,serverHooks:R}=w;function C(){return(0,a.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:E})}async function P(e,t,a){w.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let y="/api/bolag/search/route";y=y.replace(/\/index$/,"")||"/";let k=await w.prepare(e,t,{srcPage:y,multiZoneDraftMode:!1});if(!k)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:b,params:A,nextConfig:x,parsedUrl:E,isDraftMode:R,prerenderManifest:C,routerServerContext:P,isOnDemandRevalidate:_,revalidateOnlyGenerated:N,resolvedPathname:S,clientReferenceManifest:O,serverActionsManifest:T}=k,D=(0,s.normalizeAppPath)(y),I=!!(C.dynamicRoutes[D]||C.routes[S]),j=async()=>((null==P?void 0:P.render404)?await P.render404(e,t,E,!1):t.end("This page could not be found"),null);if(I&&!R){let e=!!C.routes[S],t=C.dynamicRoutes[D];if(t&&!1===t.fallback&&!e){if(x.experimental.adapterPath)return await j();throw new h.NoFallbackError}}let U=null;!I||w.isDev||R||(U="/index"===(U=S)?"/":U);let L=!0===w.isDev||!I,$=I&&!L;T&&O&&(0,i.setManifestsSingleton)({page:y,clientReferenceManifest:O,serverActionsManifest:T});let M=e.method||"GET",F=(0,o.getTracer)(),B=F.getActiveScopeSpan(),q={params:A,prerenderManifest:C,renderOpts:{experimental:{authInterrupts:!!x.experimental.authInterrupts},cacheComponents:!!x.cacheComponents,supportsDynamicResponse:L,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:x.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a,n)=>w.onRequestError(e,t,a,n,P)},sharedContext:{buildId:b}},V=new l.NodeNextRequest(e),K=new l.NodeNextResponse(t),H=c.NextRequestAdapter.fromNodeNextRequest(V,(0,c.signalFromNodeResponse)(t));try{let i=async e=>w.handle(H,q).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=F.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${M} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${M} ${y}`)}),s=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var o,l;let c=async({previousCacheEntry:r})=>{try{if(!s&&_&&N&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await i(n);e.fetchMetrics=q.renderOpts.fetchMetrics;let l=q.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=q.renderOpts.collectedTags;if(!I)return await (0,p.sendResponse)(V,K,o,q.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(o.headers);c&&(t[f.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==q.renderOpts.collectedRevalidate&&!(q.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&q.renderOpts.collectedRevalidate,a=void 0===q.renderOpts.collectedExpire||q.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:q.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await w.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:$,isOnDemandRevalidate:_})},!1,P),t}},u=await w.handleResponse({req:e,nextConfig:x,cacheKey:U,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:C,isRoutePPREnabled:!1,isOnDemandRevalidate:_,revalidateOnlyGenerated:N,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:s});if(!I)return null;if((null==u||null==(o=u.value)?void 0:o.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",_?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),R&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let h=(0,m.fromNodeOutgoingHttpHeaders)(u.value.headers);return s&&I||h.delete(f.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||h.get("Cache-Control")||h.set("Cache-Control",(0,g.getCacheControlHeader)(u.cacheControl)),await (0,p.sendResponse)(V,K,new Response(u.value.body,{headers:h,status:u.value.status||200})),null};B?await l(B):await F.withPropagatedContext(e.headers,()=>F.trace(u.BaseServerSpan.handleRequest,{spanName:`${M} ${y}`,kind:o.SpanKind.SERVER,attributes:{"http.method":M,"http.target":e.url}},l))}catch(t){if(t instanceof h.NoFallbackError||await w.onRequestError(e,t,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:$,isOnDemandRevalidate:_})},!1,P),I)throw t;return await (0,p.sendResponse)(V,K,new Response(null,{status:500})),null}}e.s(["handler",()=>P,"patchFetch",()=>C,"routeModule",()=>w,"serverHooks",()=>R,"workAsyncStorage",()=>x,"workUnitAsyncStorage",()=>E],540354)},72204,e=>{e.v(e=>Promise.resolve().then(()=>e(520522)))},684262,e=>{e.v(t=>Promise.all(["server/chunks/[externals]__380e94e3._.js","server/chunks/[root-of-the-server]__7eaed321._.js"].map(t=>e.l(t))).then(()=>t(11739)))}];

//# debugId=024ff523-9566-0636-d332-07e70e2d91e0
//# sourceMappingURL=%5Broot-of-the-server%5D__95b88caf._.js.map