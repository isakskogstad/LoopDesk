;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="350618bd-ae94-1337-3924-c579a37d86f8")}catch(e){}}();
module.exports=[353224,a=>{"use strict";var b=a.i(257640),c=a.i(200417),d=a.i(434303),e=a.i(485472),f=a.i(161494),g=a.i(624338),h=a.i(260819),i=a.i(16591),j=a.i(720752);function k({icon:a=i.FileText,title:c,description:d,action:e,secondaryAction:f,children:g,className:h=""}){return(0,b.jsxs)("div",{className:`empty-state ${h}`,children:[(0,b.jsx)("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:(0,b.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-br from-secondary/50 to-transparent rounded-full blur-3xl"})}),(0,b.jsxs)("div",{className:"relative empty-state-icon",children:[(0,b.jsx)("div",{className:"absolute inset-0 rounded-full bg-secondary animate-pulse-soft"}),(0,b.jsx)("div",{className:"relative w-16 h-16 rounded-full bg-secondary flex items-center justify-center",children:(0,b.jsx)(a,{className:"w-8 h-8 text-muted-foreground"})})]}),(0,b.jsx)("h3",{className:"empty-state-title",children:c}),(0,b.jsx)("p",{className:"empty-state-description",children:d}),(e||f)&&(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[e&&(e.href?(0,b.jsx)(j.Button,{asChild:!0,variant:e.variant||"default",children:(0,b.jsx)("a",{href:e.href,children:e.label})}):(0,b.jsx)(j.Button,{onClick:e.onClick,variant:e.variant||"default",children:e.label})),f&&(0,b.jsx)(j.Button,{variant:"ghost",onClick:f.onClick,children:f.label})]}),g]})}function l({onAddFeed:a,hasFilters:c=!1}){return c?(0,b.jsx)(k,{icon:h.Search,title:"Inga matchande nyheter",description:"Prova att ändra dina filter eller sökning för att hitta fler nyheter."}):(0,b.jsx)(k,{icon:g.Newspaper,title:"Inga nyheter ännu",description:"Lägg till dina första RSS-källor för att börja följa nyheter från de medier du bryr dig om.",action:a?{label:"Lägg till källa",onClick:a}:void 0})}var m=a.i(446817),n=a.i(221993),o=a.i(949258);let p=(0,o.default)("image-off",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]]);var q=a.i(969121);let r=(0,o.default)("headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),s=(0,o.default)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var t=a.i(497325),u=a.i(167703),v=a.i(715100);function w(a,b){if(!b.length)return a;let c=a;for(let a of b){let b=RegExp(`(${a.term.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi"),d=a.color||"#fbbf24";c=c.replace(b,`<mark style="background-color: ${d}30; color: inherit; padding: 0 2px; border-radius: 2px;">$1</mark>`)}return c}function x({article:a,onBookmark:d,onRead:e,onViewCompany:f,onOpen:g,layout:h="short",highlightKeywords:i=!0,isFocused:j=!1,showGradientLine:k=!0}){let[l,o]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(!1),B=(0,c.useRef)(null),C=a.description&&a.description.length>0,D=a.mediaThumbnail||a.imageUrl,E=D&&!l,F=a.mediaType&&"image"!==a.mediaType,G=function(a,b){try{let b=new URL(a).hostname;return`https://www.google.com/s2/favicons?domain=${b}&sz=32`}catch{return({"Dagens Industri":"https://www.google.com/s2/favicons?domain=di.se&sz=32","Svenska Dagbladet":"https://www.google.com/s2/favicons?domain=svd.se&sz=32",Aftonbladet:"https://www.google.com/s2/favicons?domain=aftonbladet.se&sz=32",Expressen:"https://www.google.com/s2/favicons?domain=expressen.se&sz=32","SVT Nyheter":"https://www.google.com/s2/favicons?domain=svt.se&sz=32",DN:"https://www.google.com/s2/favicons?domain=dn.se&sz=32",Breakit:"https://www.google.com/s2/favicons?domain=breakit.se&sz=32",Realtid:"https://www.google.com/s2/favicons?domain=realtid.se&sz=32","Privata Affärer":"https://www.google.com/s2/favicons?domain=privataaffarer.se&sz=32"})[b]||""}}(a.url,a.sourceName),{time:H,day:I}=function(a){let b=new Date(a),c=new Date,d=b.toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"});if(b.toDateString()===c.toDateString())return{time:d};let e=new Date(c);if(e.setDate(e.getDate()-1),b.toDateString()===e.toDateString())return{time:d,day:"Igår"};let f=new Date(c);if(f.setDate(f.getDate()-7),b>f){let a=b.toLocaleDateString("sv-SE",{weekday:"short"});return{time:d,day:a.charAt(0).toUpperCase()+a.slice(1)}}return{time:d,day:b.toLocaleDateString("sv-SE",{day:"numeric",month:"short"})}}(a.publishedAt),J=i?(a.keywordMatches||[]).map(a=>a.keyword):[],K=function(a){switch(a){case"youtube":return"bg-red-500";case"video":return"bg-purple-500";case"podcast":case"audio":return"bg-green-500";case"twitter":return"bg-sky-500";case"linkedin":return"bg-blue-600";default:return"bg-primary"}}(a.mediaType),L=F?function(a){switch(a){case"youtube":return(0,b.jsx)(v.Youtube,{className:"w-5 h-5"});case"video":return(0,b.jsx)(s,{className:"w-5 h-5"});case"podcast":case"audio":return(0,b.jsx)(r,{className:"w-5 h-5"});case"twitter":return(0,b.jsx)(t.Twitter,{className:"w-5 h-5"});case"linkedin":return(0,b.jsx)(u.Linkedin,{className:"w-5 h-5"});default:return(0,b.jsx)(q.Play,{className:"w-5 h-5"})}}(a.mediaType):null,M=function(a,b){if(b)return b;switch(a){case"youtube":return"YouTube";case"video":return"Video";case"podcast":return"Podcast";case"audio":return"Ljud";case"twitter":return"Twitter";case"linkedin":return"LinkedIn";default:return""}}(a.mediaType,a.mediaPlatform),N="media"===h;return(0,b.jsxs)("article",{ref:B,className:`
                group relative grid gap-3 sm:gap-4 md:gap-5 py-3 sm:py-4 md:py-5 cursor-pointer
                transition-all duration-200 ease-out
                ${N?"grid-cols-[40px_1fr] sm:grid-cols-[48px_1fr] md:grid-cols-[60px_1fr_160px] lg:grid-cols-[60px_1fr_180px]":"grid-cols-[40px_1fr] sm:grid-cols-[48px_1fr] md:grid-cols-[60px_1fr]"}
                ${a.isRead?"opacity-60":""}
                ${j?"ring-2 ring-primary ring-offset-2 ring-offset-background rounded-xl focus-ring":""}
                hover:bg-secondary/20 hover:-mx-2 sm:hover:-mx-3 md:hover:-mx-4 hover:px-2 sm:hover:px-3 md:hover:px-4 hover:rounded-xl
            `,style:{minHeight:"auto",alignItems:"start"},onClick:b=>{let c=b.target;c.closest("button")||c.closest("a")||g?.(a)},children:[k&&(0,b.jsx)("div",{className:"absolute bottom-0 left-[40px] sm:left-[48px] md:left-[60px] right-0 h-px opacity-50 bg-gradient-to-r from-border via-muted-foreground/30 to-transparent group-hover:opacity-0 transition-opacity"}),(0,b.jsxs)("div",{className:"absolute right-0 top-3 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),d?.(a.id)},className:"h-8 w-8 rounded-lg border border-border bg-background/80 text-muted-foreground hover:text-foreground hover:border-muted-foreground transition-colors",title:a.isBookmarked?"Ta bort Läs senare":"Läs senare",children:a.isBookmarked?(0,b.jsx)(n.BookmarkCheck,{className:"w-4 h-4 mx-auto"}):(0,b.jsx)(m.Bookmark,{className:"w-4 h-4 mx-auto"})}),(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),a.isRead||e?.(a.id)},className:"h-8 w-8 rounded-lg border border-border bg-background/80 text-muted-foreground hover:text-foreground hover:border-muted-foreground transition-colors",title:"Markera som läst",children:"✓"})]}),(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2 sm:gap-3 pt-0.5 sm:pt-1",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"font-mono text-[10px] sm:text-[11px] font-medium text-muted-foreground tabular-nums",children:H}),I&&(0,b.jsx)("div",{className:"font-mono text-[9px] sm:text-[10px] text-muted-foreground/70 mt-0.5 tabular-nums",children:I})]}),G&&!x&&(0,b.jsx)("div",{className:"w-5 h-5 sm:w-6 sm:h-6 md:w-7 md:h-7 rounded-md overflow-hidden transition-transform group-hover:scale-110",children:(0,b.jsx)("img",{src:G,alt:"",className:"w-full h-full object-cover",onError:()=>y(!0)})})]}),(0,b.jsxs)("div",{className:"min-w-0 flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2 mb-2 sm:mb-2.5",children:[F&&(0,b.jsx)("div",{className:`md:hidden flex-shrink-0 ${K} rounded p-1.5 text-white mt-0.5`,children:(0,b.jsx)("span",{className:"w-3.5 h-3.5 block [&>svg]:w-3.5 [&>svg]:h-3.5",children:L})}),(0,b.jsx)("h2",{className:`
                            ${"compact"===h?"text-[14px] sm:text-[15px]":"text-[15px] sm:text-[16px] md:text-[17px]"}
                            font-semibold leading-snug
                            transition-colors group-hover:text-foreground
                            ${a.isRead?"text-muted-foreground":"text-foreground"}
                        `,dangerouslySetInnerHTML:{__html:w(a.title,J)}})]}),"compact"!==h&&C&&(0,b.jsx)("p",{className:`
                            text-sm text-muted-foreground flex-1 prose-readable
                            line-clamp-3
                        `,dangerouslySetInnerHTML:{__html:w(a.description||"",J)}}),(a.keywordMatches?.length||a.companyMatches?.length)&&(0,b.jsxs)("div",{className:"flex flex-wrap gap-1.5 mt-3",children:[a.keywordMatches?.map(a=>(0,b.jsx)("span",{className:"text-xs font-medium px-2 py-0.5 rounded-md",style:{backgroundColor:a.keyword.color?`${a.keyword.color}20`:"hsl(var(--secondary))",color:a.keyword.color||"hsl(var(--muted-foreground))"},children:a.keyword.term},a.keyword.id)),a.companyMatches?.map(a=>(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),f?.(a.company.orgNumber)},className:"text-xs font-medium px-2 py-0.5 rounded-md bg-blue-500/10 text-blue-600 dark:text-blue-400 hover:bg-blue-500/20 transition-colors",children:a.company.name},a.company.id))]})]}),N&&(E?(0,b.jsxs)("div",{className:"hidden md:block w-full rounded-xl overflow-hidden bg-secondary min-h-[100px] lg:min-h-[120px] relative",children:[(0,b.jsx)("img",{src:D,alt:"",className:`w-full h-full object-cover transition-all duration-300
                                       ${z?"blur-0":"blur-sm"}
                                       group-hover:scale-105 group-hover:brightness-105`,onError:()=>o(!0),onLoad:()=>A(!0),loading:"lazy",decoding:"async"}),F&&(0,b.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center",children:[(0,b.jsx)("div",{className:`${K} rounded-full p-3 text-white shadow-lg
                                                opacity-90 group-hover:opacity-100 group-hover:scale-110
                                                transition-all duration-200`,children:L}),a.mediaDuration&&(0,b.jsx)("div",{className:"absolute bottom-2 right-2 px-2 py-0.5 rounded bg-black/80 text-white text-xs font-mono",children:a.mediaDuration}),M&&(0,b.jsxs)("div",{className:`absolute top-2 left-2 px-2 py-0.5 rounded
                                                    ${K} text-white text-xs font-medium
                                                    flex items-center gap-1`,children:[L&&(0,b.jsx)("span",{className:"w-3 h-3",children:L}),M]})]})]}):F?(0,b.jsxs)("div",{className:`hidden md:flex w-full rounded-xl overflow-hidden min-h-[100px] lg:min-h-[120px]
                                    bg-gradient-to-br from-secondary to-border relative
                                    items-center justify-center transition-all duration-200
                                    group-hover:from-border group-hover:to-secondary`,children:[(0,b.jsx)("div",{className:`${K} rounded-full p-4 text-white shadow-lg
                                        opacity-80 group-hover:opacity-100 group-hover:scale-110
                                        transition-all duration-200`,children:L}),M&&(0,b.jsx)("div",{className:"absolute bottom-2 right-2 px-2 py-0.5 rounded bg-black/60 text-white/90 text-xs font-medium",children:M}),a.mediaDuration&&(0,b.jsx)("div",{className:"absolute top-2 right-2 px-2 py-0.5 rounded bg-black/60 text-white text-xs font-mono",children:a.mediaDuration})]}):(0,b.jsx)("div",{className:"hidden md:flex w-full rounded-xl overflow-hidden min-h-[100px] lg:min-h-[120px] bg-gradient-to-br from-secondary to-border items-center justify-center transition-all duration-200 group-hover:from-border group-hover:to-secondary",children:(0,b.jsx)(p,{className:"w-8 h-8 lg:w-10 lg:h-10 text-muted-foreground/40 transition-all duration-200 group-hover:text-muted-foreground/60"})}))]})}var y=a.i(890717),z=a.i(663820);let A=(0,o.default)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),B=(0,o.default)("text-align-justify",[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]]);var C=a.i(272253),D=a.i(168364),E=a.i(428278);let F=(0,o.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var G=a.i(939577),H=a.i(660246);function I({sources:a,searchQuery:d="",onSearchChange:e,onToggleSource:f,onOpenRssTool:g,isOffline:i=!1,realtimeStatus:j="connecting",layout:k="short",onLayoutChange:l}){let[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(null),s=(0,c.useRef)(null),t=(0,c.useRef)(null),u=a.filter(a=>!a.isHidden),v=a.filter(a=>a.isHidden);(0,c.useEffect)(()=>{m&&s.current&&s.current.focus()},[m]),(0,c.useEffect)(()=>{let a=a=>{t.current&&!t.current.contains(a.target)&&p(!1)};return o&&document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[o]);let w=async(a,b)=>{if(f){r(a);try{await f(a,!b)}finally{r(null)}}};return(0,b.jsxs)("div",{className:"flex items-center justify-end gap-1.5 sm:gap-2 max-w-3xl mx-auto mb-4 sm:mb-6 px-1",children:[i&&(0,b.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-amber-500/10 border border-amber-500/20 text-amber-600 dark:text-amber-400 text-xs font-medium animate-in fade-in duration-300",children:[(0,b.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"}),(0,b.jsx)(A,{className:"w-3 h-3"}),(0,b.jsx)("span",{children:"Offline"})]}),!i&&(0,b.jsxs)("div",{className:`inline-flex items-center gap-1 px-2.5 py-1.5 rounded-lg text-xs font-medium
                               ${"connected"===j?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"error"===j?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"}`,title:"connected"===j?"Uppdateras i realtid":"error"===j?"Realtidsanslutning misslyckades":"Ansluter...",children:[(0,b.jsx)("span",{className:`w-1.5 h-1.5 rounded-full ${"connected"===j?"bg-green-500 animate-pulse":"error"===j?"bg-red-500":"bg-yellow-500"}`}),"connected"===j?"Live":"error"===j?"Realtid fel":"..."]}),(0,b.jsx)("div",{className:"relative flex items-center",children:m?(0,b.jsxs)("div",{className:"flex items-center gap-1.5 sm:gap-2 animate-in slide-in-from-right-2 duration-200",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(H.Input,{ref:s,type:"text",placeholder:"Sök...",value:d,onChange:a=>e(a.target.value),className:"w-40 sm:w-64 h-8 sm:h-9 pl-3 pr-8 text-sm bg-secondary/50 border-0 focus:bg-background focus:ring-1 focus:ring-border"}),d&&(0,b.jsx)("button",{onClick:()=>e(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:(0,b.jsx)(y.X,{className:"w-3.5 h-3.5"})})]}),(0,b.jsx)("button",{onClick:()=>{n(!1),e("")},className:"p-2 text-muted-foreground hover:text-foreground transition-colors",children:(0,b.jsx)(y.X,{className:"w-4 h-4"})})]}):(0,b.jsx)("button",{onClick:()=>n(!0),className:"p-2.5 rounded-lg text-muted-foreground hover:text-foreground hover:bg-secondary transition-all duration-200",title:"Sök",children:(0,b.jsx)(h.Search,{className:"w-4 h-4"})})}),(0,b.jsxs)("div",{className:"relative",ref:t,children:[(0,b.jsx)("button",{onClick:()=>g?g():p(!o),className:`p-2.5 rounded-lg transition-all duration-200
                               ${o?"text-foreground bg-secondary":"text-muted-foreground hover:text-foreground hover:bg-secondary"}`,title:"Nyhetsflöde-inställningar",children:(0,b.jsx)(z.Settings,{className:`w-4 h-4 transition-transform duration-300 ${o?"rotate-90":""}`})}),o&&(0,b.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-[calc(100vw-2rem)] sm:w-80 max-w-80 p-3 sm:p-4 rounded-xl z-50 glass shadow-xl animate-in fade-in slide-in-from-top-2 duration-200",children:[(0,b.jsxs)("h3",{className:"font-mono text-[11px] font-semibold uppercase tracking-widest text-muted-foreground mb-2",children:["Nyhetskällor (",u.length,")"]}),u.length>0?(0,b.jsx)("div",{className:"max-h-48 overflow-y-auto space-y-0.5",children:u.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between px-2 py-1.5 rounded-lg hover:bg-secondary/50 group transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,b.jsx)("div",{className:"w-5 h-5 rounded bg-secondary flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(G.Rss,{className:"w-3 h-3 text-muted-foreground"})}),(0,b.jsx)("span",{className:"text-sm truncate",children:a.sourceName}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",a.count,")"]})]}),f&&(0,b.jsx)("button",{onClick:()=>w(a.sourceId,!1),disabled:q===a.sourceId,className:"p-1.5 rounded text-muted-foreground/50 opacity-0 group-hover:opacity-100 hover:text-orange-600 hover:bg-orange-500/10 transition-all duration-200 disabled:opacity-50",title:"Dölj källa",children:(0,b.jsx)(F,{className:"w-3.5 h-3.5"})})]},a.sourceId))}):(0,b.jsx)("p",{className:"text-xs text-muted-foreground py-2",children:"Inga aktiva källor"}),v.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("h3",{className:"font-mono text-[11px] font-semibold uppercase tracking-widest text-muted-foreground mb-2 mt-4 pt-3 border-t border-border/50",children:["Dolda källor (",v.length,")"]}),(0,b.jsx)("div",{className:"max-h-32 overflow-y-auto space-y-0.5",children:v.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between px-2 py-1.5 rounded-lg bg-secondary/30 group transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,b.jsx)("div",{className:"w-5 h-5 rounded bg-secondary/50 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(G.Rss,{className:"w-3 h-3 text-muted-foreground/50"})}),(0,b.jsx)("span",{className:"text-sm truncate text-muted-foreground",children:a.sourceName})]}),f&&(0,b.jsx)("button",{onClick:()=>w(a.sourceId,!0),disabled:q===a.sourceId,className:"p-1.5 rounded text-muted-foreground hover:text-green-600 hover:bg-green-500/10 transition-all duration-200 disabled:opacity-50",title:"Visa källa igen",children:(0,b.jsx)(E.Eye,{className:"w-3.5 h-3.5"})})]},a.sourceId))})]}),(0,b.jsx)("p",{className:"text-[10px] text-muted-foreground/60 mt-3 pt-2 border-t border-border/30",children:"Dölj källor för att anpassa ditt nyhetsflöde. Dolda källor påverkar bara din vy."})]})]}),l&&(0,b.jsxs)("div",{className:"flex items-center gap-1 rounded-lg bg-secondary/60 p-1",children:[(0,b.jsx)("button",{onClick:()=>l("compact"),className:`p-1.5 rounded-md transition-colors ${"compact"===k?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,title:"Kompakt",children:(0,b.jsx)(B,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>l("short"),className:`p-1.5 rounded-md transition-colors ${"short"===k?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,title:"Kort",children:(0,b.jsx)(C.LayoutList,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>l("media"),className:`p-1.5 rounded-md transition-colors ${"media"===k?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,title:"Kort + bild",children:(0,b.jsx)(D.Image,{className:"w-4 h-4"})})]})]})}var J=a.i(172595),K=a.i(278742),L=a.i(330813);function M({article:a,onClose:d,onBookmark:e,onRead:f,onFollowTopic:g,onIgnoreTopic:h,onIgnoreSource:i}){let[k,l]=(0,c.useState)(null),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=a=>{"Escape"===a.key&&d()};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[d]),(0,c.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]);let u=a.mediaThumbnail||a.imageUrl,v=(0,c.useMemo)(()=>{let b=(a.content||a.description||"").replace(/<\s*br\s*\/?>/gi,"\n").replace(/<\/p>/gi,"\n\n");return(0,L.stripHtml)(b)},[a.content,a.description]),w=v.length>0,x=()=>{a.isRead||f?.(a.id)},z=async()=>{i&&await i(a.sourceId)},A=async a=>{if(a.preventDefault(),o.trim()){r(null),t(!0);try{"follow"===k?await g?.(o.trim())||r("Kunde inte följa ämnet"):"ignore"===k&&(await h?.(o.trim())||r("Kunde inte ignorera ämnet")),p(""),l(null)}catch{r("Något gick fel")}finally{t(!1)}}},B=new Date(a.publishedAt),C=Number.isNaN(B.getTime())?"Okänt datum":B.toLocaleString("sv-SE",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"});return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:a=>{a.target===a.currentTarget&&d()},children:(0,b.jsxs)("div",{className:"w-full max-w-3xl max-h-[85vh] bg-background rounded-2xl shadow-2xl border border-border overflow-hidden animate-scaleIn",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-5 sm:px-6 py-4 border-b border-border/60",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-muted-foreground",children:[(0,b.jsx)("span",{className:"font-medium text-foreground",children:a.sourceName}),(0,b.jsx)("span",{children:"•"}),(0,b.jsx)("span",{children:C})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>{navigator.share?.({url:a.url,title:a.title})},className:"p-2 rounded-lg text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors",title:"Dela",children:(0,b.jsx)(K.Share2,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>{e?.(a.id)},className:"p-2 rounded-lg text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors",title:a.isBookmarked?"Ta bort Läs senare":"Läs senare",children:a.isBookmarked?(0,b.jsx)(n.BookmarkCheck,{className:"w-4 h-4"}):(0,b.jsx)(m.Bookmark,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:d,className:"p-2 rounded-lg text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors",title:"Stäng",children:(0,b.jsx)(y.X,{className:"w-4 h-4"})})]})]}),(0,b.jsxs)("div",{className:"overflow-y-auto max-h-[calc(85vh-64px)]",children:[u&&(0,b.jsx)("div",{className:"w-full max-h-80 overflow-hidden bg-secondary",children:(0,b.jsx)("img",{src:u,alt:"",className:"w-full h-full object-cover",loading:"lazy",decoding:"async"})}),(0,b.jsxs)("div",{className:"p-5 sm:p-6 space-y-4",children:[(0,b.jsx)("h2",{className:"text-lg sm:text-xl font-semibold leading-snug text-foreground",children:a.title}),a.author&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Av ",a.author]}),w?(0,b.jsx)("p",{className:"text-sm sm:text-[15px] leading-relaxed whitespace-pre-wrap text-foreground/90",children:v}):(0,b.jsx)("div",{className:"text-sm text-muted-foreground italic",children:"Inget innehåll tillgängligt i flödet ännu."}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 pt-2",children:[(0,b.jsxs)(j.Button,{onClick:()=>{x(),window.open(a.url,"_blank")},className:"gap-2",children:["Läs hos källa",(0,b.jsx)(J.ExternalLink,{className:"w-4 h-4"})]}),(0,b.jsx)(j.Button,{variant:"outline",onClick:x,children:"Markera som läst"}),(0,b.jsx)(j.Button,{variant:"outline",onClick:z,children:"Ignorera källa"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>l("follow"),children:"Följ ämne"}),(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>l("ignore"),children:"Ignorera ämne"})]}),k&&(0,b.jsxs)("form",{onSubmit:A,className:"flex flex-wrap gap-2 items-center",children:[(0,b.jsx)(H.Input,{value:o,onChange:a=>p(a.target.value),placeholder:"follow"===k?"Ämne att följa":"Ämne att ignorera",className:"w-full sm:w-64"}),(0,b.jsx)(j.Button,{type:"submit",size:"sm",disabled:s||!o.trim(),children:s?"Sparar...":"Spara"}),(0,b.jsx)(j.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>l(null),children:"Avbryt"}),q&&(0,b.jsx)("span",{className:"text-xs text-destructive",children:q})]})]})]})]})})}function N({label:a,articleCount:c}){return(0,b.jsxs)("div",{className:"flex items-center gap-4 py-2 animate-in fade-in duration-500",children:[(0,b.jsx)("span",{className:"font-mono text-[11px] font-semibold uppercase tracking-widest text-muted-foreground",children:a}),void 0!==c&&(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground/60",children:[c," ",1===c?"artikel":"artiklar"]}),(0,b.jsx)("div",{className:"flex-1 h-px bg-gradient-to-r from-border to-transparent"})]})}var O=a.i(678148),P=a.i(291271),Q=a.i(179535),R=a.i(615214);function S(a){return a.split(/(\*\*[^*]+\*\*)/g).map((a,c)=>a.startsWith("**")&&a.endsWith("**")?(0,b.jsx)("strong",{className:"font-semibold text-foreground",children:a.slice(2,-2)},c):a)}function T({announcement:a,onRead:d,onFollowUp:e,onViewCompany:f,showGradientLine:g=!0}){let[h,i]=(0,c.useState)(!1),{time:j,day:k}=function(a){let b=new Date(a),c=new Date,d=b.toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"});if(b.toDateString()===c.toDateString())return{time:d};let e=new Date(c);if(e.setDate(e.getDate()-1),b.toDateString()===e.toDateString())return{time:d,day:"Igår"};let f=new Date(c);if(f.setDate(f.getDate()-7),b>f){let a=b.toLocaleDateString("sv-SE",{weekday:"short"});return{time:d,day:a.charAt(0).toUpperCase()+a.slice(1)}}return{time:d,day:b.toLocaleDateString("sv-SE",{day:"numeric",month:"short"})}}(a.publishedAt),l=function(a){switch(a){case"nyemission":return"Möjlig nyemission";case"likvidation":return"Likvidation";case"fusion":return"Fusion";case"kallelse":return"Kallelse till stämma";default:return"Kungörelse"}}(a.announcementType);return(0,b.jsxs)("article",{className:`
        group relative py-3 sm:py-4 md:py-5
        transition-all duration-200 ease-out
        ${a.isRead?"opacity-60":""}
      `,children:[g&&!h&&(0,b.jsx)("div",{className:"absolute bottom-0 left-[40px] sm:left-[48px] md:left-[60px] right-0 h-px opacity-50 bg-gradient-to-r from-border via-muted-foreground/30 to-transparent group-hover:opacity-0 transition-opacity"}),(0,b.jsxs)("button",{onClick:()=>{i(!h),h||a.isRead||d?.(a.id)},className:"w-full text-left grid gap-3 sm:gap-4 md:gap-5 grid-cols-[40px_1fr] sm:grid-cols-[48px_1fr] md:grid-cols-[60px_1fr] hover:bg-amber-50/50 dark:hover:bg-amber-950/20 hover:-mx-2 sm:hover:-mx-3 md:hover:-mx-4 hover:px-2 sm:hover:px-3 md:hover:px-4 hover:rounded-xl transition-all",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2 sm:gap-3 pt-0.5 sm:pt-1",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"font-mono text-[10px] sm:text-[11px] font-medium text-muted-foreground tabular-nums",children:j}),k&&(0,b.jsx)("div",{className:"font-mono text-[9px] sm:text-[10px] text-muted-foreground/70 mt-0.5 tabular-nums",children:k})]}),(0,b.jsx)("div",{className:"w-6 h-6 sm:w-7 sm:h-7 rounded-md overflow-hidden bg-amber-100 dark:bg-amber-900/40 flex items-center justify-center transition-transform group-hover:scale-110",children:(0,b.jsx)(Q.Bell,{className:"w-3.5 h-3.5 text-amber-600 dark:text-amber-400"})})]}),(0,b.jsxs)("div",{className:"min-w-0 flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-1",children:[(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)("span",{className:"inline-flex items-center gap-1 text-xs font-medium px-2 py-0.5 rounded-md bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300",children:l})}),(0,b.jsx)("div",{className:"flex-shrink-0 text-muted-foreground",children:h?(0,b.jsx)(P.ChevronUp,{className:"w-4 h-4"}):(0,b.jsx)(O.ChevronDown,{className:"w-4 h-4"})})]}),(0,b.jsx)("h2",{className:"text-[15px] sm:text-[16px] md:text-[17px] font-semibold leading-snug text-foreground",children:a.companyName}),!h&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-1",children:a.title})]})]}),h&&(0,b.jsxs)("div",{className:"mt-3 ml-[40px] sm:ml-[48px] md:ml-[60px] pl-3 sm:pl-4 md:pl-5 border-l-2 border-amber-200 dark:border-amber-800 bg-amber-50/30 dark:bg-amber-950/10 rounded-r-xl py-4 pr-4",children:[(0,b.jsx)("div",{className:"prose-sm",children:function(a){let c=a.split("\n"),d=[],e=0,f=0;for(;e<c.length;){let a=c[e],g=`md-${f++}`;if(""===a.trim()){e++;continue}if(a.startsWith("## ")){d.push((0,b.jsx)("h3",{className:"text-base font-semibold text-foreground mt-4 mb-2 first:mt-0",children:S(a.slice(3))},g)),e++;continue}if(a.startsWith("### ")){d.push((0,b.jsx)("h4",{className:"text-sm font-semibold text-foreground mt-3 mb-1.5",children:S(a.slice(4))},g)),e++;continue}if(a.includes("|")&&e+1<c.length&&c[e+1].includes("|")&&c[e+1].includes("-")){let f=[a],h=e+1;for(;h<c.length&&c[h].includes("|");)f.push(c[h]),h++;let i=f[0].split("|").map(a=>a.trim()).filter(a=>a),j=f.slice(2).map(a=>a.split("|").map(a=>a.trim()).filter(a=>a));d.push((0,b.jsx)("div",{className:"my-3 overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm border-collapse",children:[(0,b.jsx)("thead",{children:(0,b.jsx)("tr",{className:"border-b border-border",children:i.map((a,c)=>(0,b.jsx)("th",{className:"text-left py-1.5 px-2 font-medium text-muted-foreground",children:a},c))})}),(0,b.jsx)("tbody",{children:j.map((a,c)=>(0,b.jsx)("tr",{className:"border-b border-border/50",children:a.map((a,c)=>(0,b.jsx)("td",{className:"py-1.5 px-2 text-foreground/80",children:S(a)},c))},c))})]})},g)),e=h;continue}if(a.startsWith("- ")){let f=[a.slice(2)],h=e+1;for(;h<c.length&&c[h].startsWith("- ");)f.push(c[h].slice(2)),h++;d.push((0,b.jsx)("ul",{className:"my-2 space-y-1",children:f.map((a,c)=>(0,b.jsxs)("li",{className:"text-sm text-foreground/80 flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-amber-500 mt-1.5",children:"•"}),(0,b.jsx)("span",{children:S(a)})]},c))},g)),e=h;continue}d.push((0,b.jsx)("p",{className:"text-sm text-foreground/80 leading-relaxed my-2",children:S(a)},g)),e++}return d}(a.interpretation)}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-amber-200/50 dark:border-amber-800/50",children:[(0,b.jsxs)("a",{href:a.announcementUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-lg bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300 hover:bg-amber-200 dark:hover:bg-amber-900/60 transition-colors",children:[(0,b.jsx)(J.ExternalLink,{className:"w-3.5 h-3.5"}),"Öppna kungörelse"]}),e&&(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),e(a)},className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-lg bg-amber-600 text-white hover:bg-amber-700 transition-colors",children:"Följ upp"}),f&&(0,b.jsxs)("button",{onClick:b=>{b.stopPropagation(),f(a.orgNumber)},className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-lg bg-secondary text-secondary-foreground hover:bg-secondary/80 transition-colors",children:[(0,b.jsx)(R.Building2,{className:"w-3.5 h-3.5"}),"Visa bolag"]})]}),(0,b.jsxs)("div",{className:"mt-3 flex items-center gap-3 text-xs text-muted-foreground",children:[(0,b.jsxs)("span",{children:["Kungörelse-ID: ",a.announcementId]}),(0,b.jsxs)("span",{children:["Org.nr: ",a.orgNumber]})]})]})]})}let U={id:"announcement-voi-k7420-26",type:"announcement",title:"Kallelse till extra bolagsstämma med förslag om nyemission",interpretation:`## Tolkning av kung\xf6relsen

**Voi Technology AB** kallar till **extra bolagsst\xe4mma** den 27 januari 2026 kl. 11.00 p\xe5 huvudkontoret i Stockholm.

### Huvud\xe4rende: Riktad nyemission

Styrelsen f\xf6resl\xe5r en riktad emission av **1 040 000 preferensaktier** (serie C SuperStam) till ledande befattningshavare:

| Mottagare | Antal aktier |
|-----------|--------------|
| CPO | 400 000 |
| CBO | 300 000 |
| Regionchef 1 | 150 000 |
| Regionchef 2 | 100 000 |
| F\xf6re detta marknadsanst\xe4lld | 50 000 |
| CTO | 40 000 |

**Teckningskurs:** 0,10 USD per aktie (totalt ~104 000 USD f\xf6r hela emissionen)

### V\xe4sentliga villkor

- Kr\xe4ver 90% majoritet (r\xf6ster och aktier) f\xf6r godk\xe4nnande
- Aktierna har hembudsf\xf6rbeh\xe5ll och omvandlingsf\xf6rbeh\xe5ll
- Teckning inom 15 arbetsdagar, betalning inom 4 veckor
- Aktiekapital\xf6kning: max 6 459,63 kr

### Noterbart

Detta \xe4r en incitamentsemission till ledningsgruppen. Den l\xe5ga teckningskursen (0,10 USD) kombinerat med preferensaktier av serie C SuperStam tyder p\xe5 ett optionslikt uppl\xe4gg d\xe4r v\xe4rdet realiseras vid framtida likviditetsevent (exit/b\xf6rsnotering). Att en f\xf6re detta anst\xe4lld inkluderas kan indikera en uppg\xf6relse eller tidigare utf\xe4stelse.`,companyName:"Voi Technology AB",orgNumber:"559160-8031",announcementUrl:"https://poit.bolagsverket.se/poit-app/kungorelse/K7420-26",announcementId:"K7420-26",announcementType:"nyemission",publishedAt:new Date,isRead:!1};var V=a.i(523614),W=a.i(787092);function X(){let a=(0,d.useRouter)(),[g,h]=(0,c.useState)([]),[i,k]=(0,c.useState)([]),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null),[w,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(),[F,G]=(0,c.useState)(),[H,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[O,P]=(0,c.useState)(-1),[Q,R]=(0,c.useState)(!1),[S,X]=(0,c.useState)("connecting"),[Y,Z]=(0,c.useState)("short"),[$,_]=(0,c.useState)(null),[aa,ab]=(0,c.useState)(!1),ac=(0,c.useRef)(null),ad=(0,c.useRef)(null),ae=(0,c.useRef)([]),af=(0,c.useRef)(null),ag=(0,c.useCallback)(async(a,b=!1)=>{try{b?t(!0):r(!0),v(null);let c=new URLSearchParams;c.set("limit","30"),B&&c.set("query",B),D&&c.set("sourceId",D),F&&c.set("companyId",F),H&&c.set("isBookmarked","true"),K&&c.set("isRead","false"),a&&c.set("cursor",a),B||D||F||H||K||a?c.set("fast","false"):c.set("fast","true");let d=await fetch(`/api/nyheter?${c.toString()}`);if(!d.ok)throw Error("Failed to fetch articles");let e=await d.json();b?h(a=>[...a,...e.articles]):h(e.articles),k(e.sources||[]),p(e.stats||null),y(e.nextCursor),A(e.hasMore)}catch(a){v(a instanceof Error?a.message:"Unknown error")}finally{r(!1),t(!1)}},[B,D,F,H,K]),ah=(0,c.useCallback)(async()=>{try{let a=await fetch("/api/bevakning?limit=200");if(a.ok){let b=await a.json();n(b.companies.map(a=>({id:a.id,name:a.name,orgNumber:a.orgNumber})))}}catch{}},[]);(0,c.useEffect)(()=>{ag(),ah()},[]),(0,c.useEffect)(()=>{let a=()=>R(!1),b=()=>R(!0);return R(!navigator.onLine),window.addEventListener("online",a),window.addEventListener("offline",b),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",b)}},[]),(0,c.useEffect)(()=>{let a=window.localStorage.getItem("newsLayout");a&&Z(a)},[]),(0,c.useEffect)(()=>{window.localStorage.setItem("newsLayout",Y)},[Y]),(0,c.useEffect)(()=>{Q?X("error"):X("connecting")},[Q]);let ai=(0,c.useCallback)(a=>{if(F)return!1;if(B){let b=B.toLowerCase();if(!`${a.title} ${a.description||""}`.toLowerCase().includes(b))return!1}return(!D||a.sourceId===D)&&(!H||!!a.isBookmarked)&&(!K||!a.isRead)},[B,F,D,H,K]),aj=(0,c.useCallback)(a=>{p(b=>{if(!b)return b;let c=new Date(a.publishedAt),d=new Date,e=c.getFullYear()===d.getFullYear()&&c.getMonth()===d.getMonth()&&c.getDate()===d.getDate();return{...b,total:b.total+1,unread:b.unread+ +!a.isRead,bookmarked:b.bookmarked+ +!!a.isBookmarked,today:b.today+ +!!e}}),k(b=>{let c=b.findIndex(b=>b.sourceId===a.sourceId);return -1===c?b:b.map((a,b)=>b===c?{...a,count:a.count+1}:a)})},[]),ak=(0,c.useCallback)(a=>({id:a.id,url:a.url,title:a.title,description:a.description,content:void 0,author:void 0,imageUrl:a.imageUrl,mediaThumbnail:null,publishedAt:a.publishedAt,sourceName:a.sourceName,sourceId:a.sourceId,sourceType:a.sourceType,sourceColor:a.sourceColor??null,isRead:a.isRead??!1,isBookmarked:a.isBookmarked??!1,keywordMatches:void 0,companyMatches:void 0}),[]);!function({onNewArticle:a,onArticleDeleted:b,onArticleUpdated:d,onNewArticlesCount:e,onStatusChange:f,enabled:g=!0}={}){let[h,i]=(0,c.useState)(null),j=(0,c.useRef)(null),k=(0,c.useRef)(0),l=(0,c.useRef)(null),m=(0,c.useCallback)(()=>{k.current>0&&e&&(e(k.current),k.current=0)},[e]);(0,c.useEffect)(()=>{if(!g)return;let a=!0;return f?.("connecting"),async function(){let b=await (0,W.getSupabaseClient)();a&&b?i(b):a&&(console.warn("[Realtime] Supabase not configured, skipping realtime subscription"),f?.("error"))}(),()=>{a=!1}},[g,f]),(0,c.useEffect)(()=>{if(!g||!h)return;let c=!0;return j.current=h.channel("article-changes").on("postgres_changes",{event:"*",schema:"public",table:"Article"},c=>{let e=c.eventType;"INSERT"===e?(console.log("[Realtime] New article:",c.new?.title),a&&c.new&&a(c.new),k.current++,l.current&&clearTimeout(l.current),l.current=setTimeout(m,2e3)):"DELETE"===e?(console.log("[Realtime] Article deleted:",c.old?.id),b&&c.old?.id&&b(c.old.id)):"UPDATE"===e&&(console.log("[Realtime] Article updated:",c.new?.title),d&&c.new&&d(c.new))}).subscribe(a=>{c&&("SUBSCRIBED"===a?(console.log("[Realtime] Subscribed to Article changes (INSERT/UPDATE/DELETE)"),f?.("connected")):"CHANNEL_ERROR"===a?(console.error("[Realtime] Failed to subscribe to Article changes"),f?.("error")):("TIMED_OUT"===a||"CLOSED"===a)&&f?.("error"))}),()=>{c=!1,l.current&&clearTimeout(l.current),j.current&&h&&(h.removeChannel(j.current),j.current=null)}},[g,h,a,b,d,m,f])}({enabled:!Q,onStatusChange:X,onNewArticle:(0,c.useCallback)(a=>{let b=ak(a),c=ai(b);aj(b),c&&h(a=>a.some(a=>a.id===b.id)?a:[b,...a])},[ai,ak,aj]),onArticleDeleted:(0,c.useCallback)(a=>{console.log("[Realtime] Removing article from feed:",a),h(b=>b.filter(b=>b.id!==a))},[]),onArticleUpdated:(0,c.useCallback)(a=>{console.log("[Realtime] Updating article in feed:",a.title),h(b=>b.map(b=>b.id===a.id?{...b,...a}:b))},[])}),(0,c.useEffect)(()=>(ad.current&&clearTimeout(ad.current),ad.current=setTimeout(()=>{ag(),P(-1)},300),()=>{ad.current&&clearTimeout(ad.current)}),[B,D,F,H,K]),(0,c.useEffect)(()=>{let a=new IntersectionObserver(a=>{a[0].isIntersecting&&z&&!s&&w&&ag(w,!0)},{threshold:.1});return ac.current&&a.observe(ac.current),()=>a.disconnect()},[z,s,w,ag]),(0,c.useEffect)(()=>{let a=a=>{if(!(a.target instanceof HTMLInputElement||a.target instanceof HTMLTextAreaElement))switch(a.key){case"ArrowDown":case"j":a.preventDefault(),P(a=>{let b=a+1;return b<g.length?(ae.current[b]?.scrollIntoView({behavior:"smooth",block:"center"}),b):a});break;case"ArrowUp":case"k":a.preventDefault(),P(a=>{let b=a-1;return b>=0?(ae.current[b]?.scrollIntoView({behavior:"smooth",block:"center"}),b):-1===a?-1:0});break;case"Enter":case"o":if(O>=0&&O<g.length){a.preventDefault();let b=g[O];aq(b.id),window.open(b.url,"_blank")}break;case"b":O>=0&&O<g.length&&(a.preventDefault(),ap(g[O].id));break;case"r":O>=0&&O<g.length&&(a.preventDefault(),aq(g[O].id));break;case"Escape":P(-1)}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[g,O]);let al=async a=>{try{if((await fetch("/api/nyheter/keywords",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({term:a})})).ok)return await ag(),!0;return!1}catch{return!1}},am=async a=>{try{if((await fetch("/api/nyheter/ignore/terms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({term:a})})).ok)return await ag(),!0;return!1}catch{return!1}},an=async a=>{try{if((await fetch("/api/nyheter/ignore/sources",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceId:a})})).ok)return await ag(),!0;return!1}catch{return!1}},ao=async(a,b)=>{try{b?await fetch("/api/nyheter/ignore/sources",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceId:a})}):await fetch("/api/nyheter/ignore/sources",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceId:a})}),await ag()}catch{}},ap=async a=>{h(b=>b.map(b=>b.id===a?{...b,isBookmarked:!b.isBookmarked}:b));try{await fetch(`/api/nyheter/${a}/bookmark`,{method:"POST"})}catch{h(b=>b.map(b=>b.id===a?{...b,isBookmarked:!b.isBookmarked}:b))}},aq=async a=>{h(b=>b.map(b=>b.id===a?{...b,isRead:!0}:b));try{await fetch(`/api/nyheter/${a}/read`,{method:"POST"})}catch{}},ar=b=>{a.push(`/bolag/${b}`)},as=async a=>{if(_(a),ab(!0),a.isRead||await aq(a.id),void 0===a.content)try{let b=await fetch(`/api/nyheter/${a.id}`);if(b.ok){let c=await b.json();_(b=>b&&b.id===a.id?{...b,...c}:b)}}catch{}};if(q)return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(I,{sources:[],onSearchChange:()=>{},onSourceChange:()=>{},onBookmarkedChange:()=>{},onUnreadChange:()=>{},isOffline:Q,realtimeStatus:S,layout:Y,onLayoutChange:Z}),(0,b.jsx)("div",{className:"flex flex-col gap-6 max-w-3xl mx-auto",children:Array.from({length:4}).map((a,c)=>(0,b.jsxs)("div",{className:"bg-card rounded-2xl border p-6 space-y-4 animate-in fade-in duration-300",style:{animationDelay:`${100*c}ms`},children:[(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)(V.Skeleton,{shimmer:!0,className:"w-16 h-16 rounded-lg flex-shrink-0"}),(0,b.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(V.Skeleton,{shimmer:!0,className:"h-5 w-24"}),(0,b.jsx)(V.Skeleton,{shimmer:!0,className:"h-4 w-20"})]}),(0,b.jsx)(V.Skeleton,{shimmer:!0,className:"h-6 w-full"}),(0,b.jsx)(V.Skeleton,{shimmer:!0,className:"h-6 w-4/5"})]})]}),(0,b.jsx)(V.Skeleton,{shimmer:!0,className:"h-20 w-full"})]},c))})]});if(u)return(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,b.jsx)(f.AlertCircle,{className:"w-12 h-12 text-destructive mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Kunde inte ladda nyheter"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:u}),(0,b.jsx)(j.Button,{onClick:()=>ag(),children:"Försök igen"})]});if(0===g.length){let a=!!(B||D||F||H||K);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(I,{sources:i,searchQuery:B,onSearchChange:C,onSourceChange:E,onBookmarkedChange:J,onUnreadChange:L,onToggleSource:ao,isOffline:Q,realtimeStatus:S,layout:Y,onLayoutChange:Z}),(0,b.jsx)(l,{hasFilters:a})]})}return(0,b.jsxs)("div",{className:"space-y-6",ref:af,children:[(0,b.jsx)(I,{sources:i,searchQuery:B,onSearchChange:C,onSourceChange:E,onBookmarkedChange:J,onUnreadChange:L,onToggleSource:ao,isOffline:Q,realtimeStatus:S,layout:Y,onLayoutChange:Z}),(0,b.jsx)("div",{className:"flex flex-col max-w-3xl mx-auto",children:(function(a){let b=new Date,c=b.toDateString(),d=new Date(b);d.setDate(d.getDate()-1);let e=d.toDateString(),f=new Date(b);f.setDate(f.getDate()-7);let g=new Map;for(let d of a){let a,h,i=new Date(d.publishedAt),j=i.toDateString();if(j===c)a="Idag",h=0;else if(j===e)a="Igår",h=1;else if(i>f)a="Denna vecka",h=2;else{let c=i.toLocaleDateString("sv-SE",{month:"long",year:"numeric"});a=c.charAt(0).toUpperCase()+c.slice(1),h=100-Math.floor((b.getTime()-i.getTime())/2592e6)}g.has(a)||g.set(a,{label:a,articles:[],sortKey:h}),g.get(a).articles.push(d)}return Array.from(g.values()).sort((a,b)=>a.sortKey-b.sortKey).map(({label:a,articles:b})=>({label:a,articles:b}))})([...g.map(a=>({...a,type:"article"})),U].sort((a,b)=>new Date(b.publishedAt).getTime()-new Date(a.publishedAt).getTime())).map(a=>(0,b.jsxs)("div",{children:[(0,b.jsx)(N,{label:a.label,articleCount:a.articles.length}),(0,b.jsx)("div",{className:"flex flex-col",children:a.articles.map(a=>{if("announcement"===a.type)return(0,b.jsx)(T,{announcement:a,onRead:aq,onViewCompany:ar,onFollowUp:a=>{console.log("Följ upp:",a.companyName)},showGradientLine:!0},a.id);let c=g.findIndex(b=>b.id===a.id);return(0,b.jsx)("div",{ref:a=>{ae.current[c]=a},children:(0,b.jsx)(x,{article:a,onBookmark:ap,onRead:aq,onViewCompany:ar,onOpen:as,layout:Y,isFocused:O===c,showGradientLine:!0})},a.id)})})]},a.label))}),z&&(0,b.jsx)("div",{ref:ac,className:"flex justify-center py-8",children:s?(0,b.jsx)(e.Loader2,{className:"w-6 h-6 animate-spin text-muted-foreground"}):(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>ag(w,!0),children:"Ladda fler"})}),aa&&$&&(0,b.jsx)(M,{article:$,onClose:()=>{ab(!1),_(null)},onBookmark:ap,onRead:aq,onFollowTopic:al,onIgnoreTopic:am,onIgnoreSource:an})]})}a.s(["NewsFeed",()=>X],353224)}];

//# debugId=350618bd-ae94-1337-3924-c579a37d86f8
//# sourceMappingURL=CLAUDE_projects_LoopDesk_src_components_nyheter_news-feed_tsx_179c4ffc._.js.map