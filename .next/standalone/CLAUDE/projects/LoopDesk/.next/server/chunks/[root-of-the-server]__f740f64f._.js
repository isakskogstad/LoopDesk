;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="d47c2bb4-ebac-c362-56fe-2af7da06e53b")}catch(e){}}();
module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},219985,(e,t,r)=>{"use strict";t.exports=e.r(918622)},666870,(e,t,r)=>{"use strict";t.exports=e.r(219985).vendored["react-rsc"].React},179475,(e,t,r)=>{t.exports=e.x("@prisma/client-935491d6e3ada45d",()=>require("@prisma/client-935491d6e3ada45d"))},109357,e=>e.a(async(t,r)=>{try{let t=await e.y("pg-3f7efcb9b626a319");e.n(t),r()}catch(e){r(e)}},!0),530447,e=>{"use strict";class t{proxies=[];currentIndex=0;isActive=!1;lastFetchTime=0;fetchCooldown=3e5;balance=0;blockingStats={http429Count:0,consecutiveCaptchas:0,lastCaptchaTime:0,sessionBlocked:!1};captchaTimes=[];failedProxies=new Set;proxyFailures=new Map;maxFailures=3;activationReason=null;shouldActivate(){if(this.isActive)return{shouldActivate:!1,reason:null};if(this.blockingStats.http429Count>=3)return{shouldActivate:!0,reason:`Rate limited ${this.blockingStats.http429Count} times`};if(this.blockingStats.consecutiveCaptchas>=5)return{shouldActivate:!0,reason:`${this.blockingStats.consecutiveCaptchas} consecutive CAPTCHAs`};let e=Date.now(),t=this.captchaTimes.filter(t=>e-t<6e4);return t.length>=3?{shouldActivate:!0,reason:`${t.length} CAPTCHAs in ${60}s`}:this.blockingStats.sessionBlocked?{shouldActivate:!0,reason:"Session blocked"}:{shouldActivate:!1,reason:null}}recordCaptcha(){let e=Date.now();this.blockingStats.consecutiveCaptchas++,this.blockingStats.lastCaptchaTime=e,this.captchaTimes.push(e),this.captchaTimes=this.captchaTimes.filter(t=>e-t<12e4),console.log(`[ProxyManager] CAPTCHA recorded: consecutive=${this.blockingStats.consecutiveCaptchas}`)}recordSuccess(){this.blockingStats.consecutiveCaptchas=0}recordRateLimit(){this.blockingStats.http429Count++,console.log(`[ProxyManager] Rate limit recorded: count=${this.blockingStats.http429Count}`)}recordSessionBlocked(){this.blockingStats.sessionBlocked=!0,console.log("[ProxyManager] Session blocked recorded")}resetStats(){this.blockingStats={http429Count:0,consecutiveCaptchas:0,lastCaptchaTime:0,sessionBlocked:!1},this.captchaTimes=[]}async fetchProxies(){let e=process.env.PROXY_SERVER||"",t=process.env.PROXY_USERNAME||"",r=process.env.PROXY_PASSWORD||"",a=process.env.TWOCAPTCHA_API_KEY||"";if(e&&"disabled"!==e){let a=!e||e.includes("://")?e:`http://${e}`,[s,i]=a.replace(/^[a-z]+:\/\//,"").split("/")[0].split(":"),o=parseInt(i||"80",10);return this.proxies=[{id:a,host:s,port:o,url:a,source:"static",username:t||void 0,password:r||void 0}],this.lastFetchTime=Date.now(),this.failedProxies.clear(),this.proxyFailures.clear(),console.log("[ProxyManager] Using static proxy from environment"),this.proxies}if(!a)return console.log("[ProxyManager] No API key configured - proxy functionality disabled"),console.log("[ProxyManager] Set TWOCAPTCHA_API_KEY or PROXY_SERVER to enable proxies"),this.proxies=[],this.proxies;let s=Date.now();if(s-this.lastFetchTime<this.fetchCooldown&&this.proxies.length>0)return console.log("[ProxyManager] Using cached proxies"),this.proxies;try{console.log("[ProxyManager] Fetching 10 SE proxies from 2captcha...");let e=new URL("https://api.2captcha.com/proxy");e.searchParams.set("key",a),e.searchParams.set("country","se"),e.searchParams.set("type","residential"),e.searchParams.set("limit","10");let t=await fetch(e.toString()),r=await t.json();if("OK"===r.status&&Array.isArray(r.data)){let e=r.data.map(e=>{if("string"==typeof e){let[t,r]=e.split(":");return t&&r?{id:e,host:t,port:parseInt(r,10),url:`http://${e}`,source:"2captcha"}:null}let t=e.proxy||e.proxy_string||e.ip_port,r=e.host||e.ip||(t?t.split(":")[0]:void 0),a=e.port||(t?t.split(":")[1]:void 0);if(!r||!a)return null;let s="string"==typeof a?parseInt(a,10):a,i=e.protocol||e.type||"http",o=e.login||e.username||e.user,n=e.password||e.pass;return{id:`${r}:${s}`,host:r,port:s,url:`${i}://${r}:${s}`,source:"2captcha",username:o,password:n}}).filter(e=>!!e);this.proxies=e,this.lastFetchTime=s,this.failedProxies.clear(),this.proxyFailures.clear(),console.log(`[ProxyManager] Got ${this.proxies.length} proxies from 2captcha`)}else console.error(`[ProxyManager] 2captcha error: ${r.message||JSON.stringify(r)}`)}catch(e){console.error("[ProxyManager] Error fetching proxies:",e)}return this.proxies}async checkBalance(){let e=process.env.TWOCAPTCHA_API_KEY||"";if(!e)return 0;try{let t=new URL("https://2captcha.com/res.php");t.searchParams.set("key",e),t.searchParams.set("action","getbalance"),t.searchParams.set("json","1");let r=await fetch(t.toString()),a=await r.json();if(1===a.status)return this.balance=parseFloat(a.request),this.balance}catch(e){console.error("[ProxyManager] Error checking balance:",e)}return 0}async activate(e){if(this.isActive)return console.log("[ProxyManager] Already active"),!0;console.log(`[ProxyManager] ACTIVATING PROXY - Reason: ${e}`),this.isActive=!0,this.activationReason=e;let t=await this.fetchProxies();return 0===t.length?(console.warn("[ProxyManager] No proxies available"),!1):(this.currentIndex=0,this.resetStats(),console.log(`[ProxyManager] Activated with ${t.length} proxies`),!0)}deactivate(){console.log("[ProxyManager] Deactivating proxy"),this.isActive=!1,this.activationReason=null,this.resetStats()}getCurrentProxy(){if(!this.isActive||0===this.proxies.length)return null;let e=this.proxies[this.currentIndex];return{server:e.url,username:e.username,password:e.password}}markFailed(e){if(!e)return;let t="server"in e?e.server:e.url,r=(this.proxyFailures.get(t)||0)+1;this.proxyFailures.set(t,r),r>=this.maxFailures&&(console.log(`[ProxyManager] Proxy ${t} marked as failed`),this.failedProxies.add(t))}markSuccess(e){if(!e)return;let t="server"in e?e.server:e.url;this.proxyFailures.set(t,0)}getPlaywrightConfig(e){let t=e||this.getCurrentProxy();if(!t)return{};let r="server"in t?t.server:t.url;return{proxy:{server:r,username:t.username,password:t.password}}}getNext(){if(!this.isActive||0===this.proxies.length)return null;let e=0;for(;e<this.proxies.length;){let t=this.proxies[this.currentIndex];if(this.currentIndex=(this.currentIndex+1)%this.proxies.length,!this.failedProxies.has(t.url))return t;e++}return console.log("[ProxyManager] All proxies exhausted, resetting..."),this.failedProxies.clear(),this.proxyFailures.clear(),this.proxies[0]||null}rotateProxy(){0!==this.proxies.length&&(this.currentIndex=(this.currentIndex+1)%this.proxies.length,console.log(`[ProxyManager] Rotated to proxy ${this.currentIndex+1}/${this.proxies.length}`))}getStatus(){return{isActive:this.isActive,enabled:this.isActive,reason:this.activationReason,total:this.proxies.length,failed:this.failedProxies.size,available:this.proxies.length-this.failedProxies.size}}async refresh(){let e=Date.now();if(!(e-this.lastFetchTime<this.fetchCooldown)||!(this.proxies.length>=3))try{let t=await this.checkBalance();if(t<.1)return void console.warn(`[ProxyManager] Low balance: $${t} - proxy disabled`);let r=await this.fetchProxies();r.length>0&&(this.proxies=r,this.currentIndex=0,this.lastFetchTime=e,this.failedProxies.clear(),this.proxyFailures.clear(),console.log(`[ProxyManager] Refreshed ${r.length} proxies`))}catch(e){console.error("[ProxyManager] Refresh failed:",e)}}getStats(){return{enabled:this.isActive,reason:this.activationReason,total:this.proxies.length,failed:this.failedProxies.size,available:this.proxies.length-this.failedProxies.size}}}let r=new t;e.s(["proxyManager",0,r])},845856,e=>e.a(async(t,r)=>{try{var a=e.i(985917),s=e.i(528227),i=e.i(530447),o=t([s]);[s]=o.then?(await o)():o;let c=Date.now();function n(e){return new Promise((t,r)=>setTimeout(()=>r(Error(`Timeout after ${e}ms`)),e))}async function l(){let e={status:"ok",timestamp:new Date().toISOString(),uptime:Math.floor((Date.now()-c)/1e3),database:{status:"unknown",latency:0},memory:{usage:0,usageMB:0,heapUsed:0,heapUsedMB:0,heapTotal:0,heapTotalMB:0,external:0,externalMB:0,rss:0,rssMB:0},proxy:{enabled:!1,active:!1,total:0,available:0,failed:0,reason:null},rsshub:"unknown"};try{let t=Date.now();await Promise.race([s.prisma.$queryRaw`SELECT 1`,n(3e3)]),e.database.status="connected",e.database.latency=Date.now()-t}catch(t){e.database.status="disconnected",e.status="degraded",console.error("Database check failed:",t)}try{let t=process.memoryUsage();e.memory={usage:t.heapUsed/t.heapTotal,usageMB:Math.round(t.heapUsed/1024/1024),heapUsed:t.heapUsed,heapUsedMB:Math.round(t.heapUsed/1024/1024),heapTotal:t.heapTotal,heapTotalMB:Math.round(t.heapTotal/1024/1024),external:t.external,externalMB:Math.round(t.external/1024/1024),rss:t.rss,rssMB:Math.round(t.rss/1024/1024)}}catch(e){console.error("Failed to get memory usage:",e)}try{let t=i.proxyManager.getStatus();e.proxy={enabled:!!process.env.TWOCAPTCHA_API_KEY,active:t.isActive,total:t.total,available:t.available,failed:t.failed,reason:t.reason}}catch(e){console.error("Failed to get proxy status:",e)}try{let t=process.env.RSSHUB_URL||"https://rsshub.rssforever.com";e.rsshub=(await Promise.race([fetch(`${t}/`,{signal:AbortSignal.timeout(2e3)}),n(2e3)])).ok?"available":"unavailable"}catch{e.rsshub="unavailable"}return a.NextResponse.json(e,{status:200})}e.s(["GET",()=>l,"dynamic",0,"force-dynamic","runtime",0,"nodejs"]),r()}catch(e){r(e)}},!1),410617,e=>e.a(async(t,r)=>{try{var a=e.i(4345),s=e.i(886530),i=e.i(368549),o=e.i(437313),n=e.i(476054),l=e.i(905303),c=e.i(581143),h=e.i(175398),u=e.i(288930),p=e.i(521605),d=e.i(831917),x=e.i(571367),g=e.i(448720),v=e.i(615849),y=e.i(955298),f=e.i(193695);e.i(952391);var m=e.i(541372),P=e.i(845856),R=t([P]);[P]=R.then?(await R)():R;let A=new a.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/health/route",pathname:"/api/health",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/CLAUDE/projects/LoopDesk/src/app/api/health/route.ts",nextConfigOutput:"standalone",userland:P}),{workAsyncStorage:C,workUnitAsyncStorage:T,serverHooks:S}=A;function w(){return(0,i.patchFetch)({workAsyncStorage:C,workUnitAsyncStorage:T})}async function b(e,t,r){A.isDev&&(0,o.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/health/route";a=a.replace(/\/index$/,"")||"/";let i=await A.prepare(e,t,{srcPage:a,multiZoneDraftMode:!1});if(!i)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:P,params:R,nextConfig:w,parsedUrl:b,isDraftMode:C,prerenderManifest:T,routerServerContext:S,isOnDemandRevalidate:E,revalidateOnlyGenerated:k,resolvedPathname:M,clientReferenceManifest:I,serverActionsManifest:$}=i,_=(0,c.normalizeAppPath)(a),O=!!(T.dynamicRoutes[_]||T.routes[M]),U=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,b,!1):t.end("This page could not be found"),null);if(O&&!C){let e=!!T.routes[M],t=T.dynamicRoutes[_];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await U();throw new f.NoFallbackError}}let N=null;!O||A.isDev||C||(N=M,N="/index"===N?"/":N);let F=!0===A.isDev||!O,D=O&&!F;$&&I&&(0,l.setManifestsSingleton)({page:a,clientReferenceManifest:I,serverActionsManifest:$});let H=e.method||"GET",j=(0,n.getTracer)(),B=j.getActiveScopeSpan(),q={params:R,prerenderManifest:T,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:F,incrementalCache:(0,o.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a,s)=>A.onRequestError(e,t,a,s,S)},sharedContext:{buildId:P}},K=new h.NodeNextRequest(e),L=new h.NodeNextResponse(t),Y=u.NextRequestAdapter.fromNodeNextRequest(K,(0,u.signalFromNodeResponse)(t));try{let i=async e=>A.handle(Y,q).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=j.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=r.get("next.route");if(s){let t=`${H} ${s}`;e.setAttributes({"next.route":s,"http.route":s,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${a}`)}),l=!!(0,o.getRequestMeta)(e,"minimalMode"),c=async o=>{var n,c;let h=async({previousCacheEntry:s})=>{try{if(!l&&E&&k&&!s)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await i(o);e.fetchMetrics=q.renderOpts.fetchMetrics;let n=q.renderOpts.pendingWaitUntil;n&&r.waitUntil&&(r.waitUntil(n),n=void 0);let c=q.renderOpts.collectedTags;if(!O)return await (0,x.sendResponse)(K,L,a,q.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,g.toNodeOutgoingHttpHeaders)(a.headers);c&&(t[y.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==q.renderOpts.collectedRevalidate&&!(q.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&q.renderOpts.collectedRevalidate,s=void 0===q.renderOpts.collectedExpire||q.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:q.renderOpts.collectedExpire;return{value:{kind:m.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:s}}}}catch(t){throw(null==s?void 0:s.isStale)&&await A.onRequestError(e,t,{routerKind:"App Router",routePath:a,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:E})},!1,S),t}},u=await A.handleResponse({req:e,nextConfig:w,cacheKey:N,routeKind:s.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:T,isRoutePPREnabled:!1,isOnDemandRevalidate:E,revalidateOnlyGenerated:k,responseGenerator:h,waitUntil:r.waitUntil,isMinimalMode:l});if(!O)return null;if((null==u||null==(n=u.value)?void 0:n.kind)!==m.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(c=u.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",E?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),C&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,g.fromNodeOutgoingHttpHeaders)(u.value.headers);return l&&O||p.delete(y.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,v.getCacheControlHeader)(u.cacheControl)),await (0,x.sendResponse)(K,L,new Response(u.value.body,{headers:p,status:u.value.status||200})),null};B?await c(B):await j.withPropagatedContext(e.headers,()=>j.trace(p.BaseServerSpan.handleRequest,{spanName:`${H} ${a}`,kind:n.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},c))}catch(t){if(t instanceof f.NoFallbackError||await A.onRequestError(e,t,{routerKind:"App Router",routePath:_,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:E})},!1,S),O)throw t;return await (0,x.sendResponse)(K,L,new Response(null,{status:500})),null}}e.s(["handler",()=>b,"patchFetch",()=>w,"routeModule",()=>A,"serverHooks",()=>S,"workAsyncStorage",()=>C,"workUnitAsyncStorage",()=>T]),r()}catch(e){r(e)}},!1)];

//# debugId=d47c2bb4-ebac-c362-56fe-2af7da06e53b
//# sourceMappingURL=%5Broot-of-the-server%5D__f740f64f._.js.map