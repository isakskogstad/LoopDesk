{
  "version": 3,
  "sources": [],
  "debugId": "fbcfc0b6-7bb8-65b0-05c4-c859216046bd",
  "sections": [
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\nexport function formatRelativeTime(date: Date | string): string {\n  const now = new Date();\n  const then = new Date(date);\n  const diffMs = now.getTime() - then.getTime();\n  const diffMins = Math.floor(diffMs / 60000);\n  const diffHours = Math.floor(diffMs / 3600000);\n  const diffDays = Math.floor(diffMs / 86400000);\n\n  if (diffMins < 1) return \"Just nu\";\n  if (diffMins < 60) return `${diffMins} min sedan`;\n  if (diffHours < 24) return `${diffHours} tim sedan`;\n  if (diffDays < 7) return `${diffDays} dagar sedan`;\n\n  return then.toLocaleDateString(\"sv-SE\", {\n    day: \"numeric\",\n    month: \"short\",\n    year: diffDays > 365 ? \"numeric\" : undefined,\n  });\n}\n\n/**\n * Format publication time as exact time (HH:MM) for today,\n * or date + time for older articles\n */\nexport function formatPublicationTime(date: Date | string): string {\n  const now = new Date();\n  const then = new Date(date);\n\n  // Check if valid date\n  if (isNaN(then.getTime())) {\n    return \"\";\n  }\n\n  const isToday = then.toDateString() === now.toDateString();\n  const isYesterday = new Date(now.getTime() - 86400000).toDateString() === then.toDateString();\n\n  const timeStr = then.toLocaleTimeString(\"sv-SE\", {\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n  });\n\n  if (isToday) {\n    return timeStr;\n  }\n\n  if (isYesterday) {\n    return `Igår ${timeStr}`;\n  }\n\n  // Within last 7 days - show weekday + time\n  const diffDays = Math.floor((now.getTime() - then.getTime()) / 86400000);\n  if (diffDays < 7) {\n    const weekday = then.toLocaleDateString(\"sv-SE\", { weekday: \"short\" });\n    return `${weekday} ${timeStr}`;\n  }\n\n  // Older - show date + time\n  return then.toLocaleDateString(\"sv-SE\", {\n    day: \"numeric\",\n    month: \"short\",\n  }) + ` ${timeStr}`;\n}\n\n/**\n * Format org number with dash (XXXXXX-XXXX)\n */\nexport function formatOrgNr(orgNr: string): string {\n  const clean = orgNr.replace(/\\D/g, \"\");\n  if (clean.length === 10) return `${clean.slice(0, 6)}-${clean.slice(6)}`;\n  return orgNr;\n}\n\n/**\n * Format amount in TSEK or MSEK\n */\nexport function formatAmount(value: string | number | undefined | null): string {\n  if (value === undefined || value === null || value === \"\") return \"-\";\n  const strValue = String(value);\n  const isNegative = strValue.startsWith(\"-\") || strValue.includes(\"−\");\n  const numStr = strValue.replace(/[^\\d]/g, \"\");\n  const num = parseInt(numStr, 10);\n  if (isNaN(num)) return strValue;\n  const sign = isNegative ? \"-\" : \"\";\n  if (num >= 1000) {\n    return `${sign}${(num / 1000).toFixed(0)} MSEK`;\n  }\n  return `${sign}${num} TSEK`;\n}\n\n/**\n * Format amount in MSEK with decimals\n */\nexport function formatMSEK(value: number | undefined | null, decimals = 1): string {\n  if (value === undefined || value === null) return \"-\";\n  return `${(value / 1_000_000).toFixed(decimals)} MSEK`;\n}\n\n/**\n * Strip HTML tags and decode common entities\n */\nexport function stripHtml(value: string | undefined | null): string {\n  if (!value) return \"\";\n  return value\n    .replace(/<[^>]*>/g, \"\")\n    .replace(/&amp;/g, \"&\")\n    .replace(/&lt;/g, \"<\")\n    .replace(/&gt;/g, \">\")\n    .replace(/&quot;/g, '\"')\n    .replace(/&#39;/g, \"'\")\n    .replace(/&nbsp;/g, \" \")\n    .replace(/\\s+/g, \" \")\n    .trim();\n}\n\n/**\n * Safe date parsing with fallback\n */\nexport function parseDate(dateStr: string | undefined | null): Date | null {\n  if (!dateStr) return null;\n  let date = new Date(dateStr);\n  if (!isNaN(date.getTime())) return date;\n  const parts = dateStr.split(/[.\\-\\/]/);\n  if (parts.length === 3) {\n    if (parts[0].length === 4) {\n      date = new Date(parseInt(parts[0]), parseInt(parts[1]) - 1, parseInt(parts[2]));\n    } else {\n      date = new Date(parseInt(parts[2]), parseInt(parts[1]) - 1, parseInt(parts[0]));\n    }\n    if (!isNaN(date.getTime())) return date;\n  }\n  return null;\n}\n\n/**\n * Format date to Swedish locale\n */\nexport function formatDate(dateStr: string | undefined | null): string {\n  if (!dateStr) return \"\";\n  const date = parseDate(dateStr);\n  if (!date) return dateStr;\n  return date.toLocaleDateString(\"sv-SE\", {\n    year: \"numeric\",\n    month: \"short\",\n    day: \"numeric\",\n  });\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium transition-all duration-200 ease-out active:scale-[0.97] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/40 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground shadow-sm hover:bg-primary/90 hover:shadow-md\",\n        destructive:\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border border-border bg-transparent hover:bg-secondary hover:text-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/90\",\n        ghost:\n          \"hover:bg-secondary hover:text-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-9 rounded-lg gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-11 rounded-lg px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n        \"icon-sm\": \"size-8\",\n        \"icon-lg\": \"size-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,kNAAG,EACxB,yeACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,UAAU,SAAS,EACnB,OAAO,SAAS,EAChB,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,mNAAI,GAAG;IAE9B,qBACE,yRAAC;QACC,aAAU;QACV,gBAAc;QACd,aAAW;QACX,WAAW,IAAA,oKAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,uBAAS,8PAAgB,CAG7B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,yRAAC,qNAAqB;QACpB,WAAW,IAAA,oKAAE,EACX,+XACA;QAED,GAAG,KAAK;QACT,KAAK;kBAEL,cAAA,yRAAC,sNAAsB;YACrB,WAAW,IAAA,oKAAE,EACX;;;;;;;;;;;AAKR,OAAO,WAAW,GAAG,qNAAqB,CAAC,WAAW"}},
    {"offset": {"line": 257, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/ui/dropdown-menu.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { CheckIcon, ChevronRightIcon, CircleIcon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction DropdownMenu({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {\n  return <DropdownMenuPrimitive.Root data-slot=\"dropdown-menu\" {...props} />\n}\n\nfunction DropdownMenuPortal({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {\n  return (\n    <DropdownMenuPrimitive.Portal data-slot=\"dropdown-menu-portal\" {...props} />\n  )\n}\n\nfunction DropdownMenuTrigger({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {\n  return (\n    <DropdownMenuPrimitive.Trigger\n      data-slot=\"dropdown-menu-trigger\"\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuContent({\n  className,\n  sideOffset = 4,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {\n  return (\n    <DropdownMenuPrimitive.Portal>\n      <DropdownMenuPrimitive.Content\n        data-slot=\"dropdown-menu-content\"\n        sideOffset={sideOffset}\n        className={cn(\n          \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md\",\n          className\n        )}\n        {...props}\n      />\n    </DropdownMenuPrimitive.Portal>\n  )\n}\n\nfunction DropdownMenuGroup({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {\n  return (\n    <DropdownMenuPrimitive.Group data-slot=\"dropdown-menu-group\" {...props} />\n  )\n}\n\nfunction DropdownMenuItem({\n  className,\n  inset,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {\n  inset?: boolean\n  variant?: \"default\" | \"destructive\"\n}) {\n  return (\n    <DropdownMenuPrimitive.Item\n      data-slot=\"dropdown-menu-item\"\n      data-inset={inset}\n      data-variant={variant}\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuCheckboxItem({\n  className,\n  children,\n  checked,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {\n  return (\n    <DropdownMenuPrimitive.CheckboxItem\n      data-slot=\"dropdown-menu-checkbox-item\"\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      checked={checked}\n      {...props}\n    >\n      <span className=\"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center\">\n        <DropdownMenuPrimitive.ItemIndicator>\n          <CheckIcon className=\"size-4\" />\n        </DropdownMenuPrimitive.ItemIndicator>\n      </span>\n      {children}\n    </DropdownMenuPrimitive.CheckboxItem>\n  )\n}\n\nfunction DropdownMenuRadioGroup({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {\n  return (\n    <DropdownMenuPrimitive.RadioGroup\n      data-slot=\"dropdown-menu-radio-group\"\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuRadioItem({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {\n  return (\n    <DropdownMenuPrimitive.RadioItem\n      data-slot=\"dropdown-menu-radio-item\"\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    >\n      <span className=\"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center\">\n        <DropdownMenuPrimitive.ItemIndicator>\n          <CircleIcon className=\"size-2 fill-current\" />\n        </DropdownMenuPrimitive.ItemIndicator>\n      </span>\n      {children}\n    </DropdownMenuPrimitive.RadioItem>\n  )\n}\n\nfunction DropdownMenuLabel({\n  className,\n  inset,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {\n  inset?: boolean\n}) {\n  return (\n    <DropdownMenuPrimitive.Label\n      data-slot=\"dropdown-menu-label\"\n      data-inset={inset}\n      className={cn(\n        \"px-2 py-1.5 text-sm font-medium data-[inset]:pl-8\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {\n  return (\n    <DropdownMenuPrimitive.Separator\n      data-slot=\"dropdown-menu-separator\"\n      className={cn(\"bg-border -mx-1 my-1 h-px\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuShortcut({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      data-slot=\"dropdown-menu-shortcut\"\n      className={cn(\n        \"text-muted-foreground ml-auto text-xs tracking-widest\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuSub({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {\n  return <DropdownMenuPrimitive.Sub data-slot=\"dropdown-menu-sub\" {...props} />\n}\n\nfunction DropdownMenuSubTrigger({\n  className,\n  inset,\n  children,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {\n  inset?: boolean\n}) {\n  return (\n    <DropdownMenuPrimitive.SubTrigger\n      data-slot=\"dropdown-menu-sub-trigger\"\n      data-inset={inset}\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronRightIcon className=\"ml-auto size-4\" />\n    </DropdownMenuPrimitive.SubTrigger>\n  )\n}\n\nfunction DropdownMenuSubContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {\n  return (\n    <DropdownMenuPrimitive.SubContent\n      data-slot=\"dropdown-menu-sub-content\"\n      className={cn(\n        \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  DropdownMenu,\n  DropdownMenuPortal,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuGroup,\n  DropdownMenuLabel,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioGroup,\n  DropdownMenuRadioItem,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuSub,\n  DropdownMenuSubTrigger,\n  DropdownMenuSubContent,\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 532, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/lib/hooks/use-dark-mode.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useCallback, useRef } from \"react\";\n\nconst STORAGE_KEY = \"darkMode\";\n\n// Helper function - defined outside component\nfunction applyDarkMode(value: boolean) {\n  if (typeof document === \"undefined\") return;\n  if (value) {\n    document.documentElement.classList.add(\"dark\");\n  } else {\n    document.documentElement.classList.remove(\"dark\");\n  }\n}\n\nexport function useDarkMode() {\n  const [isDark, setIsDark] = useState(false);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const hasSyncedRef = useRef(false);\n\n  // Initialize from localStorage on mount (client-side only)\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n\n    try {\n      const stored = localStorage.getItem(STORAGE_KEY);\n      const prefersDark = window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\n      const shouldBeDark = stored !== null ? stored === \"true\" : prefersDark;\n\n      setIsDark(shouldBeDark);\n      applyDarkMode(shouldBeDark);\n    } catch {\n      // localStorage might not be available\n    }\n\n    setIsLoaded(true);\n  }, []);\n\n  // Sync with database when user is logged in\n  useEffect(() => {\n    if (!isLoaded || hasSyncedRef.current) return;\n\n    const syncWithDatabase = async () => {\n      try {\n        const res = await fetch(\"/api/konto/settings\");\n        if (res.ok) {\n          const settings = await res.json();\n          if (settings.darkMode !== undefined) {\n            setIsDark(settings.darkMode);\n            applyDarkMode(settings.darkMode);\n            localStorage.setItem(STORAGE_KEY, String(settings.darkMode));\n            hasSyncedRef.current = true;\n          }\n        }\n      } catch {\n        // User might not be logged in, use localStorage value\n      }\n    };\n\n    syncWithDatabase();\n  }, [isLoaded]);\n\n  const saveToDatabase = async (value: boolean) => {\n    try {\n      await fetch(\"/api/konto/settings\", {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ darkMode: value }),\n      });\n    } catch {\n      // Ignore errors - localStorage is the fallback\n    }\n  };\n\n  const toggle = useCallback(() => {\n    if (typeof window === \"undefined\") return;\n\n    setIsDark((prev) => {\n      const newValue = !prev;\n\n      try {\n        localStorage.setItem(STORAGE_KEY, String(newValue));\n      } catch {\n        // localStorage might not be available\n      }\n\n      applyDarkMode(newValue);\n      saveToDatabase(newValue);\n\n      return newValue;\n    });\n  }, []);\n\n  const setDarkMode = useCallback((value: boolean) => {\n    if (typeof window === \"undefined\") return;\n\n    setIsDark(value);\n\n    try {\n      localStorage.setItem(STORAGE_KEY, String(value));\n    } catch {\n      // localStorage might not be available\n    }\n\n    applyDarkMode(value);\n    saveToDatabase(value);\n  }, []);\n\n  return { isDark, toggle, setDarkMode, isLoaded };\n}\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AAIA,MAAM,cAAc;AAEpB,8CAA8C;AAC9C,SAAS,cAAc,KAAc;IACnC,IAAI,OAAO,aAAa,aAAa;IACrC,IAAI,OAAO;QACT,SAAS,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC;IACzC,OAAO;QACL,SAAS,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC;IAC5C;AACF;AAEO,SAAS;IACd,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,4PAAQ,EAAC;IACrC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,4PAAQ,EAAC;IACzC,MAAM,eAAe,IAAA,0PAAM,EAAC;IAE5B,2DAA2D;IAC3D,IAAA,6PAAS,EAAC;QACR,wCAAmC;;;IAcrC,GAAG,EAAE;IAEL,4CAA4C;IAC5C,IAAA,6PAAS,EAAC;QACR,IAAI,CAAC,YAAY,aAAa,OAAO,EAAE;QAEvC,MAAM,mBAAmB;YACvB,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM;gBACxB,IAAI,IAAI,EAAE,EAAE;oBACV,MAAM,WAAW,MAAM,IAAI,IAAI;oBAC/B,IAAI,SAAS,QAAQ,KAAK,WAAW;wBACnC,UAAU,SAAS,QAAQ;wBAC3B,cAAc,SAAS,QAAQ;wBAC/B,aAAa,OAAO,CAAC,aAAa,OAAO,SAAS,QAAQ;wBAC1D,aAAa,OAAO,GAAG;oBACzB;gBACF;YACF,EAAE,OAAM;YACN,sDAAsD;YACxD;QACF;QAEA;IACF,GAAG;QAAC;KAAS;IAEb,MAAM,iBAAiB,OAAO;QAC5B,IAAI;YACF,MAAM,MAAM,uBAAuB;gBACjC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,UAAU;gBAAM;YACzC;QACF,EAAE,OAAM;QACN,+CAA+C;QACjD;IACF;IAEA,MAAM,SAAS,IAAA,+PAAW,EAAC;QACzB,wCAAmC;;;IAgBrC,GAAG,EAAE;IAEL,MAAM,cAAc,IAAA,+PAAW,EAAC,CAAC;QAC/B,wCAAmC;;;IAYrC,GAAG,EAAE;IAEL,OAAO;QAAE;QAAQ;QAAQ;QAAa;IAAS;AACjD"}},
    {"offset": {"line": 618, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/navigation.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { usePathname } from \"next/navigation\";\nimport { useSession, signOut } from \"next-auth/react\";\nimport { useState, useEffect } from \"react\";\nimport { Newspaper, Building2, LogIn, Eye, Bell, Sun, Moon, User, Key, LogOut, Menu, X } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { Switch } from \"@/components/ui/switch\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { useDarkMode } from \"@/lib/hooks/use-dark-mode\";\n\nconst navItems = [\n  {\n    href: \"/nyheter\",\n    label: \"Nyheter\",\n    icon: Newspaper,\n  },\n  {\n    href: \"/bolag\",\n    label: \"Bolag\",\n    icon: Building2,\n  },\n  {\n    href: \"/bevakning\",\n    label: \"Investerar-databaser\",\n    icon: Eye,\n  },\n  {\n    href: \"/bolaghandelser\",\n    label: \"Bolagshändelser\",\n    icon: Bell,\n  },\n];\n\nfunction getUserInitials(name: string | null | undefined): string {\n  if (!name) return \"?\";\n  const parts = name.trim().split(\" \");\n  if (parts.length >= 2) {\n    return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();\n  }\n  return name.substring(0, 2).toUpperCase();\n}\n\nexport function Navigation() {\n  const pathname = usePathname();\n  const { data: session, status } = useSession();\n  const { isDark, toggle, isLoaded } = useDarkMode();\n  const [isScrolled, setIsScrolled] = useState(false);\n  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\n\n  // Track scroll position for header blur effect\n  useEffect(() => {\n    const handleScroll = () => {\n      setIsScrolled(window.scrollY > 10);\n    };\n    window.addEventListener(\"scroll\", handleScroll, { passive: true });\n    handleScroll(); // Check initial position\n    return () => window.removeEventListener(\"scroll\", handleScroll);\n  }, []);\n\n  // Close mobile menu on route change\n  useEffect(() => {\n    setIsMobileMenuOpen(false);\n  }, [pathname]);\n\n  // Prevent body scroll when mobile menu is open\n  useEffect(() => {\n    if (isMobileMenuOpen) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = '';\n    }\n    return () => {\n      document.body.style.overflow = '';\n    };\n  }, [isMobileMenuOpen]);\n\n  // Don't show nav on auth pages\n  if (pathname === \"/login\" || pathname === \"/register\") {\n    return null;\n  }\n\n  return (\n    <>\n    <nav className={cn(\n      \"sticky top-0 z-50 border-b transition-all duration-300\",\n      isScrolled\n        ? \"border-border/50 bg-background/80 backdrop-blur-xl shadow-sm\"\n        : \"border-transparent bg-background/95 backdrop-blur-sm\"\n    )}>\n      <div className=\"max-w-[1200px] mx-auto px-4\">\n        <div className=\"flex h-14 sm:h-16 items-center justify-between\">\n          {/* Logo */}\n          <Link href=\"/\" className=\"flex items-center gap-2 sm:gap-3\">\n            <div className=\"nav-logo-icon\">LD</div>\n            <span className=\"hidden sm:inline font-display font-bold tracking-tight\">LoopDesk</span>\n          </Link>\n\n          {/* Desktop Nav Links + Auth */}\n          <div className=\"hidden md:flex items-center gap-4\">\n            {/* Nav Links */}\n            <div className=\"flex items-center gap-1\">\n              {navItems.map((item) => {\n                const isActive = item.href === \"/\"\n                  ? pathname === \"/\"\n                  : pathname.startsWith(item.href);\n\n                return (\n                  <Link\n                    key={item.href}\n                    href={item.href}\n                    className={cn(\n                      \"relative flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200\",\n                      isActive\n                        ? \"text-foreground\"\n                        : \"text-muted-foreground hover:text-foreground hover:bg-secondary/50\"\n                    )}\n                  >\n                    <item.icon className={cn(\n                      \"h-4 w-4 transition-transform duration-200\",\n                      isActive && \"scale-110 text-[hsl(355,82%,56%)]\"\n                    )} />\n                    <span>{item.label}</span>\n                    {/* Active indicator - Tema A red accent */}\n                    {isActive && (\n                      <span className=\"absolute bottom-0 left-3 right-3 h-0.5 bg-[hsl(355,82%,56%)] rounded-full animate-in fade-in slide-in-from-bottom-1 duration-200\" />\n                    )}\n                  </Link>\n                );\n              })}\n            </div>\n\n            {/* Theme Toggle */}\n            {isLoaded && (\n              <button\n                onClick={toggle}\n                className=\"theme-toggle-btn\"\n                aria-label=\"Växla tema\"\n              >\n                {isDark ? <Sun /> : <Moon />}\n              </button>\n            )}\n\n            {/* Auth Section */}\n            {status === \"loading\" ? (\n              <div className=\"user-avatar-lg animate-pulse\" />\n            ) : session ? (\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <button className=\"user-avatar-lg ring-2 ring-transparent hover:ring-border transition-all duration-200\">\n                    {session.user?.image ? (\n                      <img\n                        src={session.user.image}\n                        alt={session.user.name || \"\"}\n                      />\n                    ) : (\n                      <span>{getUserInitials(session.user?.name)}</span>\n                    )}\n                  </button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent\n                  align=\"end\"\n                  className=\"w-64 glass shadow-xl animate-in fade-in slide-in-from-top-2 duration-200\"\n                  sideOffset={8}\n                >\n                  {/* User info header */}\n                  <div className=\"px-3 py-3 border-b border-border/50\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-10 h-10 rounded-full bg-secondary flex items-center justify-center overflow-hidden\">\n                        {session.user?.image ? (\n                          <img src={session.user.image} alt=\"\" className=\"w-full h-full object-cover\" />\n                        ) : (\n                          <span className=\"text-sm font-medium\">{getUserInitials(session.user?.name)}</span>\n                        )}\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-sm font-semibold truncate\">{session.user?.name || \"Användare\"}</p>\n                        <p className=\"text-xs text-muted-foreground truncate\">\n                          {session.user?.email}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Menu items */}\n                  <div className=\"py-1\">\n                    <DropdownMenuItem asChild className=\"cursor-pointer gap-2 px-3 py-2\">\n                      <Link href=\"/konto\">\n                        <User className=\"w-4 h-4\" />\n                        Kontoinställningar\n                      </Link>\n                    </DropdownMenuItem>\n                    <DropdownMenuItem asChild className=\"cursor-pointer gap-2 px-3 py-2\">\n                      <Link href=\"/konto/losenord\">\n                        <Key className=\"w-4 h-4\" />\n                        Byt lösenord\n                      </Link>\n                    </DropdownMenuItem>\n                  </div>\n\n                  <DropdownMenuSeparator className=\"bg-border/50\" />\n\n                  {/* Theme toggle */}\n                  <div className=\"px-3 py-2\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        {isDark ? <Moon className=\"w-4 h-4\" /> : <Sun className=\"w-4 h-4\" />}\n                        <span className=\"text-sm\">Mörkt läge</span>\n                      </div>\n                      <Switch\n                        checked={isDark}\n                        onCheckedChange={toggle}\n                        aria-label=\"Växla mörkt läge\"\n                      />\n                    </div>\n                  </div>\n\n                  <DropdownMenuSeparator className=\"bg-border/50\" />\n\n                  {/* Logout */}\n                  <div className=\"py-1\">\n                    <DropdownMenuItem\n                      onClick={() => signOut({ callbackUrl: \"/login\" })}\n                      className=\"cursor-pointer gap-2 px-3 py-2 text-destructive focus:text-destructive\"\n                    >\n                      <LogOut className=\"w-4 h-4\" />\n                      Logga ut\n                    </DropdownMenuItem>\n                  </div>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            ) : (\n              <Link href=\"/login\">\n                <Button variant=\"outline\" size=\"sm\">\n                  <LogIn className=\"mr-2 h-4 w-4\" />\n                  Logga in\n                </Button>\n              </Link>\n            )}\n          </div>\n\n          {/* Mobile controls */}\n          <div className=\"flex md:hidden items-center gap-2\">\n            {/* Theme Toggle - Mobile */}\n            {isLoaded && (\n              <button\n                onClick={toggle}\n                className=\"theme-toggle-btn w-9 h-9\"\n                aria-label=\"Växla tema\"\n              >\n                {isDark ? <Sun className=\"w-4 h-4\" /> : <Moon className=\"w-4 h-4\" />}\n              </button>\n            )}\n\n            {/* User avatar - Mobile */}\n            {status !== \"loading\" && session && (\n              <Link href=\"/konto\" className=\"user-avatar-sm\">\n                {session.user?.image ? (\n                  <img src={session.user.image} alt={session.user.name || \"\"} />\n                ) : (\n                  <span className=\"text-xs\">{getUserInitials(session.user?.name)}</span>\n                )}\n              </Link>\n            )}\n\n            {/* Hamburger menu button */}\n            <button\n              onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}\n              className=\"p-2 rounded-lg text-foreground hover:bg-secondary transition-colors\"\n              aria-label={isMobileMenuOpen ? \"Stäng meny\" : \"Öppna meny\"}\n              aria-expanded={isMobileMenuOpen}\n            >\n              {isMobileMenuOpen ? (\n                <X className=\"w-5 h-5\" />\n              ) : (\n                <Menu className=\"w-5 h-5\" />\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n    </nav>\n\n    {/* Mobile Menu Overlay */}\n    {isMobileMenuOpen && (\n      <div className=\"fixed inset-0 z-40 md:hidden\">\n        {/* Backdrop */}\n        <div\n          className=\"absolute inset-0 bg-background/80 backdrop-blur-sm animate-in fade-in duration-200\"\n          onClick={() => setIsMobileMenuOpen(false)}\n        />\n\n        {/* Menu panel */}\n        <div className=\"absolute top-14 left-0 right-0 bottom-0 bg-background border-t border-border overflow-y-auto animate-in slide-in-from-top-2 duration-200\">\n          <div className=\"p-4 space-y-2\">\n            {navItems.map((item) => {\n              const isActive = item.href === \"/\"\n                ? pathname === \"/\"\n                : pathname.startsWith(item.href);\n\n              return (\n                <Link\n                  key={item.href}\n                  href={item.href}\n                  className={cn(\n                    \"flex items-center gap-3 px-4 py-3 rounded-xl text-base font-medium transition-all duration-200\",\n                    isActive\n                      ? \"bg-secondary text-foreground\"\n                      : \"text-muted-foreground hover:text-foreground hover:bg-secondary/50\"\n                  )}\n                  onClick={() => setIsMobileMenuOpen(false)}\n                >\n                  <item.icon className={cn(\n                    \"h-5 w-5\",\n                    isActive && \"text-foreground\"\n                  )} />\n                  <span>{item.label}</span>\n                </Link>\n              );\n            })}\n          </div>\n\n          {/* Divider */}\n          <div className=\"h-px bg-border mx-4 my-2\" />\n\n          {/* User section - Mobile */}\n          <div className=\"p-4 space-y-2\">\n            {session ? (\n              <>\n                {/* User info */}\n                <div className=\"flex items-center gap-3 px-4 py-3 rounded-xl bg-secondary/50\">\n                  <div className=\"w-10 h-10 rounded-full bg-secondary flex items-center justify-center overflow-hidden\">\n                    {session.user?.image ? (\n                      <img src={session.user.image} alt=\"\" className=\"w-full h-full object-cover\" />\n                    ) : (\n                      <span className=\"text-sm font-medium\">{getUserInitials(session.user?.name)}</span>\n                    )}\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-sm font-semibold truncate\">{session.user?.name || \"Användare\"}</p>\n                    <p className=\"text-xs text-muted-foreground truncate\">{session.user?.email}</p>\n                  </div>\n                </div>\n\n                <Link\n                  href=\"/konto\"\n                  className=\"flex items-center gap-3 px-4 py-3 rounded-xl text-base font-medium text-muted-foreground hover:text-foreground hover:bg-secondary/50 transition-all\"\n                  onClick={() => setIsMobileMenuOpen(false)}\n                >\n                  <User className=\"h-5 w-5\" />\n                  <span>Kontoinställningar</span>\n                </Link>\n\n                <Link\n                  href=\"/konto/losenord\"\n                  className=\"flex items-center gap-3 px-4 py-3 rounded-xl text-base font-medium text-muted-foreground hover:text-foreground hover:bg-secondary/50 transition-all\"\n                  onClick={() => setIsMobileMenuOpen(false)}\n                >\n                  <Key className=\"h-5 w-5\" />\n                  <span>Byt lösenord</span>\n                </Link>\n\n                {/* Theme toggle row */}\n                <div className=\"flex items-center justify-between px-4 py-3 rounded-xl bg-secondary/30\">\n                  <div className=\"flex items-center gap-3\">\n                    {isDark ? <Moon className=\"h-5 w-5\" /> : <Sun className=\"h-5 w-5\" />}\n                    <span className=\"text-base font-medium\">Mörkt läge</span>\n                  </div>\n                  <Switch\n                    checked={isDark}\n                    onCheckedChange={toggle}\n                    aria-label=\"Växla mörkt läge\"\n                  />\n                </div>\n\n                <button\n                  onClick={() => {\n                    setIsMobileMenuOpen(false);\n                    signOut({ callbackUrl: \"/login\" });\n                  }}\n                  className=\"flex items-center gap-3 px-4 py-3 rounded-xl text-base font-medium text-destructive hover:bg-destructive/10 transition-all w-full\"\n                >\n                  <LogOut className=\"h-5 w-5\" />\n                  <span>Logga ut</span>\n                </button>\n              </>\n            ) : (\n              <Link\n                href=\"/login\"\n                className=\"flex items-center justify-center gap-2 px-4 py-3 rounded-xl bg-foreground text-background text-base font-medium transition-all\"\n                onClick={() => setIsMobileMenuOpen(false)}\n              >\n                <LogIn className=\"h-5 w-5\" />\n                <span>Logga in</span>\n              </Link>\n            )}\n          </div>\n        </div>\n      </div>\n    )}\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1512, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/providers/session-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport { SessionProvider as NextAuthSessionProvider } from \"next-auth/react\";\nimport { ReactNode } from \"react\";\n\ninterface SessionProviderProps {\n  children: ReactNode;\n}\n\nexport function SessionProvider({ children }: SessionProviderProps) {\n  return (\n    <NextAuthSessionProvider>\n      {children}\n    </NextAuthSessionProvider>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AASO,SAAS,gBAAgB,EAAE,QAAQ,EAAwB;IAChE,qBACE,yRAAC,mMAAuB;kBACrB;;;;;;AAGP"}},
    {"offset": {"line": 1534, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/ui/page-transition.tsx"],"sourcesContent":["\"use client\";\n\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { usePathname } from \"next/navigation\";\nimport { ReactNode } from \"react\";\n\ninterface PageTransitionProps {\n  children: ReactNode;\n  className?: string;\n}\n\nconst pageVariants = {\n  initial: {\n    opacity: 0,\n    y: 12,\n  },\n  animate: {\n    opacity: 1,\n    y: 0,\n    transition: {\n      duration: 0.4,\n      ease: [0.25, 0.1, 0.25, 1] as const,\n    },\n  },\n  exit: {\n    opacity: 0,\n    y: -8,\n    transition: {\n      duration: 0.25,\n      ease: [0.25, 0.1, 0.25, 1] as const,\n    },\n  },\n};\n\nexport function PageTransition({ children, className }: PageTransitionProps) {\n  const pathname = usePathname();\n\n  return (\n    <AnimatePresence mode=\"wait\" initial={false}>\n      <motion.div\n        key={pathname}\n        initial=\"initial\"\n        animate=\"animate\"\n        exit=\"exit\"\n        variants={pageVariants}\n        className={className}\n      >\n        {children}\n      </motion.div>\n    </AnimatePresence>\n  );\n}\n\n// Simpler fade transition\nexport function FadeIn({\n  children,\n  className,\n  delay = 0,\n  duration = 0.4,\n}: {\n  children: ReactNode;\n  className?: string;\n  delay?: number;\n  duration?: number;\n}) {\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 8 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{\n        duration,\n        delay,\n        ease: [0.25, 0.1, 0.25, 1] as const,\n      }}\n      className={className}\n    >\n      {children}\n    </motion.div>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AAAA;AACA;AAHA;;;;AAWA,MAAM,eAAe;IACnB,SAAS;QACP,SAAS;QACT,GAAG;IACL;IACA,SAAS;QACP,SAAS;QACT,GAAG;QACH,YAAY;YACV,UAAU;YACV,MAAM;gBAAC;gBAAM;gBAAK;gBAAM;aAAE;QAC5B;IACF;IACA,MAAM;QACJ,SAAS;QACT,GAAG,CAAC;QACJ,YAAY;YACV,UAAU;YACV,MAAM;gBAAC;gBAAM;gBAAK;gBAAM;aAAE;QAC5B;IACF;AACF;AAEO,SAAS,eAAe,EAAE,QAAQ,EAAE,SAAS,EAAuB;IACzE,MAAM,WAAW,IAAA,4LAAW;IAE5B,qBACE,yRAAC,uPAAe;QAAC,MAAK;QAAO,SAAS;kBACpC,cAAA,yRAAC,+OAAM,CAAC,GAAG;YAET,SAAQ;YACR,SAAQ;YACR,MAAK;YACL,UAAU;YACV,WAAW;sBAEV;WAPI;;;;;;;;;;AAWb;AAGO,SAAS,OAAO,EACrB,QAAQ,EACR,SAAS,EACT,QAAQ,CAAC,EACT,WAAW,GAAG,EAMf;IACC,qBACE,yRAAC,+OAAM,CAAC,GAAG;QACT,SAAS;YAAE,SAAS;YAAG,GAAG;QAAE;QAC5B,SAAS;YAAE,SAAS;YAAG,GAAG;QAAE;QAC5B,YAAY;YACV;YACA;YACA,MAAM;gBAAC;gBAAM;gBAAK;gBAAM;aAAE;QAC5B;QACA,WAAW;kBAEV;;;;;;AAGP"}},
    {"offset": {"line": 1635, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/ToolProvider.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  createContext,\n  useContext,\n  useState,\n  useCallback,\n  type ReactNode,\n} from \"react\";\nimport type { ToolType } from \"./shared/types\";\n\ninterface ToolContextValue {\n  activeTool: ToolType | null;\n  openTool: (tool: ToolType) => void;\n  closeTool: () => void;\n}\n\nconst ToolContext = createContext<ToolContextValue | null>(null);\n\nexport function ToolProvider({ children }: { children: ReactNode }) {\n  const [activeTool, setActiveTool] = useState<ToolType | null>(null);\n\n  const openTool = useCallback((tool: ToolType) => {\n    setActiveTool(tool);\n  }, []);\n\n  const closeTool = useCallback(() => {\n    setActiveTool(null);\n  }, []);\n\n  return (\n    <ToolContext.Provider value={{ activeTool, openTool, closeTool }}>\n      {children}\n    </ToolContext.Provider>\n  );\n}\n\nexport function useTools() {\n  const context = useContext(ToolContext);\n  if (!context) {\n    throw new Error(\"useTools must be used within a ToolProvider\");\n  }\n  return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AAFA;;;AAiBA,MAAM,4BAAc,IAAA,iQAAa,EAA0B;AAEpD,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,4PAAQ,EAAkB;IAE9D,MAAM,WAAW,IAAA,+PAAW,EAAC,CAAC;QAC5B,cAAc;IAChB,GAAG,EAAE;IAEL,MAAM,YAAY,IAAA,+PAAW,EAAC;QAC5B,cAAc;IAChB,GAAG,EAAE;IAEL,qBACE,yRAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAY;YAAU;QAAU;kBAC5D;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,UAAU,IAAA,8PAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 1679, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/shared/types.ts"],"sourcesContent":["export type ToolType =\n  | \"allabolag\"\n  | \"bolagsverket\"\n  | \"vinnova\"\n  | \"kungorelser\"\n  | \"rss\";\n\nexport type ToolStatus = \"idle\" | \"running\" | \"success\" | \"error\";\n\nexport type LogEntryType = \"info\" | \"success\" | \"warning\" | \"error\";\n\nexport interface LogEntry {\n  id: string;\n  timestamp: Date;\n  message: string;\n  type: LogEntryType;\n}\n\nexport interface ToolTab {\n  id: string;\n  label: string;\n  icon?: React.ReactNode;\n}\n\nexport interface ToolConfig {\n  id: ToolType;\n  name: string;\n  description: string;\n  shortcut?: string;\n}\n\nexport const TOOL_CONFIGS: Record<ToolType, ToolConfig> = {\n  allabolag: {\n    id: \"allabolag\",\n    name: \"Allabolag\",\n    description: \"Scrapa bolagsdata\",\n    shortcut: \"A\",\n  },\n  bolagsverket: {\n    id: \"bolagsverket\",\n    name: \"Bolagsverket\",\n    description: \"Officiell bolagsinfo\",\n    shortcut: \"B\",\n  },\n  vinnova: {\n    id: \"vinnova\",\n    name: \"Vinnova\",\n    description: \"Projektfinansiering\",\n    shortcut: \"V\",\n  },\n  kungorelser: {\n    id: \"kungorelser\",\n    name: \"Kungörelser\",\n    description: \"Konkurs & likvidation\",\n    shortcut: \"K\",\n  },\n  rss: {\n    id: \"rss\",\n    name: \"RSS-hanterare\",\n    description: \"Hantera nyhetsflöden\",\n    shortcut: \"R\",\n  },\n};\n"],"names":[],"mappings":";;;;AA+BO,MAAM,eAA6C;IACxD,WAAW;QACT,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;IACZ;IACA,cAAc;QACZ,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;IACZ;IACA,SAAS;QACP,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;IACZ;IACA,aAAa;QACX,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;IACZ;IACA,KAAK;QACH,IAAI;QACJ,MAAM;QACN,aAAa;QACb,UAAU;IACZ;AACF"}},
    {"offset": {"line": 1719, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/shared/ToolPanel.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useCallback } from \"react\";\nimport { X } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport type { ToolType } from \"./types\";\n\ninterface ToolPanelProps {\n  tool: ToolType;\n  title: string;\n  icon: React.ReactNode;\n  isOpen: boolean;\n  onClose: () => void;\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport function ToolPanel({\n  tool,\n  title,\n  icon,\n  isOpen,\n  onClose,\n  children,\n  className,\n}: ToolPanelProps) {\n  // Close on Escape key\n  const handleKeyDown = useCallback(\n    (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") {\n        onClose();\n      }\n    },\n    [onClose]\n  );\n\n  useEffect(() => {\n    if (isOpen) {\n      document.addEventListener(\"keydown\", handleKeyDown);\n      document.body.style.overflow = \"hidden\";\n    }\n    return () => {\n      document.removeEventListener(\"keydown\", handleKeyDown);\n      document.body.style.overflow = \"\";\n    };\n  }, [isOpen, handleKeyDown]);\n\n  if (!isOpen) return null;\n\n  return (\n    <>\n      {/* Backdrop */}\n      <div className=\"tool-panel-backdrop\" onClick={onClose} />\n\n      {/* Panel */}\n      <div className={cn(\"tool-panel\", className)}>\n        {/* Header */}\n        <div className=\"tool-header\">\n          <div className=\"tool-header-title\">\n            <div className=\"tool-header-icon\" data-tool={tool}>\n              {icon}\n            </div>\n            <span>{title}</span>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"btn-ghost p-2 rounded-lg\"\n            aria-label=\"Stäng\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        {children}\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAiBO,SAAS,UAAU,EACxB,IAAI,EACJ,KAAK,EACL,IAAI,EACJ,MAAM,EACN,OAAO,EACP,QAAQ,EACR,SAAS,EACM;IACf,sBAAsB;IACtB,MAAM,gBAAgB,IAAA,+PAAW,EAC/B,CAAC;QACC,IAAI,EAAE,GAAG,KAAK,UAAU;YACtB;QACF;IACF,GACA;QAAC;KAAQ;IAGX,IAAA,6PAAS,EAAC;QACR,IAAI,QAAQ;YACV,SAAS,gBAAgB,CAAC,WAAW;YACrC,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;QACjC;QACA,OAAO;YACL,SAAS,mBAAmB,CAAC,WAAW;YACxC,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;QACjC;IACF,GAAG;QAAC;QAAQ;KAAc;IAE1B,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACE;;0BAEE,yRAAC;gBAAI,WAAU;gBAAsB,SAAS;;;;;;0BAG9C,yRAAC;gBAAI,WAAW,IAAA,oKAAE,EAAC,cAAc;;kCAE/B,yRAAC;wBAAI,WAAU;;0CACb,yRAAC;gCAAI,WAAU;;kDACb,yRAAC;wCAAI,WAAU;wCAAmB,aAAW;kDAC1C;;;;;;kDAEH,yRAAC;kDAAM;;;;;;;;;;;;0CAET,yRAAC;gCACC,SAAS;gCACT,WAAU;gCACV,cAAW;0CAEX,cAAA,yRAAC,4OAAC;oCAAC,WAAU;;;;;;;;;;;;;;;;;oBAKhB;;;;;;;;;AAIT"}},
    {"offset": {"line": 1832, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/shared/ToolTabs.tsx"],"sourcesContent":["\"use client\";\n\nimport { cn } from \"@/lib/utils\";\nimport type { ToolType, ToolTab } from \"./types\";\n\ninterface ToolTabsProps {\n  tool: ToolType;\n  tabs: ToolTab[];\n  activeTab: string;\n  onTabChange: (tabId: string) => void;\n  className?: string;\n}\n\nexport function ToolTabs({\n  tool,\n  tabs,\n  activeTab,\n  onTabChange,\n  className,\n}: ToolTabsProps) {\n  return (\n    <div className={cn(\"tool-tabs\", className)}>\n      {tabs.map((tab) => (\n        <button\n          key={tab.id}\n          className=\"tool-tab\"\n          data-tool={tool}\n          data-active={activeTab === tab.id}\n          onClick={() => onTabChange(tab.id)}\n        >\n          {tab.icon && <span className=\"mr-1.5\">{tab.icon}</span>}\n          {tab.label}\n        </button>\n      ))}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAaO,SAAS,SAAS,EACvB,IAAI,EACJ,IAAI,EACJ,SAAS,EACT,WAAW,EACX,SAAS,EACK;IACd,qBACE,yRAAC;QAAI,WAAW,IAAA,oKAAE,EAAC,aAAa;kBAC7B,KAAK,GAAG,CAAC,CAAC,oBACT,yRAAC;gBAEC,WAAU;gBACV,aAAW;gBACX,eAAa,cAAc,IAAI,EAAE;gBACjC,SAAS,IAAM,YAAY,IAAI,EAAE;;oBAEhC,IAAI,IAAI,kBAAI,yRAAC;wBAAK,WAAU;kCAAU,IAAI,IAAI;;;;;;oBAC9C,IAAI,KAAK;;eAPL,IAAI,EAAE;;;;;;;;;;AAYrB"}},
    {"offset": {"line": 1875, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/shared/LogPanel.tsx"],"sourcesContent":["\"use client\";\n\nimport { useRef, useEffect, useState, useCallback } from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport type { LogEntry } from \"./types\";\n\ninterface LogPanelProps {\n  entries: LogEntry[];\n  maxHeight?: number;\n  autoScroll?: boolean;\n  className?: string;\n}\n\nfunction formatTime(date: Date): string {\n  return date.toLocaleTimeString(\"sv-SE\", {\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n  });\n}\n\nexport function LogPanel({\n  entries,\n  maxHeight = 200,\n  autoScroll = true,\n  className,\n}: LogPanelProps) {\n  const scrollRef = useRef<HTMLDivElement>(null);\n\n  // Auto-scroll to bottom on new entries\n  useEffect(() => {\n    if (autoScroll && scrollRef.current) {\n      scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n    }\n  }, [entries, autoScroll]);\n\n  if (entries.length === 0) {\n    return (\n      <div\n        className={cn(\"tool-log\", className)}\n        style={{ maxHeight }}\n      >\n        <div className=\"tool-log-entry\">\n          <span className=\"tool-log-message text-muted-foreground\">\n            Ingen aktivitet än...\n          </span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      ref={scrollRef}\n      className={cn(\"tool-log dark-scrollbar\", className)}\n      style={{ maxHeight }}\n    >\n      {entries.map((entry) => (\n        <div key={entry.id} className=\"tool-log-entry\" data-type={entry.type}>\n          <span className=\"tool-log-time\">{formatTime(entry.timestamp)}</span>\n          <span className=\"tool-log-message\">{entry.message}</span>\n        </div>\n      ))}\n    </div>\n  );\n}\n\n// Helper hook for managing log entries\nexport function useLogEntries(maxEntries = 100) {\n  const [entries, setEntries] = useState<LogEntry[]>([]);\n  const idRef = useRef(0);\n\n  const addEntry = useCallback((\n    message: string,\n    type: LogEntry[\"type\"] = \"info\"\n  ): LogEntry => {\n    const entry: LogEntry = {\n      id: `log-${++idRef.current}`,\n      timestamp: new Date(),\n      message,\n      type,\n    };\n\n    setEntries(prev => [...prev.slice(-maxEntries + 1), entry]);\n    return entry;\n  }, [maxEntries]);\n\n  const clearEntries = useCallback(() => {\n    setEntries([]);\n  }, []);\n\n  return {\n    entries,\n    addEntry,\n    clearEntries,\n    log: useCallback((message: string) => addEntry(message, \"info\"), [addEntry]),\n    success: useCallback((message: string) => addEntry(message, \"success\"), [addEntry]),\n    warning: useCallback((message: string) => addEntry(message, \"warning\"), [addEntry]),\n    error: useCallback((message: string) => addEntry(message, \"error\"), [addEntry]),\n  };\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAHA;;;;AAaA,SAAS,WAAW,IAAU;IAC5B,OAAO,KAAK,kBAAkB,CAAC,SAAS;QACtC,MAAM;QACN,QAAQ;QACR,QAAQ;IACV;AACF;AAEO,SAAS,SAAS,EACvB,OAAO,EACP,YAAY,GAAG,EACf,aAAa,IAAI,EACjB,SAAS,EACK;IACd,MAAM,YAAY,IAAA,0PAAM,EAAiB;IAEzC,uCAAuC;IACvC,IAAA,6PAAS,EAAC;QACR,IAAI,cAAc,UAAU,OAAO,EAAE;YACnC,UAAU,OAAO,CAAC,SAAS,GAAG,UAAU,OAAO,CAAC,YAAY;QAC9D;IACF,GAAG;QAAC;QAAS;KAAW;IAExB,IAAI,QAAQ,MAAM,KAAK,GAAG;QACxB,qBACE,yRAAC;YACC,WAAW,IAAA,oKAAE,EAAC,YAAY;YAC1B,OAAO;gBAAE;YAAU;sBAEnB,cAAA,yRAAC;gBAAI,WAAU;0BACb,cAAA,yRAAC;oBAAK,WAAU;8BAAyC;;;;;;;;;;;;;;;;IAMjE;IAEA,qBACE,yRAAC;QACC,KAAK;QACL,WAAW,IAAA,oKAAE,EAAC,2BAA2B;QACzC,OAAO;YAAE;QAAU;kBAElB,QAAQ,GAAG,CAAC,CAAC,sBACZ,yRAAC;gBAAmB,WAAU;gBAAiB,aAAW,MAAM,IAAI;;kCAClE,yRAAC;wBAAK,WAAU;kCAAiB,WAAW,MAAM,SAAS;;;;;;kCAC3D,yRAAC;wBAAK,WAAU;kCAAoB,MAAM,OAAO;;;;;;;eAFzC,MAAM,EAAE;;;;;;;;;;AAO1B;AAGO,SAAS,cAAc,aAAa,GAAG;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,4PAAQ,EAAa,EAAE;IACrD,MAAM,QAAQ,IAAA,0PAAM,EAAC;IAErB,MAAM,WAAW,IAAA,+PAAW,EAAC,CAC3B,SACA,OAAyB,MAAM;QAE/B,MAAM,QAAkB;YACtB,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,OAAO,EAAE;YAC5B,WAAW,IAAI;YACf;YACA;QACF;QAEA,WAAW,CAAA,OAAQ;mBAAI,KAAK,KAAK,CAAC,CAAC,aAAa;gBAAI;aAAM;QAC1D,OAAO;IACT,GAAG;QAAC;KAAW;IAEf,MAAM,eAAe,IAAA,+PAAW,EAAC;QAC/B,WAAW,EAAE;IACf,GAAG,EAAE;IAEL,OAAO;QACL;QACA;QACA;QACA,KAAK,IAAA,+PAAW,EAAC,CAAC,UAAoB,SAAS,SAAS,SAAS;YAAC;SAAS;QAC3E,SAAS,IAAA,+PAAW,EAAC,CAAC,UAAoB,SAAS,SAAS,YAAY;YAAC;SAAS;QAClF,SAAS,IAAA,+PAAW,EAAC,CAAC,UAAoB,SAAS,SAAS,YAAY;YAAC;SAAS;QAClF,OAAO,IAAA,+PAAW,EAAC,CAAC,UAAoB,SAAS,SAAS,UAAU;YAAC;SAAS;IAChF;AACF"}},
    {"offset": {"line": 2014, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/shared/ProgressBar.tsx"],"sourcesContent":["\"use client\";\n\nimport { cn } from \"@/lib/utils\";\nimport type { ToolType } from \"./types\";\n\ninterface ProgressBarProps {\n  tool: ToolType;\n  progress: number; // 0-100\n  showLabel?: boolean;\n  className?: string;\n}\n\nexport function ProgressBar({\n  tool,\n  progress,\n  showLabel = false,\n  className,\n}: ProgressBarProps) {\n  const clampedProgress = Math.min(100, Math.max(0, progress));\n\n  return (\n    <div className={cn(\"space-y-1\", className)}>\n      {showLabel && (\n        <div className=\"flex justify-between text-xs text-muted-foreground\">\n          <span>Framsteg</span>\n          <span className=\"font-mono\">{Math.round(clampedProgress)}%</span>\n        </div>\n      )}\n      <div className=\"tool-progress\">\n        <div\n          className=\"tool-progress-bar\"\n          data-tool={tool}\n          style={{ width: `${clampedProgress}%` }}\n        />\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAYO,SAAS,YAAY,EAC1B,IAAI,EACJ,QAAQ,EACR,YAAY,KAAK,EACjB,SAAS,EACQ;IACjB,MAAM,kBAAkB,KAAK,GAAG,CAAC,KAAK,KAAK,GAAG,CAAC,GAAG;IAElD,qBACE,yRAAC;QAAI,WAAW,IAAA,oKAAE,EAAC,aAAa;;YAC7B,2BACC,yRAAC;gBAAI,WAAU;;kCACb,yRAAC;kCAAK;;;;;;kCACN,yRAAC;wBAAK,WAAU;;4BAAa,KAAK,KAAK,CAAC;4BAAiB;;;;;;;;;;;;;0BAG7D,yRAAC;gBAAI,WAAU;0BACb,cAAA,yRAAC;oBACC,WAAU;oBACV,aAAW;oBACX,OAAO;wBAAE,OAAO,GAAG,gBAAgB,CAAC,CAAC;oBAAC;;;;;;;;;;;;;;;;;AAKhD"}},
    {"offset": {"line": 2084, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/shared/StatusBadge.tsx"],"sourcesContent":["\"use client\";\n\nimport { cn } from \"@/lib/utils\";\nimport type { ToolStatus } from \"./types\";\n\ninterface StatusBadgeProps {\n  status: ToolStatus;\n  className?: string;\n}\n\nconst STATUS_LABELS: Record<ToolStatus, string> = {\n  idle: \"Vilande\",\n  running: \"Kör\",\n  success: \"Klar\",\n  error: \"Fel\",\n};\n\nexport function StatusBadge({ status, className }: StatusBadgeProps) {\n  return (\n    <div className={cn(\"tool-status\", className)} data-status={status}>\n      <span className=\"tool-status-dot\" />\n      <span>{STATUS_LABELS[status]}</span>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAUA,MAAM,gBAA4C;IAChD,MAAM;IACN,SAAS;IACT,SAAS;IACT,OAAO;AACT;AAEO,SAAS,YAAY,EAAE,MAAM,EAAE,SAAS,EAAoB;IACjE,qBACE,yRAAC;QAAI,WAAW,IAAA,oKAAE,EAAC,eAAe;QAAY,eAAa;;0BACzD,yRAAC;gBAAK,WAAU;;;;;;0BAChB,yRAAC;0BAAM,aAAa,CAAC,OAAO;;;;;;;;;;;;AAGlC"}},
    {"offset": {"line": 2129, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/shared/ToolMenu.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  Building2,\n  FileSearch,\n  Lightbulb,\n  ScrollText,\n  Rss,\n} from \"lucide-react\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Button } from \"@/components/ui/button\";\nimport { Settings2 } from \"lucide-react\";\nimport { TOOL_CONFIGS, type ToolType } from \"./types\";\n\ninterface ToolMenuProps {\n  onSelectTool: (tool: ToolType) => void;\n}\n\nconst TOOL_ICONS: Record<ToolType, React.ReactNode> = {\n  allabolag: <Building2 className=\"w-4 h-4\" />,\n  bolagsverket: <FileSearch className=\"w-4 h-4\" />,\n  vinnova: <Lightbulb className=\"w-4 h-4\" />,\n  kungorelser: <ScrollText className=\"w-4 h-4\" />,\n  rss: <Rss className=\"w-4 h-4\" />,\n};\n\nconst TOOL_ORDER: ToolType[] = [\n  \"allabolag\",\n  \"bolagsverket\",\n  \"kungorelser\",\n  \"vinnova\",\n  \"rss\",\n];\n\nexport function ToolMenu({ onSelectTool }: ToolMenuProps) {\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"ghost\" size=\"sm\" className=\"gap-2\">\n          <Settings2 className=\"w-4 h-4\" />\n          <span className=\"hidden sm:inline\">Verktyg</span>\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent\n        align=\"end\"\n        className=\"glass shadow-xl animate-in fade-in slide-in-from-top-2 duration-200\"\n        sideOffset={8}\n      >\n        <div className=\"tool-menu\">\n          {TOOL_ORDER.map((toolId) => {\n            const config = TOOL_CONFIGS[toolId];\n            return (\n              <button\n                key={toolId}\n                className=\"tool-menu-item\"\n                onClick={() => onSelectTool(toolId)}\n              >\n                <div className=\"tool-menu-icon\" data-tool={toolId}>\n                  {TOOL_ICONS[toolId]}\n                </div>\n                <div className=\"tool-menu-label\">\n                  <div className=\"font-medium\">{config.name}</div>\n                  <div className=\"text-xs text-muted-foreground\">\n                    {config.description}\n                  </div>\n                </div>\n                {config.shortcut && (\n                  <span className=\"tool-menu-shortcut\">\n                    {\"\\u2318\"}{config.shortcut}\n                  </span>\n                )}\n              </button>\n            );\n          })}\n        </div>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAOA;AAKA;AACA;AACA;AAhBA;;;;;;;AAsBA,MAAM,aAAgD;IACpD,yBAAW,yRAAC,wQAAS;QAAC,WAAU;;;;;;IAChC,4BAAc,yRAAC,2QAAU;QAAC,WAAU;;;;;;IACpC,uBAAS,yRAAC,oQAAS;QAAC,WAAU;;;;;;IAC9B,2BAAa,yRAAC,2QAAU;QAAC,WAAU;;;;;;IACnC,mBAAK,yRAAC,kPAAG;QAAC,WAAU;;;;;;AACtB;AAEA,MAAM,aAAyB;IAC7B;IACA;IACA;IACA;IACA;CACD;AAEM,SAAS,SAAS,EAAE,YAAY,EAAiB;IACtD,qBACE,yRAAC,uMAAY;;0BACX,yRAAC,8MAAmB;gBAAC,OAAO;0BAC1B,cAAA,yRAAC,uLAAM;oBAAC,SAAQ;oBAAQ,MAAK;oBAAK,WAAU;;sCAC1C,yRAAC,wQAAS;4BAAC,WAAU;;;;;;sCACrB,yRAAC;4BAAK,WAAU;sCAAmB;;;;;;;;;;;;;;;;;0BAGvC,yRAAC,8MAAmB;gBAClB,OAAM;gBACN,WAAU;gBACV,YAAY;0BAEZ,cAAA,yRAAC;oBAAI,WAAU;8BACZ,WAAW,GAAG,CAAC,CAAC;wBACf,MAAM,SAAS,wMAAY,CAAC,OAAO;wBACnC,qBACE,yRAAC;4BAEC,WAAU;4BACV,SAAS,IAAM,aAAa;;8CAE5B,yRAAC;oCAAI,WAAU;oCAAiB,aAAW;8CACxC,UAAU,CAAC,OAAO;;;;;;8CAErB,yRAAC;oCAAI,WAAU;;sDACb,yRAAC;4CAAI,WAAU;sDAAe,OAAO,IAAI;;;;;;sDACzC,yRAAC;4CAAI,WAAU;sDACZ,OAAO,WAAW;;;;;;;;;;;;gCAGtB,OAAO,QAAQ,kBACd,yRAAC;oCAAK,WAAU;;wCACb;wCAAU,OAAO,QAAQ;;;;;;;;2BAfzB;;;;;oBAoBX;;;;;;;;;;;;;;;;;AAKV"}},
    {"offset": {"line": 2315, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/shared/index.ts"],"sourcesContent":["export * from \"./types\";\nexport * from \"./ToolPanel\";\nexport * from \"./ToolTabs\";\nexport * from \"./LogPanel\";\nexport * from \"./ProgressBar\";\nexport * from \"./StatusBadge\";\nexport * from \"./ToolMenu\";\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 2334, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/allabolag/AllabolagTool.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback, useRef } from \"react\";\nimport { Building2, Search, Clock, Activity, ExternalLink, Loader2 } from \"lucide-react\";\nimport { ToolPanel, ToolTabs, LogPanel, ProgressBar, StatusBadge } from \"../shared\";\nimport type { ToolTab, LogEntry, ToolStatus } from \"../shared/types\";\nimport { formatOrgNr } from \"@/lib/utils\";\n\ninterface AllabolagToolProps {\n  onClose: () => void;\n}\n\ninterface SearchResult {\n  orgnr: string;\n  name: string;\n  companyType?: string;\n  status?: string;\n  location?: string;\n}\n\ninterface CompanyData {\n  basic: {\n    orgNr: string;\n    name: string;\n    legalName?: string;\n    companyType?: { name: string };\n    status?: { active: boolean; status: string };\n  };\n  financials?: {\n    revenue?: string;\n    profit?: string;\n    employees?: string;\n  };\n  contact?: {\n    website?: string;\n  };\n}\n\nconst TABS: ToolTab[] = [\n  { id: \"search\", label: \"Sök\", icon: <Search className=\"w-3.5 h-3.5\" /> },\n  { id: \"history\", label: \"Historik\", icon: <Clock className=\"w-3.5 h-3.5\" /> },\n  { id: \"status\", label: \"Status\", icon: <Activity className=\"w-3.5 h-3.5\" /> },\n];\n\nexport function AllabolagTool({ onClose }: AllabolagToolProps) {\n  const [activeTab, setActiveTab] = useState(\"search\");\n  const [status, setStatus] = useState<ToolStatus>(\"idle\");\n  const [progress, setProgress] = useState(0);\n  const [logs, setLogs] = useState<LogEntry[]>([]);\n  const [query, setQuery] = useState(\"\");\n  const [searchResults, setSearchResults] = useState<SearchResult[]>([]);\n  const [selectedCompany, setSelectedCompany] = useState<CompanyData | null>(null);\n  const [searchHistory, setSearchHistory] = useState<SearchResult[]>([]);\n  const logIdRef = useRef(0);\n\n  const addLog = useCallback((message: string, type: LogEntry[\"type\"] = \"info\") => {\n    const entry: LogEntry = {\n      id: `log-${++logIdRef.current}`,\n      timestamp: new Date(),\n      message,\n      type,\n    };\n    setLogs((prev) => [...prev.slice(-99), entry]);\n    return entry;\n  }, []);\n\n  const handleSearch = async () => {\n    if (!query.trim() || query.trim().length < 2) return;\n\n    setStatus(\"running\");\n    setProgress(10);\n    setSearchResults([]);\n    setSelectedCompany(null);\n    addLog(`Söker efter \"${query}\"...`, \"info\");\n\n    try {\n      setProgress(30);\n      const response = await fetch(`/api/bolag/search?q=${encodeURIComponent(query.trim())}`);\n\n      if (!response.ok) {\n        throw new Error(`API returned ${response.status}`);\n      }\n\n      const data = await response.json();\n      setProgress(80);\n\n      if (data.results && data.results.length > 0) {\n        setSearchResults(data.results);\n        addLog(`Hittade ${data.results.length} företag`, \"success\");\n      } else {\n        addLog(\"Inga resultat hittades\", \"warning\");\n      }\n\n      setProgress(100);\n      setStatus(\"success\");\n    } catch (error) {\n      addLog(`Fel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n      setStatus(\"error\");\n    }\n\n    setTimeout(() => setProgress(0), 1000);\n  };\n\n  const handleSelectCompany = async (result: SearchResult) => {\n    setStatus(\"running\");\n    setProgress(20);\n    addLog(`Hämtar detaljer för ${result.name}...`, \"info\");\n\n    // Add to history\n    setSearchHistory((prev) => {\n      const exists = prev.find((r) => r.orgnr === result.orgnr);\n      if (exists) return prev;\n      return [result, ...prev.slice(0, 9)];\n    });\n\n    try {\n      setProgress(50);\n      const response = await fetch(`/api/bolag/company/${result.orgnr}`);\n\n      if (!response.ok) {\n        throw new Error(`API returned ${response.status}`);\n      }\n\n      const data = await response.json();\n      setProgress(90);\n      setSelectedCompany(data);\n      addLog(`Hämtade data för ${result.name}`, \"success\");\n      setProgress(100);\n      setStatus(\"success\");\n    } catch (error) {\n      addLog(`Fel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n      setStatus(\"error\");\n    }\n\n    setTimeout(() => setProgress(0), 1000);\n  };\n\n  return (\n    <ToolPanel\n      tool=\"allabolag\"\n      title=\"Allabolag Scraper\"\n      icon={<Building2 className=\"w-5 h-5\" />}\n      isOpen={true}\n      onClose={onClose}\n    >\n      <ToolTabs\n        tool=\"allabolag\"\n        tabs={TABS}\n        activeTab={activeTab}\n        onTabChange={setActiveTab}\n      />\n\n      <div className=\"tool-content space-y-4\">\n        {activeTab === \"search\" && (\n          <>\n            {/* Search input */}\n            <div className=\"space-y-3\">\n              <label className=\"text-label\">Sök bolag</label>\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Org.nummer eller bolagsnamn...\"\n                  value={query}\n                  onChange={(e) => setQuery(e.target.value)}\n                  onKeyDown={(e) => e.key === \"Enter\" && handleSearch()}\n                  className=\"flex-1 px-3 py-2 bg-secondary border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-ring\"\n                />\n                <button\n                  onClick={handleSearch}\n                  disabled={status === \"running\"}\n                  className=\"btn-primary px-4\"\n                >\n                  {status === \"running\" ? (\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  ) : (\n                    <Search className=\"w-4 h-4\" />\n                  )}\n                </button>\n              </div>\n            </div>\n\n            {/* Status and progress */}\n            <div className=\"flex items-center justify-between\">\n              <StatusBadge status={status} />\n              {progress > 0 && (\n                <span className=\"text-xs text-muted-foreground font-mono\">\n                  {progress}%\n                </span>\n              )}\n            </div>\n\n            {progress > 0 && (\n              <ProgressBar tool=\"allabolag\" progress={progress} />\n            )}\n\n            {/* Search results */}\n            {searchResults.length > 0 && !selectedCompany && (\n              <div className=\"space-y-2\">\n                <label className=\"text-label\">Sökresultat ({searchResults.length})</label>\n                <div className=\"space-y-1 max-h-64 overflow-y-auto\">\n                  {searchResults.map((result) => (\n                    <button\n                      key={result.orgnr}\n                      onClick={() => handleSelectCompany(result)}\n                      className=\"w-full text-left p-3 rounded-lg border border-border hover:bg-secondary transition-colors\"\n                    >\n                      <div className=\"font-medium text-sm\">{result.name}</div>\n                      <div className=\"flex items-center gap-2 text-xs text-muted-foreground mt-1\">\n                        <span className=\"font-mono\">{formatOrgNr(result.orgnr)}</span>\n                        {result.companyType && (\n                          <>\n                            <span>•</span>\n                            <span>{result.companyType}</span>\n                          </>\n                        )}\n                        {result.location && (\n                          <>\n                            <span>•</span>\n                            <span>{result.location}</span>\n                          </>\n                        )}\n                      </div>\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Selected company details */}\n            {selectedCompany && (\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <label className=\"text-label\">Bolagsdetaljer</label>\n                  <button\n                    onClick={() => setSelectedCompany(null)}\n                    className=\"text-xs text-muted-foreground hover:text-foreground\"\n                  >\n                    Tillbaka\n                  </button>\n                </div>\n                <div className=\"p-4 rounded-lg border border-border bg-secondary/50 space-y-3\">\n                  <div>\n                    <div className=\"font-semibold\">{selectedCompany.basic.name}</div>\n                    {selectedCompany.basic.legalName && selectedCompany.basic.legalName !== selectedCompany.basic.name && (\n                      <div className=\"text-sm text-muted-foreground\">{selectedCompany.basic.legalName}</div>\n                    )}\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                    <div>\n                      <span className=\"text-muted-foreground\">Org.nr:</span>{\" \"}\n                      <span className=\"font-mono\">{formatOrgNr(selectedCompany.basic.orgNr)}</span>\n                    </div>\n                    {selectedCompany.basic.companyType && (\n                      <div>\n                        <span className=\"text-muted-foreground\">Typ:</span>{\" \"}\n                        {selectedCompany.basic.companyType.name}\n                      </div>\n                    )}\n                    {selectedCompany.financials?.revenue && (\n                      <div>\n                        <span className=\"text-muted-foreground\">Omsättning:</span>{\" \"}\n                        {selectedCompany.financials.revenue}\n                      </div>\n                    )}\n                    {selectedCompany.financials?.employees && (\n                      <div>\n                        <span className=\"text-muted-foreground\">Anställda:</span>{\" \"}\n                        {selectedCompany.financials.employees}\n                      </div>\n                    )}\n                  </div>\n                  {selectedCompany.basic.status && (\n                    <div className={`text-sm ${selectedCompany.basic.status.active ? \"text-green-500\" : \"text-red-500\"}`}>\n                      Status: {selectedCompany.basic.status.status}\n                    </div>\n                  )}\n                  <a\n                    href={`https://www.allabolag.se/${selectedCompany.basic.orgNr.replace(\"-\", \"\")}`}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground\"\n                  >\n                    <ExternalLink className=\"w-3.5 h-3.5\" />\n                    Öppna på Allabolag\n                  </a>\n                </div>\n              </div>\n            )}\n          </>\n        )}\n\n        {activeTab === \"history\" && (\n          <div className=\"space-y-3\">\n            <label className=\"text-label\">Senaste sökningar</label>\n            {searchHistory.length === 0 ? (\n              <div className=\"empty-state py-8\">\n                <Clock className=\"empty-state-icon w-10 h-10\" />\n                <p className=\"empty-state-title text-sm\">Ingen historik</p>\n                <p className=\"empty-state-description text-xs\">\n                  Dina senaste sökningar visas här.\n                </p>\n              </div>\n            ) : (\n              <div className=\"space-y-1\">\n                {searchHistory.map((result) => (\n                  <button\n                    key={result.orgnr}\n                    onClick={() => {\n                      setActiveTab(\"search\");\n                      handleSelectCompany(result);\n                    }}\n                    className=\"w-full text-left p-3 rounded-lg border border-border hover:bg-secondary transition-colors\"\n                  >\n                    <div className=\"font-medium text-sm\">{result.name}</div>\n                    <div className=\"text-xs text-muted-foreground font-mono mt-1\">\n                      {formatOrgNr(result.orgnr)}\n                    </div>\n                  </button>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n\n        {activeTab === \"status\" && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm font-medium\">Aktivitetslogg</span>\n              <StatusBadge status={status} />\n            </div>\n            <LogPanel entries={logs} maxHeight={300} />\n          </div>\n        )}\n      </div>\n    </ToolPanel>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3030, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/bolagsverket/BolagsverketTool.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback, useRef } from \"react\";\nimport { FileSearch, Search, Activity, ExternalLink, Loader2, FileText, Download, Building2 } from \"lucide-react\";\nimport { ToolPanel, ToolTabs, LogPanel, ProgressBar, StatusBadge } from \"../shared\";\nimport type { ToolTab, LogEntry, ToolStatus } from \"../shared/types\";\nimport { formatOrgNr } from \"@/lib/utils\";\n\ninterface BolagsverketToolProps {\n  onClose: () => void;\n}\n\ninterface CompanyData {\n  basic: {\n    orgNr: string;\n    name: string;\n    companyType?: { code: string; name: string };\n    status?: { active: boolean; status: string; statusDate?: string };\n    registrationDate?: string;\n    purpose?: string;\n  };\n  postalAddress?: {\n    street?: string;\n    coAddress?: string;\n    zipCode?: string;\n    city?: string;\n    country?: string;\n  };\n  industries?: Array<{ code: string; name: string }>;\n  flags?: {\n    marketingProtection?: boolean;\n  };\n  sources?: {\n    bolagsverket?: boolean;\n  };\n}\n\ninterface AnnualReport {\n  dokumentId: string;\n  period: string;\n  date: string;\n  year: number | null;\n}\n\nconst TABS: ToolTab[] = [\n  { id: \"search\", label: \"Sök\", icon: <Search className=\"w-3.5 h-3.5\" /> },\n  { id: \"reports\", label: \"Årsredovisningar\", icon: <FileText className=\"w-3.5 h-3.5\" /> },\n  { id: \"status\", label: \"Status\", icon: <Activity className=\"w-3.5 h-3.5\" /> },\n];\n\nexport function BolagsverketTool({ onClose }: BolagsverketToolProps) {\n  const [activeTab, setActiveTab] = useState(\"search\");\n  const [status, setStatus] = useState<ToolStatus>(\"idle\");\n  const [progress, setProgress] = useState(0);\n  const [logs, setLogs] = useState<LogEntry[]>([]);\n  const [orgNr, setOrgNr] = useState(\"\");\n  const [companyData, setCompanyData] = useState<CompanyData | null>(null);\n  const [reports, setReports] = useState<AnnualReport[]>([]);\n  const [searchHistory, setSearchHistory] = useState<Array<{ orgNr: string; name: string }>>([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const [isLoadingReports, setIsLoadingReports] = useState(false);\n  const logIdRef = useRef(0);\n\n  const addLog = useCallback((message: string, type: LogEntry[\"type\"] = \"info\") => {\n    const entry: LogEntry = {\n      id: `log-${++logIdRef.current}`,\n      timestamp: new Date(),\n      message,\n      type,\n    };\n    setLogs((prev) => [...prev.slice(-99), entry]);\n    return entry;\n  }, []);\n\n  const cleanOrgNr = (input: string) => {\n    return input.replace(/[^0-9]/g, \"\");\n  };\n\n  const handleSearch = async () => {\n    const cleaned = cleanOrgNr(orgNr);\n    if (cleaned.length < 10) {\n      addLog(\"Ange ett giltigt organisationsnummer (10 siffror)\", \"warning\");\n      return;\n    }\n\n    setIsSearching(true);\n    setStatus(\"running\");\n    setProgress(10);\n    setCompanyData(null);\n    setReports([]);\n    addLog(`Söker i Bolagsverket för ${formatOrgNr(cleaned)}...`, \"info\");\n\n    try {\n      setProgress(30);\n      const response = await fetch(`/api/bolag/company/${cleaned}`);\n      setProgress(60);\n\n      if (!response.ok) {\n        if (response.status === 404) {\n          throw new Error(\"Företaget hittades inte\");\n        }\n        throw new Error(`API returned ${response.status}`);\n      }\n\n      const data = await response.json();\n      setProgress(90);\n\n      if (data.basic) {\n        setCompanyData(data);\n        addLog(`Hittade: ${data.basic.name}`, \"success\");\n\n        // Add to search history\n        setSearchHistory((prev) => {\n          const exists = prev.find((h) => h.orgNr === cleaned);\n          if (exists) return prev;\n          return [{ orgNr: cleaned, name: data.basic.name }, ...prev.slice(0, 9)];\n        });\n\n        // Check data source\n        if (data.sources?.bolagsverket) {\n          addLog(\"Data från Bolagsverkets officiella API\", \"info\");\n        }\n      } else {\n        addLog(\"Företaget hittades inte\", \"warning\");\n      }\n\n      setProgress(100);\n      setStatus(\"success\");\n    } catch (error) {\n      addLog(`Fel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n      setStatus(\"error\");\n    }\n\n    setIsSearching(false);\n    setTimeout(() => setProgress(0), 1000);\n  };\n\n  const loadAnnualReports = async () => {\n    if (!companyData?.basic.orgNr) {\n      addLog(\"Sök efter ett företag först\", \"warning\");\n      return;\n    }\n\n    setIsLoadingReports(true);\n    setStatus(\"running\");\n    setProgress(20);\n    addLog(`Hämtar årsredovisningar för ${companyData.basic.name}...`, \"info\");\n\n    try {\n      setProgress(50);\n      const response = await fetch(`/api/bolag/annual-reports?orgNr=${companyData.basic.orgNr}`);\n      setProgress(80);\n\n      if (!response.ok) {\n        throw new Error(`API returned ${response.status}`);\n      }\n\n      const data = await response.json();\n      setProgress(95);\n\n      if (data.reports && data.reports.length > 0) {\n        setReports(data.reports);\n        addLog(`Hittade ${data.reports.length} årsredovisningar`, \"success\");\n      } else {\n        addLog(\"Inga årsredovisningar hittades\", \"warning\");\n      }\n\n      setProgress(100);\n      setStatus(\"success\");\n    } catch (error) {\n      addLog(`Fel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n      setStatus(\"error\");\n    }\n\n    setIsLoadingReports(false);\n    setTimeout(() => setProgress(0), 1000);\n  };\n\n  const downloadReport = async (report: AnnualReport) => {\n    addLog(`Laddar ner årsredovisning ${report.year || report.period}...`, \"info\");\n\n    try {\n      const response = await fetch(`/api/bolag/annual-reports/${report.dokumentId}`);\n\n      if (!response.ok) {\n        throw new Error(`API returned ${response.status}`);\n      }\n\n      const blob = await response.blob();\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `arsredovisning-${companyData?.basic.orgNr}-${report.year || report.period}.zip`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n\n      addLog(`Nedladdning startad för ${report.year || report.period}`, \"success\");\n    } catch (error) {\n      addLog(`Fel vid nedladdning: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n    }\n  };\n\n  const formatDate = (dateStr?: string) => {\n    if (!dateStr) return \"-\";\n    try {\n      const date = new Date(dateStr);\n      return date.toLocaleDateString(\"sv-SE\");\n    } catch {\n      return dateStr;\n    }\n  };\n\n  return (\n    <ToolPanel\n      tool=\"bolagsverket\"\n      title=\"Bolagsverket API\"\n      icon={<FileSearch className=\"w-5 h-5\" />}\n      isOpen={true}\n      onClose={onClose}\n    >\n      <ToolTabs\n        tool=\"bolagsverket\"\n        tabs={TABS}\n        activeTab={activeTab}\n        onTabChange={setActiveTab}\n      />\n\n      <div className=\"tool-content space-y-4\">\n        {activeTab === \"search\" && (\n          <>\n            {/* Search input */}\n            <div className=\"space-y-3\">\n              <label className=\"text-label\">Organisationsnummer</label>\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"text\"\n                  placeholder=\"XXXXXX-XXXX\"\n                  value={orgNr}\n                  onChange={(e) => setOrgNr(e.target.value)}\n                  onKeyDown={(e) => e.key === \"Enter\" && handleSearch()}\n                  className=\"flex-1 px-3 py-2 bg-secondary border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-ring font-mono\"\n                />\n                <button\n                  onClick={handleSearch}\n                  disabled={isSearching}\n                  className=\"btn-primary px-4\"\n                >\n                  {isSearching ? (\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  ) : (\n                    <Search className=\"w-4 h-4\" />\n                  )}\n                </button>\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                Hämtar officiella uppgifter från Bolagsverkets API.\n              </p>\n            </div>\n\n            {/* Status and progress */}\n            <div className=\"flex items-center justify-between\">\n              <StatusBadge status={status} />\n              {progress > 0 && (\n                <span className=\"text-xs text-muted-foreground font-mono\">\n                  {progress}%\n                </span>\n              )}\n            </div>\n\n            {progress > 0 && (\n              <ProgressBar tool=\"bolagsverket\" progress={progress} />\n            )}\n\n            {/* Company data */}\n            {companyData && (\n              <div className=\"space-y-3\">\n                <label className=\"text-label\">Bolagsuppgifter</label>\n                <div className=\"p-4 rounded-lg border border-border bg-secondary/50 space-y-4\">\n                  {/* Header */}\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"p-2 rounded-lg bg-green-500/20\">\n                      <Building2 className=\"w-5 h-5 text-green-500\" />\n                    </div>\n                    <div className=\"flex-1\">\n                      <div className=\"font-semibold\">{companyData.basic.name}</div>\n                      <div className=\"text-xs text-muted-foreground font-mono\">\n                        {formatOrgNr(companyData.basic.orgNr)}\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Status */}\n                  {companyData.basic.status && (\n                    <div className={`text-sm ${\n                      companyData.basic.status.active\n                        ? \"text-green-500\"\n                        : \"text-red-500\"\n                    }`}>\n                      {companyData.basic.status.status}\n                      {companyData.basic.status.statusDate && (\n                        <span className=\"text-muted-foreground ml-2\">\n                          ({formatDate(companyData.basic.status.statusDate)})\n                        </span>\n                      )}\n                    </div>\n                  )}\n\n                  {/* Details grid */}\n                  <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                    {companyData.basic.companyType && (\n                      <div>\n                        <span className=\"text-muted-foreground\">Bolagsform:</span>{\" \"}\n                        {companyData.basic.companyType.name}\n                      </div>\n                    )}\n                    {companyData.basic.registrationDate && (\n                      <div>\n                        <span className=\"text-muted-foreground\">Registrerat:</span>{\" \"}\n                        {formatDate(companyData.basic.registrationDate)}\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Purpose */}\n                  {companyData.basic.purpose && (\n                    <div>\n                      <div className=\"text-xs text-muted-foreground mb-1\">Verksamhetsbeskrivning</div>\n                      <p className=\"text-sm line-clamp-3\">{companyData.basic.purpose}</p>\n                    </div>\n                  )}\n\n                  {/* Address */}\n                  {companyData.postalAddress && (\n                    <div>\n                      <div className=\"text-xs text-muted-foreground mb-1\">Adress</div>\n                      <div className=\"text-sm\">\n                        {companyData.postalAddress.street && (\n                          <div>{companyData.postalAddress.street}</div>\n                        )}\n                        {companyData.postalAddress.coAddress && (\n                          <div>c/o {companyData.postalAddress.coAddress}</div>\n                        )}\n                        <div>\n                          {companyData.postalAddress.zipCode} {companyData.postalAddress.city}\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Industries */}\n                  {companyData.industries && companyData.industries.length > 0 && (\n                    <div>\n                      <div className=\"text-xs text-muted-foreground mb-1\">\n                        Näringsgrenar (SNI)\n                      </div>\n                      <div className=\"space-y-1\">\n                        {companyData.industries.slice(0, 3).map((ind, i) => (\n                          <div key={i} className=\"text-sm flex items-baseline gap-2\">\n                            <span className=\"font-mono text-xs text-muted-foreground\">\n                              {ind.code}\n                            </span>\n                            <span>{ind.name}</span>\n                          </div>\n                        ))}\n                        {companyData.industries.length > 3 && (\n                          <div className=\"text-xs text-muted-foreground\">\n                            +{companyData.industries.length - 3} fler...\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Flags */}\n                  {companyData.flags?.marketingProtection && (\n                    <div className=\"text-xs text-amber-500\">\n                      Reklamsparr aktiverad\n                    </div>\n                  )}\n\n                  {/* Actions */}\n                  <div className=\"flex items-center gap-2 pt-2 border-t border-border\">\n                    <button\n                      onClick={() => {\n                        setActiveTab(\"reports\");\n                        loadAnnualReports();\n                      }}\n                      className=\"btn-secondary text-xs gap-1.5\"\n                    >\n                      <FileText className=\"w-3.5 h-3.5\" />\n                      Årsredovisningar\n                    </button>\n                    <a\n                      href={`https://bolagsverket.se/foretag/sok-foretag-registrerade-hos-bolagsverket`}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      className=\"btn-secondary text-xs gap-1.5\"\n                    >\n                      <ExternalLink className=\"w-3.5 h-3.5\" />\n                      Bolagsverket.se\n                    </a>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Search history */}\n            {searchHistory.length > 0 && !companyData && (\n              <div className=\"space-y-2\">\n                <label className=\"text-label text-xs\">Senaste sökningar</label>\n                <div className=\"space-y-1\">\n                  {searchHistory.map((h, i) => (\n                    <button\n                      key={i}\n                      onClick={() => {\n                        setOrgNr(h.orgNr);\n                      }}\n                      className=\"w-full text-left px-2 py-1.5 text-xs bg-secondary rounded hover:bg-secondary/80 flex items-center justify-between\"\n                    >\n                      <span className=\"truncate\">{h.name}</span>\n                      <span className=\"font-mono text-muted-foreground\">\n                        {formatOrgNr(h.orgNr)}\n                      </span>\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )}\n          </>\n        )}\n\n        {activeTab === \"reports\" && (\n          <>\n            {companyData ? (\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <div className=\"text-sm font-medium\">{companyData.basic.name}</div>\n                    <div className=\"text-xs text-muted-foreground font-mono\">\n                      {formatOrgNr(companyData.basic.orgNr)}\n                    </div>\n                  </div>\n                  <button\n                    onClick={loadAnnualReports}\n                    disabled={isLoadingReports}\n                    className=\"btn-secondary text-xs gap-1.5\"\n                  >\n                    {isLoadingReports ? (\n                      <Loader2 className=\"w-3.5 h-3.5 animate-spin\" />\n                    ) : (\n                      <FileText className=\"w-3.5 h-3.5\" />\n                    )}\n                    Hämta\n                  </button>\n                </div>\n\n                {progress > 0 && (\n                  <ProgressBar tool=\"bolagsverket\" progress={progress} />\n                )}\n\n                {reports.length > 0 ? (\n                  <div className=\"space-y-2\">\n                    <label className=\"text-label\">Årsredovisningar ({reports.length})</label>\n                    <div className=\"space-y-2 max-h-72 overflow-y-auto\">\n                      {reports.map((report) => (\n                        <div\n                          key={report.dokumentId}\n                          className=\"p-3 rounded-lg border border-border bg-secondary/50 flex items-center justify-between\"\n                        >\n                          <div>\n                            <div className=\"font-medium text-sm\">\n                              {report.year ? `År ${report.year}` : report.period}\n                            </div>\n                            <div className=\"text-xs text-muted-foreground\">\n                              Registrerad: {formatDate(report.date)}\n                            </div>\n                          </div>\n                          <button\n                            onClick={() => downloadReport(report)}\n                            className=\"btn-secondary text-xs gap-1.5\"\n                          >\n                            <Download className=\"w-3.5 h-3.5\" />\n                            Ladda ner\n                          </button>\n                        </div>\n                      ))}\n                    </div>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Årsredovisningar laddas ned som ZIP-filer med iXBRL-format.\n                    </p>\n                  </div>\n                ) : (\n                  <div className=\"empty-state py-8\">\n                    <FileText className=\"empty-state-icon w-10 h-10\" />\n                    <p className=\"empty-state-title text-sm\">Inga årsredovisningar</p>\n                    <p className=\"empty-state-description text-xs\">\n                      Klicka på &quot;Hämta&quot; för att ladda årsredovisningar.\n                    </p>\n                  </div>\n                )}\n              </div>\n            ) : (\n              <div className=\"empty-state py-8\">\n                <Building2 className=\"empty-state-icon w-10 h-10\" />\n                <p className=\"empty-state-title text-sm\">Inget företag valt</p>\n                <p className=\"empty-state-description text-xs\">\n                  Sök efter ett företag först för att se årsredovisningar.\n                </p>\n                <button\n                  onClick={() => setActiveTab(\"search\")}\n                  className=\"btn-primary text-xs mt-3\"\n                >\n                  <Search className=\"w-3.5 h-3.5\" />\n                  Gå till sök\n                </button>\n              </div>\n            )}\n          </>\n        )}\n\n        {activeTab === \"status\" && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm font-medium\">Aktivitetslogg</span>\n              <StatusBadge status={status} />\n            </div>\n            <LogPanel entries={logs} maxHeight={300} />\n          </div>\n        )}\n      </div>\n    </ToolPanel>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4065, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/vinnova/VinnovaTool.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback, useRef } from \"react\";\nimport { Lightbulb, Search, Activity, ExternalLink, Loader2, Calendar, Users, Coins } from \"lucide-react\";\nimport { ToolPanel, ToolTabs, LogPanel, ProgressBar, StatusBadge } from \"../shared\";\nimport type { ToolTab, LogEntry, ToolStatus } from \"../shared/types\";\nimport { formatOrgNr } from \"@/lib/utils\";\n\ninterface VinnovaToolProps {\n  onClose: () => void;\n}\n\ninterface VinnovaProject {\n  id: string;\n  diarienummer: string;\n  titel: string;\n  programnamn?: string;\n  startdatum?: string;\n  slutdatum?: string;\n  totalbudget?: number;\n  vinnovaBidrag?: number;\n  koordinator?: string;\n  koordinatorOrgNr?: string;\n  deltagare?: Array<{\n    namn: string;\n    orgNr?: string;\n    roll?: string;\n  }>;\n  status?: string;\n}\n\ninterface SearchResult {\n  companyName: string;\n  orgNr?: string;\n  projects: VinnovaProject[];\n}\n\nconst TABS: ToolTab[] = [\n  { id: \"search\", label: \"Sök\", icon: <Search className=\"w-3.5 h-3.5\" /> },\n  { id: \"status\", label: \"Status\", icon: <Activity className=\"w-3.5 h-3.5\" /> },\n];\n\nexport function VinnovaTool({ onClose }: VinnovaToolProps) {\n  const [activeTab, setActiveTab] = useState(\"search\");\n  const [status, setStatus] = useState<ToolStatus>(\"idle\");\n  const [progress, setProgress] = useState(0);\n  const [logs, setLogs] = useState<LogEntry[]>([]);\n  const [query, setQuery] = useState(\"\");\n  const [orgNr, setOrgNr] = useState(\"\");\n  const [searchResult, setSearchResult] = useState<SearchResult | null>(null);\n  const [selectedProject, setSelectedProject] = useState<VinnovaProject | null>(null);\n  const [searchHistory, setSearchHistory] = useState<Array<{ name: string; orgNr?: string }>>([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const logIdRef = useRef(0);\n\n  const addLog = useCallback((message: string, type: LogEntry[\"type\"] = \"info\") => {\n    const entry: LogEntry = {\n      id: `log-${++logIdRef.current}`,\n      timestamp: new Date(),\n      message,\n      type,\n    };\n    setLogs((prev) => [...prev.slice(-99), entry]);\n    return entry;\n  }, []);\n\n  const handleSearch = async () => {\n    if (!query.trim() && !orgNr.trim()) return;\n\n    setIsSearching(true);\n    setStatus(\"running\");\n    setProgress(10);\n    setSearchResult(null);\n    setSelectedProject(null);\n    addLog(`Söker Vinnova-projekt för \"${query || orgNr}\"...`, \"info\");\n\n    // Add to search history\n    setSearchHistory((prev) => {\n      const exists = prev.find((h) => h.name === query && h.orgNr === orgNr);\n      if (exists) return prev;\n      return [{ name: query, orgNr: orgNr || undefined }, ...prev.slice(0, 9)];\n    });\n\n    try {\n      setProgress(30);\n      const params = new URLSearchParams();\n      if (query.trim()) params.set(\"company\", query.trim());\n      if (orgNr.trim()) params.set(\"orgNr\", orgNr.trim().replace(/-/g, \"\"));\n\n      addLog(\"Anropar Vinnova API...\", \"info\");\n      const response = await fetch(`/api/bolag/vinnova?${params.toString()}`);\n      setProgress(70);\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || `API returned ${response.status}`);\n      }\n\n      const data = await response.json();\n      setProgress(90);\n\n      if (data.projects && data.projects.length > 0) {\n        setSearchResult({\n          companyName: query || orgNr,\n          orgNr: orgNr || undefined,\n          projects: data.projects,\n        });\n        addLog(`Hittade ${data.projects.length} Vinnova-projekt`, \"success\");\n      } else {\n        addLog(\"Inga Vinnova-projekt hittades\", \"warning\");\n      }\n\n      setProgress(100);\n      setStatus(\"success\");\n    } catch (error) {\n      addLog(`Fel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n      setStatus(\"error\");\n    }\n\n    setIsSearching(false);\n    setTimeout(() => setProgress(0), 1000);\n  };\n\n  const formatCurrency = (amount?: number) => {\n    if (!amount) return \"-\";\n    return new Intl.NumberFormat(\"sv-SE\", {\n      style: \"currency\",\n      currency: \"SEK\",\n      maximumFractionDigits: 0,\n    }).format(amount);\n  };\n\n  const formatDate = (dateStr?: string) => {\n    if (!dateStr) return \"-\";\n    try {\n      const date = new Date(dateStr);\n      return date.toLocaleDateString(\"sv-SE\");\n    } catch {\n      return dateStr;\n    }\n  };\n\n  return (\n    <ToolPanel\n      tool=\"vinnova\"\n      title=\"Vinnova Projekt\"\n      icon={<Lightbulb className=\"w-5 h-5\" />}\n      isOpen={true}\n      onClose={onClose}\n    >\n      <ToolTabs\n        tool=\"vinnova\"\n        tabs={TABS}\n        activeTab={activeTab}\n        onTabChange={setActiveTab}\n      />\n\n      <div className=\"tool-content space-y-4\">\n        {activeTab === \"search\" && (\n          <>\n            {/* Search inputs */}\n            <div className=\"space-y-3\">\n              <label className=\"text-label\">Sök Vinnova-projekt</label>\n              <input\n                type=\"text\"\n                placeholder=\"Bolagsnamn...\"\n                value={query}\n                onChange={(e) => setQuery(e.target.value)}\n                onKeyDown={(e) => e.key === \"Enter\" && handleSearch()}\n                className=\"w-full px-3 py-2 bg-secondary border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-ring\"\n              />\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Org.nummer (valfritt)...\"\n                  value={orgNr}\n                  onChange={(e) => setOrgNr(e.target.value)}\n                  onKeyDown={(e) => e.key === \"Enter\" && handleSearch()}\n                  className=\"flex-1 px-3 py-2 bg-secondary border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-ring font-mono\"\n                />\n                <button\n                  onClick={handleSearch}\n                  disabled={isSearching}\n                  className=\"btn-primary px-4\"\n                >\n                  {isSearching ? (\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  ) : (\n                    <Search className=\"w-4 h-4\" />\n                  )}\n                </button>\n              </div>\n            </div>\n\n            {/* Status and progress */}\n            <div className=\"flex items-center justify-between\">\n              <StatusBadge status={status} />\n              {progress > 0 && (\n                <span className=\"text-xs text-muted-foreground font-mono\">\n                  {progress}%\n                </span>\n              )}\n            </div>\n\n            {progress > 0 && (\n              <ProgressBar tool=\"vinnova\" progress={progress} />\n            )}\n\n            {/* Project list */}\n            {searchResult && !selectedProject && (\n              <div className=\"space-y-2\">\n                <label className=\"text-label\">\n                  Projekt ({searchResult.projects.length})\n                </label>\n                <div className=\"space-y-2 max-h-72 overflow-y-auto\">\n                  {searchResult.projects.map((project) => (\n                    <button\n                      key={project.id || project.diarienummer}\n                      onClick={() => setSelectedProject(project)}\n                      className=\"w-full text-left p-3 rounded-lg border border-border hover:bg-secondary transition-colors\"\n                    >\n                      <div className=\"font-medium text-sm line-clamp-2\">{project.titel}</div>\n                      <div className=\"flex items-center gap-2 text-xs text-muted-foreground mt-1\">\n                        <span className=\"font-mono\">{project.diarienummer}</span>\n                        {project.programnamn && (\n                          <>\n                            <span>•</span>\n                            <span className=\"truncate\">{project.programnamn}</span>\n                          </>\n                        )}\n                      </div>\n                      {project.vinnovaBidrag && (\n                        <div className=\"text-xs text-emerald-500 mt-1\">\n                          Bidrag: {formatCurrency(project.vinnovaBidrag)}\n                        </div>\n                      )}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Project details */}\n            {selectedProject && (\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <label className=\"text-label\">Projektdetaljer</label>\n                  <button\n                    onClick={() => setSelectedProject(null)}\n                    className=\"text-xs text-muted-foreground hover:text-foreground\"\n                  >\n                    Tillbaka\n                  </button>\n                </div>\n                <div className=\"p-4 rounded-lg border border-border bg-secondary/50 space-y-4\">\n                  <div>\n                    <div className=\"font-semibold\">{selectedProject.titel}</div>\n                    <div className=\"text-xs text-muted-foreground font-mono mt-1\">\n                      {selectedProject.diarienummer}\n                    </div>\n                  </div>\n\n                  {selectedProject.programnamn && (\n                    <div className=\"text-sm\">\n                      <span className=\"text-muted-foreground\">Program:</span>{\" \"}\n                      {selectedProject.programnamn}\n                    </div>\n                  )}\n\n                  <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                    <div className=\"flex items-center gap-2\">\n                      <Calendar className=\"w-3.5 h-3.5 text-muted-foreground\" />\n                      <span className=\"text-muted-foreground\">Start:</span>{\" \"}\n                      {formatDate(selectedProject.startdatum)}\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Calendar className=\"w-3.5 h-3.5 text-muted-foreground\" />\n                      <span className=\"text-muted-foreground\">Slut:</span>{\" \"}\n                      {formatDate(selectedProject.slutdatum)}\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Coins className=\"w-3.5 h-3.5 text-muted-foreground\" />\n                      <span className=\"text-muted-foreground\">Budget:</span>{\" \"}\n                      {formatCurrency(selectedProject.totalbudget)}\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Coins className=\"w-3.5 h-3.5 text-emerald-500\" />\n                      <span className=\"text-muted-foreground\">Bidrag:</span>{\" \"}\n                      <span className=\"text-emerald-500\">\n                        {formatCurrency(selectedProject.vinnovaBidrag)}\n                      </span>\n                    </div>\n                  </div>\n\n                  {selectedProject.koordinator && (\n                    <div>\n                      <div className=\"text-xs text-muted-foreground mb-1\">Koordinator</div>\n                      <div className=\"text-sm\">{selectedProject.koordinator}</div>\n                      {selectedProject.koordinatorOrgNr && (\n                        <div className=\"text-xs text-muted-foreground font-mono\">\n                          {formatOrgNr(selectedProject.koordinatorOrgNr)}\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {selectedProject.deltagare && selectedProject.deltagare.length > 0 && (\n                    <div>\n                      <div className=\"flex items-center gap-1 text-xs text-muted-foreground mb-2\">\n                        <Users className=\"w-3.5 h-3.5\" />\n                        Deltagare ({selectedProject.deltagare.length})\n                      </div>\n                      <div className=\"space-y-1\">\n                        {selectedProject.deltagare.slice(0, 5).map((d, i) => (\n                          <div key={i} className=\"text-sm flex items-center justify-between\">\n                            <span>{d.namn}</span>\n                            {d.orgNr && (\n                              <span className=\"text-xs text-muted-foreground font-mono\">\n                                {formatOrgNr(d.orgNr)}\n                              </span>\n                            )}\n                          </div>\n                        ))}\n                        {selectedProject.deltagare.length > 5 && (\n                          <div className=\"text-xs text-muted-foreground\">\n                            +{selectedProject.deltagare.length - 5} fler...\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  )}\n\n                  <a\n                    href={`https://www.vinnova.se/sok/?q=${encodeURIComponent(selectedProject.diarienummer)}`}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground\"\n                  >\n                    <ExternalLink className=\"w-3.5 h-3.5\" />\n                    Öppna på Vinnova\n                  </a>\n                </div>\n              </div>\n            )}\n\n            {/* Search history */}\n            {searchHistory.length > 0 && !searchResult && (\n              <div className=\"space-y-2\">\n                <label className=\"text-label text-xs\">Senaste sökningar</label>\n                <div className=\"flex flex-wrap gap-1\">\n                  {searchHistory.map((h, i) => (\n                    <button\n                      key={i}\n                      onClick={() => {\n                        setQuery(h.name);\n                        setOrgNr(h.orgNr || \"\");\n                      }}\n                      className=\"px-2 py-1 text-xs bg-secondary rounded hover:bg-secondary/80\"\n                    >\n                      {h.name || h.orgNr}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )}\n          </>\n        )}\n\n        {activeTab === \"status\" && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm font-medium\">Aktivitetslogg</span>\n              <StatusBadge status={status} />\n            </div>\n            <LogPanel entries={logs} maxHeight={300} />\n          </div>\n        )}\n      </div>\n    </ToolPanel>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4866, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/kungorelser/KungorelserTool.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback, useRef } from \"react\";\nimport { ScrollText, Search, Clock, Activity, Loader2, Filter, RefreshCw } from \"lucide-react\";\nimport { ToolPanel, ToolTabs, LogPanel, ProgressBar, StatusBadge } from \"../shared\";\nimport type { ToolTab, LogEntry, ToolStatus } from \"../shared/types\";\nimport { formatOrgNr } from \"@/lib/utils\";\n\ninterface KungorelserToolProps {\n  onClose: () => void;\n}\n\ninterface Announcement {\n  id: string;\n  caseNumber: string;\n  type: string;\n  companyName: string;\n  orgNumber: string;\n  date: string;\n  detailText?: string;\n}\n\ninterface AnnouncementType {\n  type: string;\n  count: number;\n}\n\nconst TABS: ToolTab[] = [\n  { id: \"search\", label: \"Sök\", icon: <Search className=\"w-3.5 h-3.5\" /> },\n  { id: \"browse\", label: \"Bläddra\", icon: <ScrollText className=\"w-3.5 h-3.5\" /> },\n  { id: \"status\", label: \"Status\", icon: <Activity className=\"w-3.5 h-3.5\" /> },\n];\n\nconst ANNOUNCEMENT_TYPES = [\n  { id: \"all\", label: \"Alla\" },\n  { id: \"Konkurs\", label: \"Konkurser\" },\n  { id: \"Konkursavslut\", label: \"Konkursavslut\" },\n  { id: \"Likvidation\", label: \"Likvidationer\" },\n  { id: \"Företagsrekonstruktion\", label: \"Rekonstruktion\" },\n];\n\nexport function KungorelserTool({ onClose }: KungorelserToolProps) {\n  const [activeTab, setActiveTab] = useState(\"search\");\n  const [status, setStatus] = useState<ToolStatus>(\"idle\");\n  const [progress, setProgress] = useState(0);\n  const [logs, setLogs] = useState<LogEntry[]>([]);\n  const [query, setQuery] = useState(\"\");\n  const [selectedType, setSelectedType] = useState(\"all\");\n  const [announcements, setAnnouncements] = useState<Announcement[]>([]);\n  const [browseAnnouncements, setBrowseAnnouncements] = useState<Announcement[]>([]);\n  const [types, setTypes] = useState<AnnouncementType[]>([]);\n  const [searchHistory, setSearchHistory] = useState<string[]>([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const [isBrowsing, setIsBrowsing] = useState(false);\n  const logIdRef = useRef(0);\n\n  const addLog = useCallback((message: string, type: LogEntry[\"type\"] = \"info\") => {\n    const entry: LogEntry = {\n      id: `log-${++logIdRef.current}`,\n      timestamp: new Date(),\n      message,\n      type,\n    };\n    setLogs((prev) => [...prev.slice(-99), entry]);\n    return entry;\n  }, []);\n\n  // Search for new announcements (triggers scraper)\n  const handleSearch = async () => {\n    if (!query.trim() || query.trim().length < 2) return;\n\n    setIsSearching(true);\n    setStatus(\"running\");\n    setProgress(10);\n    setAnnouncements([]);\n    addLog(`Söker kungörelser för \"${query}\"...`, \"info\");\n\n    // Add to search history\n    setSearchHistory((prev) => {\n      const exists = prev.find((q) => q.toLowerCase() === query.toLowerCase());\n      if (exists) return prev;\n      return [query, ...prev.slice(0, 9)];\n    });\n\n    try {\n      setProgress(30);\n      addLog(\"Anropar Bolagsverket POIT (kan ta en stund)...\", \"info\");\n\n      const response = await fetch(\"/api/kungorelser/search\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          query: query.trim(),\n          skipDetails: false,\n          detailLimit: 10,\n        }),\n      });\n\n      setProgress(70);\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || `API returned ${response.status}`);\n      }\n\n      const data = await response.json();\n      setProgress(90);\n\n      if (data.announcements && data.announcements.length > 0) {\n        setAnnouncements(data.announcements);\n        addLog(`Hittade ${data.announcements.length} kungörelser`, \"success\");\n      } else {\n        addLog(\"Inga kungörelser hittades\", \"warning\");\n      }\n\n      setProgress(100);\n      setStatus(\"success\");\n    } catch (error) {\n      addLog(`Fel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n      setStatus(\"error\");\n    }\n\n    setIsSearching(false);\n    setTimeout(() => setProgress(0), 1000);\n  };\n\n  // Browse existing announcements in database\n  const loadBrowseAnnouncements = async () => {\n    setIsBrowsing(true);\n    setStatus(\"running\");\n    setProgress(20);\n    addLog(\"Laddar sparade kungörelser...\", \"info\");\n\n    try {\n      const params = new URLSearchParams({\n        limit: \"50\",\n      });\n\n      if (selectedType !== \"all\") {\n        params.set(\"type\", selectedType);\n      }\n\n      const response = await fetch(`/api/kungorelser?${params.toString()}`);\n      setProgress(60);\n\n      if (!response.ok) {\n        throw new Error(`API returned ${response.status}`);\n      }\n\n      const data = await response.json();\n      setProgress(90);\n\n      setBrowseAnnouncements(data.announcements || []);\n      setTypes(data.types || []);\n      addLog(`Laddat ${data.announcements?.length || 0} kungörelser`, \"success\");\n      setProgress(100);\n      setStatus(\"success\");\n    } catch (error) {\n      addLog(`Fel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n      setStatus(\"error\");\n    }\n\n    setIsBrowsing(false);\n    setTimeout(() => setProgress(0), 1000);\n  };\n\n  const formatDate = (dateStr: string) => {\n    try {\n      const date = new Date(dateStr);\n      return date.toLocaleDateString(\"sv-SE\");\n    } catch {\n      return dateStr;\n    }\n  };\n\n  const getTypeColor = (type: string) => {\n    const colors: Record<string, string> = {\n      Konkurs: \"text-red-500\",\n      Konkursavslut: \"text-orange-500\",\n      Likvidation: \"text-yellow-500\",\n      Företagsrekonstruktion: \"text-blue-500\",\n    };\n    return colors[type] || \"text-muted-foreground\";\n  };\n\n  return (\n    <ToolPanel\n      tool=\"kungorelser\"\n      title=\"Kungörelser\"\n      icon={<ScrollText className=\"w-5 h-5\" />}\n      isOpen={true}\n      onClose={onClose}\n    >\n      <ToolTabs\n        tool=\"kungorelser\"\n        tabs={TABS}\n        activeTab={activeTab}\n        onTabChange={setActiveTab}\n      />\n\n      <div className=\"tool-content space-y-4\">\n        {activeTab === \"search\" && (\n          <>\n            {/* Search input */}\n            <div className=\"space-y-3\">\n              <label className=\"text-label\">Sök nya kungörelser</label>\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Bolagsnamn eller org.nummer...\"\n                  value={query}\n                  onChange={(e) => setQuery(e.target.value)}\n                  onKeyDown={(e) => e.key === \"Enter\" && handleSearch()}\n                  className=\"flex-1 px-3 py-2 bg-secondary border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-ring\"\n                />\n                <button\n                  onClick={handleSearch}\n                  disabled={isSearching}\n                  className=\"btn-primary px-4\"\n                >\n                  {isSearching ? (\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  ) : (\n                    <Search className=\"w-4 h-4\" />\n                  )}\n                </button>\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                Söker direkt mot Bolagsverket POIT. Kan ta upp till 30 sekunder.\n              </p>\n            </div>\n\n            {/* Status and progress */}\n            <div className=\"flex items-center justify-between\">\n              <StatusBadge status={status} />\n              {progress > 0 && (\n                <span className=\"text-xs text-muted-foreground font-mono\">\n                  {progress}%\n                </span>\n              )}\n            </div>\n\n            {progress > 0 && (\n              <ProgressBar tool=\"kungorelser\" progress={progress} />\n            )}\n\n            {/* Search results */}\n            {announcements.length > 0 && (\n              <div className=\"space-y-2\">\n                <label className=\"text-label\">Resultat ({announcements.length})</label>\n                <div className=\"space-y-2 max-h-80 overflow-y-auto\">\n                  {announcements.map((ann) => (\n                    <div\n                      key={ann.id}\n                      className=\"p-3 rounded-lg border border-border bg-secondary/50\"\n                    >\n                      <div className=\"flex items-start justify-between gap-2\">\n                        <div className=\"font-medium text-sm\">{ann.companyName}</div>\n                        <span className={`text-xs font-medium ${getTypeColor(ann.type)}`}>\n                          {ann.type}\n                        </span>\n                      </div>\n                      <div className=\"flex items-center gap-2 text-xs text-muted-foreground mt-1\">\n                        <span className=\"font-mono\">{formatOrgNr(ann.orgNumber)}</span>\n                        <span>•</span>\n                        <span>{formatDate(ann.date)}</span>\n                        {ann.caseNumber && (\n                          <>\n                            <span>•</span>\n                            <span>Mål: {ann.caseNumber}</span>\n                          </>\n                        )}\n                      </div>\n                      {ann.detailText && (\n                        <p className=\"text-xs text-muted-foreground mt-2 line-clamp-2\">\n                          {ann.detailText}\n                        </p>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Recent searches */}\n            {searchHistory.length > 0 && announcements.length === 0 && (\n              <div className=\"space-y-2\">\n                <label className=\"text-label text-xs\">Senaste sökningar</label>\n                <div className=\"flex flex-wrap gap-1\">\n                  {searchHistory.map((q, i) => (\n                    <button\n                      key={i}\n                      onClick={() => setQuery(q)}\n                      className=\"px-2 py-1 text-xs bg-secondary rounded hover:bg-secondary/80\"\n                    >\n                      {q}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )}\n          </>\n        )}\n\n        {activeTab === \"browse\" && (\n          <>\n            {/* Filter and refresh */}\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <Filter className=\"w-3.5 h-3.5 text-muted-foreground\" />\n                <span className=\"text-sm font-medium\">Filtrera typ</span>\n              </div>\n              <button\n                onClick={loadBrowseAnnouncements}\n                disabled={isBrowsing}\n                className=\"btn-secondary text-xs gap-1.5\"\n              >\n                {isBrowsing ? (\n                  <Loader2 className=\"w-3.5 h-3.5 animate-spin\" />\n                ) : (\n                  <RefreshCw className=\"w-3.5 h-3.5\" />\n                )}\n                Ladda\n              </button>\n            </div>\n\n            {/* Type filters */}\n            <div className=\"flex gap-2 flex-wrap\">\n              {ANNOUNCEMENT_TYPES.map((type) => (\n                <button\n                  key={type.id}\n                  onClick={() => setSelectedType(type.id)}\n                  className={`filter-chip ${selectedType === type.id ? \"active\" : \"\"}`}\n                >\n                  {type.label}\n                </button>\n              ))}\n            </div>\n\n            {progress > 0 && (\n              <ProgressBar tool=\"kungorelser\" progress={progress} />\n            )}\n\n            {/* Browse results */}\n            {browseAnnouncements.length > 0 ? (\n              <div className=\"space-y-2\">\n                <label className=\"text-label\">Sparade kungörelser ({browseAnnouncements.length})</label>\n                <div className=\"space-y-2 max-h-80 overflow-y-auto\">\n                  {browseAnnouncements.map((ann) => (\n                    <div\n                      key={ann.id}\n                      className=\"p-3 rounded-lg border border-border bg-secondary/50\"\n                    >\n                      <div className=\"flex items-start justify-between gap-2\">\n                        <div className=\"font-medium text-sm\">{ann.companyName}</div>\n                        <span className={`text-xs font-medium ${getTypeColor(ann.type)}`}>\n                          {ann.type}\n                        </span>\n                      </div>\n                      <div className=\"flex items-center gap-2 text-xs text-muted-foreground mt-1\">\n                        <span className=\"font-mono\">{formatOrgNr(ann.orgNumber)}</span>\n                        <span>•</span>\n                        <span>{formatDate(ann.date)}</span>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            ) : (\n              <div className=\"empty-state py-8\">\n                <ScrollText className=\"empty-state-icon w-10 h-10\" />\n                <p className=\"empty-state-title text-sm\">Inga kungörelser</p>\n                <p className=\"empty-state-description text-xs\">\n                  Klicka på &quot;Ladda&quot; för att hämta sparade kungörelser.\n                </p>\n              </div>\n            )}\n\n            {/* Type statistics */}\n            {types.length > 0 && (\n              <div className=\"space-y-2\">\n                <label className=\"text-label text-xs\">Statistik</label>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  {types.slice(0, 4).map((t) => (\n                    <div key={t.type} className=\"p-2 bg-secondary/50 rounded text-xs\">\n                      <span className={getTypeColor(t.type)}>{t.type}</span>\n                      <span className=\"text-muted-foreground ml-2\">{t.count} st</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n          </>\n        )}\n\n        {activeTab === \"status\" && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm font-medium\">Aktivitetslogg</span>\n              <StatusBadge status={status} />\n            </div>\n            <LogPanel entries={logs} maxHeight={300} />\n          </div>\n        )}\n      </div>\n    </ToolPanel>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5685, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/rss/RssTool.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback, useRef, useEffect } from \"react\";\nimport { Rss, List, Activity, Plus, Loader2, Trash2, Check, X, ExternalLink, RefreshCw } from \"lucide-react\";\nimport { ToolPanel, ToolTabs, LogPanel, ProgressBar, StatusBadge } from \"../shared\";\nimport type { ToolTab, LogEntry, ToolStatus } from \"../shared/types\";\n\ninterface RssToolProps {\n  onClose: () => void;\n}\n\ninterface Feed {\n  id: string;\n  name: string;\n  url: string;\n  type: string;\n  category?: string;\n  color?: string;\n  enabled: boolean;\n  createdAt?: string;\n}\n\ninterface ValidationResult {\n  valid: boolean;\n  error?: string;\n  feed?: {\n    title?: string;\n    description?: string;\n    itemCount?: number;\n    type?: string;\n  };\n}\n\nconst TABS: ToolTab[] = [\n  { id: \"sources\", label: \"Källor\", icon: <List className=\"w-3.5 h-3.5\" /> },\n  { id: \"add\", label: \"Lägg till\", icon: <Plus className=\"w-3.5 h-3.5\" /> },\n  { id: \"status\", label: \"Status\", icon: <Activity className=\"w-3.5 h-3.5\" /> },\n];\n\nconst RSSHUB_TEMPLATES = [\n  {\n    id: \"twitter\",\n    name: \"Twitter/X\",\n    template: \"https://rsshub.rssforever.com/twitter/user/{username}\",\n    placeholder: \"Användarnamn (utan @)\",\n    icon: (\n      <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z\"/>\n      </svg>\n    ),\n  },\n  {\n    id: \"youtube\",\n    name: \"YouTube-kanal\",\n    template: \"https://rsshub.rssforever.com/youtube/channel/{channelId}\",\n    placeholder: \"Kanal-ID eller @handle\",\n    icon: (\n      <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z\"/>\n      </svg>\n    ),\n  },\n  {\n    id: \"linkedin\",\n    name: \"LinkedIn Company\",\n    template: \"https://rsshub.rssforever.com/linkedin/company/{companyName}\",\n    placeholder: \"Företagsnamn (URL-slug)\",\n    icon: (\n      <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z\"/>\n      </svg>\n    ),\n  },\n];\n\nexport function RssTool({ onClose }: RssToolProps) {\n  const [activeTab, setActiveTab] = useState(\"sources\");\n  const [status, setStatus] = useState<ToolStatus>(\"idle\");\n  const [progress, setProgress] = useState(0);\n  const [logs, setLogs] = useState<LogEntry[]>([]);\n  const [feeds, setFeeds] = useState<Feed[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [newFeedUrl, setNewFeedUrl] = useState(\"\");\n  const [newFeedName, setNewFeedName] = useState(\"\");\n  const [validation, setValidation] = useState<ValidationResult | null>(null);\n  const [isValidating, setIsValidating] = useState(false);\n  const [isAdding, setIsAdding] = useState(false);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [templateInput, setTemplateInput] = useState(\"\");\n  const logIdRef = useRef(0);\n\n  const addLog = useCallback((message: string, type: LogEntry[\"type\"] = \"info\") => {\n    const entry: LogEntry = {\n      id: `log-${++logIdRef.current}`,\n      timestamp: new Date(),\n      message,\n      type,\n    };\n    setLogs((prev) => [...prev.slice(-99), entry]);\n    return entry;\n  }, []);\n\n  // Load feeds on mount\n  useEffect(() => {\n    loadFeeds();\n  }, []);\n\n  const loadFeeds = async () => {\n    setIsLoading(true);\n    setStatus(\"running\");\n    setProgress(20);\n    addLog(\"Laddar RSS-källor...\", \"info\");\n\n    try {\n      const response = await fetch(\"/api/feeds\");\n      setProgress(60);\n\n      if (!response.ok) {\n        throw new Error(`API returned ${response.status}`);\n      }\n\n      const data = await response.json();\n      setProgress(90);\n      setFeeds(data.feeds || []);\n      addLog(`Laddat ${data.feeds?.length || 0} RSS-källor`, \"success\");\n      setStatus(\"success\");\n    } catch (error) {\n      addLog(`Fel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n      setStatus(\"error\");\n    }\n\n    setIsLoading(false);\n    setProgress(100);\n    setTimeout(() => setProgress(0), 1000);\n  };\n\n  const validateUrl = async (url: string) => {\n    if (!url.trim()) return;\n\n    setIsValidating(true);\n    setValidation(null);\n    addLog(`Validerar: ${url}`, \"info\");\n\n    try {\n      const response = await fetch(\"/api/feeds/validate\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ url: url.trim() }),\n      });\n\n      const data = await response.json();\n      setValidation(data);\n\n      if (data.valid) {\n        addLog(`Giltig RSS-källa: ${data.feed?.title || url}`, \"success\");\n        if (data.feed?.title && !newFeedName) {\n          setNewFeedName(data.feed.title);\n        }\n      } else {\n        addLog(`Ogiltig källa: ${data.error || \"Okänt fel\"}`, \"warning\");\n      }\n    } catch (error) {\n      addLog(`Valideringsfel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n      setValidation({ valid: false, error: \"Kunde inte validera\" });\n    }\n\n    setIsValidating(false);\n  };\n\n  const addFeed = async () => {\n    if (!newFeedUrl.trim() || !validation?.valid) return;\n\n    setIsAdding(true);\n    setStatus(\"running\");\n    setProgress(30);\n    addLog(`Lägger till: ${newFeedName || newFeedUrl}`, \"info\");\n\n    try {\n      const response = await fetch(\"/api/feeds\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          url: newFeedUrl.trim(),\n          name: newFeedName.trim() || undefined,\n        }),\n      });\n\n      setProgress(70);\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || `API returned ${response.status}`);\n      }\n\n      const data = await response.json();\n      setProgress(90);\n\n      if (data.feed) {\n        setFeeds((prev) => [data.feed, ...prev]);\n        addLog(`Lade till: ${data.feed.name}`, \"success\");\n        setNewFeedUrl(\"\");\n        setNewFeedName(\"\");\n        setValidation(null);\n        setActiveTab(\"sources\");\n      }\n\n      setStatus(\"success\");\n    } catch (error) {\n      addLog(`Fel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n      setStatus(\"error\");\n    }\n\n    setIsAdding(false);\n    setProgress(100);\n    setTimeout(() => setProgress(0), 1000);\n  };\n\n  const deleteFeed = async (feed: Feed) => {\n    addLog(`Tar bort: ${feed.name}`, \"info\");\n\n    try {\n      const response = await fetch(`/api/feeds/${feed.id}`, {\n        method: \"DELETE\",\n      });\n\n      if (!response.ok) {\n        throw new Error(`API returned ${response.status}`);\n      }\n\n      setFeeds((prev) => prev.filter((f) => f.id !== feed.id));\n      addLog(`Tog bort: ${feed.name}`, \"success\");\n    } catch (error) {\n      addLog(`Fel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n    }\n  };\n\n  const toggleFeed = async (feed: Feed) => {\n    try {\n      const response = await fetch(`/api/feeds/${feed.id}`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ enabled: !feed.enabled }),\n      });\n\n      if (!response.ok) {\n        throw new Error(`API returned ${response.status}`);\n      }\n\n      setFeeds((prev) =>\n        prev.map((f) => (f.id === feed.id ? { ...f, enabled: !f.enabled } : f))\n      );\n      addLog(`${feed.enabled ? \"Inaktiverade\" : \"Aktiverade\"}: ${feed.name}`, \"info\");\n    } catch (error) {\n      addLog(`Fel: ${error instanceof Error ? error.message : \"Okänt fel\"}`, \"error\");\n    }\n  };\n\n  const applyTemplate = (templateId: string) => {\n    const template = RSSHUB_TEMPLATES.find((t) => t.id === templateId);\n    if (template && templateInput.trim()) {\n      const url = template.template.replace(\"{username}\", templateInput.trim())\n        .replace(\"{channelId}\", templateInput.trim())\n        .replace(\"{companyName}\", templateInput.trim());\n      setNewFeedUrl(url);\n      setSelectedTemplate(null);\n      setTemplateInput(\"\");\n      validateUrl(url);\n    }\n  };\n\n  return (\n    <ToolPanel\n      tool=\"rss\"\n      title=\"RSS-hanterare\"\n      icon={<Rss className=\"w-5 h-5\" />}\n      isOpen={true}\n      onClose={onClose}\n    >\n      <ToolTabs\n        tool=\"rss\"\n        tabs={TABS}\n        activeTab={activeTab}\n        onTabChange={setActiveTab}\n      />\n\n      <div className=\"tool-content space-y-4\">\n        {activeTab === \"sources\" && (\n          <>\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm font-medium\">Dina RSS-källor ({feeds.length})</span>\n              <button\n                onClick={loadFeeds}\n                disabled={isLoading}\n                className=\"btn-secondary text-xs gap-1.5\"\n              >\n                {isLoading ? (\n                  <Loader2 className=\"w-3.5 h-3.5 animate-spin\" />\n                ) : (\n                  <RefreshCw className=\"w-3.5 h-3.5\" />\n                )}\n                Uppdatera\n              </button>\n            </div>\n\n            {progress > 0 && (\n              <ProgressBar tool=\"rss\" progress={progress} />\n            )}\n\n            {feeds.length > 0 ? (\n              <div className=\"space-y-2 max-h-80 overflow-y-auto\">\n                {feeds.map((feed) => (\n                  <div\n                    key={feed.id}\n                    className={`p-3 rounded-lg border border-border transition-colors ${\n                      feed.enabled ? \"bg-secondary/50\" : \"bg-secondary/20 opacity-60\"\n                    }`}\n                  >\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"font-medium text-sm truncate\">{feed.name}</div>\n                        <div className=\"text-xs text-muted-foreground truncate mt-0.5\">\n                          {feed.url}\n                        </div>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                          <span className={`text-xs px-1.5 py-0.5 rounded ${\n                            feed.enabled\n                              ? \"bg-green-500/20 text-green-500\"\n                              : \"bg-muted text-muted-foreground\"\n                          }`}>\n                            {feed.enabled ? \"Aktiv\" : \"Inaktiv\"}\n                          </span>\n                          {feed.type && (\n                            <span className=\"text-xs text-muted-foreground\">\n                              {feed.type}\n                            </span>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-1\">\n                        <button\n                          onClick={() => toggleFeed(feed)}\n                          className=\"p-1.5 rounded hover:bg-secondary transition-colors\"\n                          title={feed.enabled ? \"Inaktivera\" : \"Aktivera\"}\n                        >\n                          {feed.enabled ? (\n                            <Check className=\"w-3.5 h-3.5 text-green-500\" />\n                          ) : (\n                            <X className=\"w-3.5 h-3.5 text-muted-foreground\" />\n                          )}\n                        </button>\n                        <a\n                          href={feed.url}\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          className=\"p-1.5 rounded hover:bg-secondary transition-colors\"\n                          title=\"Öppna URL\"\n                        >\n                          <ExternalLink className=\"w-3.5 h-3.5 text-muted-foreground\" />\n                        </a>\n                        <button\n                          onClick={() => deleteFeed(feed)}\n                          className=\"p-1.5 rounded hover:bg-secondary transition-colors text-red-500\"\n                          title=\"Ta bort\"\n                        >\n                          <Trash2 className=\"w-3.5 h-3.5\" />\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"empty-state py-8\">\n                <Rss className=\"empty-state-icon w-10 h-10\" />\n                <p className=\"empty-state-title text-sm\">Inga RSS-källor</p>\n                <p className=\"empty-state-description text-xs\">\n                  Lägg till RSS-flöden för att hålla koll på nyheter.\n                </p>\n                <button\n                  onClick={() => setActiveTab(\"add\")}\n                  className=\"btn-primary text-xs mt-3\"\n                >\n                  <Plus className=\"w-3.5 h-3.5\" />\n                  Lägg till källa\n                </button>\n              </div>\n            )}\n          </>\n        )}\n\n        {activeTab === \"add\" && (\n          <>\n            {/* Custom URL */}\n            <div className=\"space-y-3\">\n              <label className=\"text-label\">RSS/Atom URL</label>\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"url\"\n                  placeholder=\"https://example.com/feed.xml\"\n                  value={newFeedUrl}\n                  onChange={(e) => {\n                    setNewFeedUrl(e.target.value);\n                    setValidation(null);\n                  }}\n                  className=\"flex-1 px-3 py-2 bg-secondary border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-ring font-mono\"\n                />\n                <button\n                  onClick={() => validateUrl(newFeedUrl)}\n                  disabled={isValidating || !newFeedUrl.trim()}\n                  className=\"btn-secondary px-3\"\n                >\n                  {isValidating ? (\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  ) : (\n                    \"Validera\"\n                  )}\n                </button>\n              </div>\n            </div>\n\n            {/* Validation result */}\n            {validation && (\n              <div className={`p-3 rounded-lg border ${\n                validation.valid\n                  ? \"border-green-500/30 bg-green-500/10\"\n                  : \"border-red-500/30 bg-red-500/10\"\n              }`}>\n                {validation.valid ? (\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center gap-2 text-green-500\">\n                      <Check className=\"w-4 h-4\" />\n                      <span className=\"text-sm font-medium\">Giltig RSS-källa</span>\n                    </div>\n                    {validation.feed && (\n                      <div className=\"text-xs text-muted-foreground space-y-1\">\n                        {validation.feed.title && <div>Titel: {validation.feed.title}</div>}\n                        {validation.feed.itemCount && <div>Artiklar: {validation.feed.itemCount}</div>}\n                        {validation.feed.type && <div>Typ: {validation.feed.type}</div>}\n                      </div>\n                    )}\n                  </div>\n                ) : (\n                  <div className=\"flex items-center gap-2 text-red-500\">\n                    <X className=\"w-4 h-4\" />\n                    <span className=\"text-sm\">{validation.error || \"Ogiltig källa\"}</span>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Custom name */}\n            {validation?.valid && (\n              <div className=\"space-y-2\">\n                <label className=\"text-label\">Namn (valfritt)</label>\n                <input\n                  type=\"text\"\n                  placeholder=\"Ange ett namn för källan...\"\n                  value={newFeedName}\n                  onChange={(e) => setNewFeedName(e.target.value)}\n                  className=\"w-full px-3 py-2 bg-secondary border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-ring\"\n                />\n              </div>\n            )}\n\n            {/* Add button */}\n            {validation?.valid && (\n              <button\n                onClick={addFeed}\n                disabled={isAdding}\n                className=\"btn-primary w-full\"\n              >\n                {isAdding ? (\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\n                ) : (\n                  <>\n                    <Plus className=\"w-4 h-4\" />\n                    Lägg till källa\n                  </>\n                )}\n              </button>\n            )}\n\n            {/* RSSHub templates */}\n            <div className=\"space-y-3 pt-4 border-t border-border\">\n              <label className=\"text-label\">RSSHub-mallar</label>\n              <p className=\"text-xs text-muted-foreground\">\n                Generera RSS-flöden från webbplatser utan inbyggt stöd.\n              </p>\n\n              <div className=\"grid gap-2\">\n                {RSSHUB_TEMPLATES.map((template) => (\n                  <div key={template.id}>\n                    {selectedTemplate === template.id ? (\n                      <div className=\"p-3 rounded-lg border border-border bg-secondary space-y-2\">\n                        <div className=\"flex items-center gap-2\">\n                          {template.icon}\n                          <span className=\"text-sm font-medium\">{template.name}</span>\n                        </div>\n                        <div className=\"flex gap-2\">\n                          <input\n                            type=\"text\"\n                            placeholder={template.placeholder}\n                            value={templateInput}\n                            onChange={(e) => setTemplateInput(e.target.value)}\n                            onKeyDown={(e) => e.key === \"Enter\" && applyTemplate(template.id)}\n                            className=\"flex-1 px-2 py-1.5 bg-background border border-border rounded text-sm\"\n                            autoFocus\n                          />\n                          <button\n                            onClick={() => applyTemplate(template.id)}\n                            disabled={!templateInput.trim()}\n                            className=\"btn-primary px-3 py-1.5 text-xs\"\n                          >\n                            Använd\n                          </button>\n                          <button\n                            onClick={() => {\n                              setSelectedTemplate(null);\n                              setTemplateInput(\"\");\n                            }}\n                            className=\"btn-secondary px-2 py-1.5\"\n                          >\n                            <X className=\"w-3.5 h-3.5\" />\n                          </button>\n                        </div>\n                      </div>\n                    ) : (\n                      <button\n                        onClick={() => setSelectedTemplate(template.id)}\n                        className=\"w-full flex items-center gap-3 p-3 rounded-lg border border-border hover:bg-secondary transition-colors text-left\"\n                      >\n                        <div className=\"tool-menu-icon\" data-tool=\"rss\">\n                          {template.icon}\n                        </div>\n                        <span className=\"text-sm\">{template.name}</span>\n                      </button>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </div>\n          </>\n        )}\n\n        {activeTab === \"status\" && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm font-medium\">Aktivitetslogg</span>\n              <StatusBadge status={status} />\n            </div>\n            <LogPanel entries={logs} maxHeight={300} />\n          </div>\n        )}\n      </div>\n    </ToolPanel>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6684, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/tools/ToolHost.tsx"],"sourcesContent":["\"use client\";\n\nimport { useTools } from \"./ToolProvider\";\nimport { AllabolagTool } from \"./allabolag/AllabolagTool\";\nimport { BolagsverketTool } from \"./bolagsverket/BolagsverketTool\";\nimport { VinnovaTool } from \"./vinnova/VinnovaTool\";\nimport { KungorelserTool } from \"./kungorelser/KungorelserTool\";\nimport { RssTool } from \"./rss/RssTool\";\n\nexport function ToolHost() {\n  const { activeTool, closeTool } = useTools();\n\n  if (!activeTool) return null;\n\n  const toolComponents = {\n    allabolag: AllabolagTool,\n    bolagsverket: BolagsverketTool,\n    vinnova: VinnovaTool,\n    kungorelser: KungorelserTool,\n    rss: RssTool,\n  };\n\n  const ToolComponent = toolComponents[activeTool];\n\n  if (!ToolComponent) return null;\n\n  return <ToolComponent onClose={closeTool} />;\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;AASO,SAAS;IACd,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,GAAG,IAAA,kMAAQ;IAE1C,IAAI,CAAC,YAAY,OAAO;IAExB,MAAM,iBAAiB;QACrB,WAAW,qNAAa;QACxB,cAAc,8NAAgB;QAC9B,SAAS,+MAAW;QACpB,aAAa,2NAAe;QAC5B,KAAK,mMAAO;IACd;IAEA,MAAM,gBAAgB,cAAc,CAAC,WAAW;IAEhD,IAAI,CAAC,eAAe,OAAO;IAE3B,qBAAO,yRAAC;QAAc,SAAS;;;;;;AACjC"}},
    {"offset": {"line": 6727, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/person-linker.tsx"],"sourcesContent":["\"use client\";\n\nimport { createContext, useContext, useEffect, useState, ReactNode, useMemo } from \"react\";\nimport Link from \"next/link\";\n\ninterface PersonInfo {\n  id: string;\n  allabolagId?: string | null;\n}\n\ntype PersonMap = Record<string, PersonInfo>; // name -> { id, allabolagId }\n\ninterface PersonLinkerContextType {\n  persons: PersonMap;\n  isLoading: boolean;\n}\n\nconst PersonLinkerContext = createContext<PersonLinkerContextType>({\n  persons: {},\n  isLoading: true,\n});\n\nexport function PersonLinkerProvider({ children }: { children: ReactNode }) {\n  const [persons, setPersons] = useState<PersonMap>({});\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    async function fetchPersons() {\n      try {\n        const res = await fetch(\"/api/person/names\");\n        if (res.ok) {\n          const data = await res.json();\n          setPersons(data.persons || {});\n        }\n      } catch (error) {\n        console.error(\"Failed to fetch person names:\", error);\n      } finally {\n        setIsLoading(false);\n      }\n    }\n    fetchPersons();\n  }, []);\n\n  return (\n    <PersonLinkerContext.Provider value={{ persons, isLoading }}>\n      {children}\n    </PersonLinkerContext.Provider>\n  );\n}\n\nexport function usePersonLinker() {\n  return useContext(PersonLinkerContext);\n}\n\ninterface PersonLinkProps {\n  name: string;\n  className?: string;\n  /** Optional: if we already know the person ID */\n  personId?: string;\n  /** Optional: Allabolag ID for external link */\n  allabolagId?: string;\n}\n\n/**\n * PersonLink - renders a person's name as a clickable link to their profile\n * If personId is provided, uses that directly\n * Otherwise, looks up the person in the PersonLinkerContext\n */\nexport function PersonLink({ name, className, personId, allabolagId }: PersonLinkProps) {\n  const { persons, isLoading } = usePersonLinker();\n\n  // If we have a personId prop (internal DB ID), use it directly\n  if (personId) {\n    return (\n      <Link\n        href={`/person/${personId}`}\n        className={className || \"text-primary hover:underline font-medium\"}\n      >\n        {name}\n      </Link>\n    );\n  }\n\n  // Wait for context to load before deciding\n  if (isLoading) {\n    return <span className={className}>{name}</span>;\n  }\n\n  // Priority 1: Look up by name in context (person exists in our DB)\n  const personInfo = persons[name];\n  if (personInfo) {\n    return (\n      <Link\n        href={`/person/${personInfo.id}`}\n        className={className || \"text-primary hover:underline font-medium\"}\n      >\n        {name}\n      </Link>\n    );\n  }\n\n  // Priority 2: If we have an allabolagId, link to the allabolag-based page (fallback)\n  if (allabolagId) {\n    return (\n      <Link\n        href={`/bolag/person/${allabolagId}?name=${encodeURIComponent(name)}`}\n        className={className || \"text-primary hover:underline font-medium\"}\n      >\n        {name}\n      </Link>\n    );\n  }\n\n  // No match found - render as plain text\n  return <span className={className}>{name}</span>;\n}\n\ninterface LinkedPersonTextProps {\n  text: string;\n  className?: string;\n}\n\n/**\n * LinkedPersonText - automatically converts person names in text to links\n * Similar to LinkedText for companies, but for persons\n */\nexport function LinkedPersonText({ text, className }: LinkedPersonTextProps) {\n  const { persons, isLoading } = usePersonLinker();\n\n  const linkedContent = useMemo(() => {\n    if (isLoading || !text || Object.keys(persons).length === 0) {\n      return text;\n    }\n\n    // Sort person names by length (longest first) to avoid partial matches\n    const sortedNames = Object.keys(persons).sort((a, b) => b.length - a.length);\n\n    // Build regex pattern - escape special chars and join with OR\n    const escapedNames = sortedNames.map(name =>\n      name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n    );\n\n    if (escapedNames.length === 0) return text;\n\n    const pattern = new RegExp(`(${escapedNames.join('|')})`, 'gi');\n    const parts = text.split(pattern);\n\n    return parts.map((part, index) => {\n      // Check if this part matches a person name (case-insensitive)\n      const matchedName = sortedNames.find(\n        name => name.toLowerCase() === part.toLowerCase()\n      );\n\n      if (matchedName) {\n        const personInfo = persons[matchedName];\n        return (\n          <Link\n            key={index}\n            href={`/person/${personInfo.id}`}\n            className=\"text-primary hover:underline font-medium\"\n          >\n            {part}\n          </Link>\n        );\n      }\n\n      return part;\n    });\n  }, [text, persons, isLoading]);\n\n  if (typeof linkedContent === \"string\") {\n    return <span className={className}>{linkedContent}</span>;\n  }\n\n  return <span className={className}>{linkedContent}</span>;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6900, "column": 0}, "map": {"version":3,"sources":["file:///Users/isak/CLAUDE/projects/1.%20Loop%20Desk/src/components/chat/ChatPanel.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useRef, useEffect, useCallback } from \"react\";\nimport { MessageCircle, X, Send, Loader2, Search, Database, Globe, Building2 } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface Message {\n  id: string;\n  role: \"user\" | \"assistant\";\n  content: string;\n  toolsUsed?: string[];\n}\n\n// Tool name to Swedish label mapping\nconst TOOL_LABELS: Record<string, { label: string; icon: typeof Search }> = {\n  search_companies: { label: \"Söker företag\", icon: Building2 },\n  get_company_details: { label: \"Hämtar företagsinfo\", icon: Database },\n  search_announcements: { label: \"Söker kungörelser\", icon: Search },\n  get_news: { label: \"Hämtar nyheter\", icon: Globe },\n  get_investors: { label: \"Söker investerare\", icon: Search },\n  search_persons: { label: \"Söker personer\", icon: Search },\n  compare_companies: { label: \"Jämför företag\", icon: Building2 },\n  analyze_industry: { label: \"Analyserar bransch\", icon: Database },\n  search_protocols: { label: \"Söker protokoll\", icon: Database },\n  match_investors: { label: \"Matchar investerare\", icon: Search },\n  manage_watchlist: { label: \"Bevakningslistan\", icon: Building2 },\n  web_search: { label: \"Söker på webben\", icon: Globe },\n  web_search_20250305: { label: \"Söker på webben\", icon: Globe },\n};\n\nexport function ChatPanel() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [input, setInput] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [activeTool, setActiveTool] = useState<string | null>(null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n  const panelRef = useRef<HTMLDivElement>(null);\n\n  // Scroll to bottom when messages change\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages, activeTool]);\n\n  // Focus input when panel opens\n  useEffect(() => {\n    if (isOpen) {\n      setTimeout(() => inputRef.current?.focus(), 300);\n    }\n  }, [isOpen]);\n\n  // Close panel when clicking outside\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent) {\n      if (panelRef.current && !panelRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    }\n\n    if (isOpen) {\n      document.addEventListener(\"mousedown\", handleClickOutside);\n    }\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n  }, [isOpen]);\n\n  // Close on Escape key\n  useEffect(() => {\n    function handleEscape(event: KeyboardEvent) {\n      if (event.key === \"Escape\") {\n        setIsOpen(false);\n      }\n    }\n\n    if (isOpen) {\n      document.addEventListener(\"keydown\", handleEscape);\n    }\n    return () => document.removeEventListener(\"keydown\", handleEscape);\n  }, [isOpen]);\n\n  const sendMessage = useCallback(async () => {\n    if (!input.trim() || isLoading) return;\n\n    const userMessage: Message = {\n      id: Date.now().toString(),\n      role: \"user\",\n      content: input.trim(),\n    };\n\n    const assistantMessageId = (Date.now() + 1).toString();\n    const toolsUsed: string[] = [];\n\n    setMessages((prev) => [...prev, userMessage]);\n    setInput(\"\");\n    setIsLoading(true);\n    setActiveTool(null);\n\n    // Add empty assistant message that will be streamed into\n    setMessages((prev) => [\n      ...prev,\n      {\n        id: assistantMessageId,\n        role: \"assistant\",\n        content: \"\",\n        toolsUsed: [],\n      },\n    ]);\n\n    try {\n      const response = await fetch(\"/api/chat\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          messages: [...messages, userMessage].map((m) => ({\n            role: m.role,\n            content: m.content,\n          })),\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to send message\");\n      }\n\n      const reader = response.body?.getReader();\n      const decoder = new TextDecoder();\n\n      if (!reader) {\n        throw new Error(\"No response body\");\n      }\n\n      // Read the stream\n      let buffer = \"\";\n      while (true) {\n        const { done, value } = await reader.read();\n        if (done) break;\n\n        buffer += decoder.decode(value, { stream: true });\n        const lines = buffer.split(\"\\n\");\n        buffer = lines.pop() || \"\";\n\n        for (const line of lines) {\n          if (line.startsWith(\"data: \")) {\n            const data = line.slice(6);\n            if (data === \"[DONE]\") {\n              setActiveTool(null);\n              continue;\n            }\n\n            try {\n              const parsed = JSON.parse(data);\n\n              if (parsed.tool) {\n                // Tool is being executed\n                setActiveTool(parsed.tool);\n                if (!toolsUsed.includes(parsed.tool)) {\n                  toolsUsed.push(parsed.tool);\n                  // Update the message with tools used\n                  setMessages((prev) =>\n                    prev.map((msg) =>\n                      msg.id === assistantMessageId\n                        ? { ...msg, toolsUsed: [...toolsUsed] }\n                        : msg\n                    )\n                  );\n                }\n              } else if (parsed.text) {\n                setActiveTool(null);\n                // Update the assistant message with the new text chunk\n                setMessages((prev) =>\n                  prev.map((msg) =>\n                    msg.id === assistantMessageId\n                      ? { ...msg, content: msg.content + parsed.text }\n                      : msg\n                  )\n                );\n              } else if (parsed.error) {\n                throw new Error(parsed.error);\n              }\n            } catch {\n              // Ignore parse errors for incomplete chunks\n            }\n          }\n        }\n      }\n    } catch {\n      // Update the assistant message with error\n      setMessages((prev) =>\n        prev.map((msg) =>\n          msg.id === assistantMessageId\n            ? { ...msg, content: msg.content || \"Något gick fel. Försök igen senare.\" }\n            : msg\n        )\n      );\n    } finally {\n      setIsLoading(false);\n      setActiveTool(null);\n    }\n  }, [input, isLoading, messages]);\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n\n  // Simple markdown-like formatting\n  const formatContent = (content: string) => {\n    // Split by double newlines for paragraphs\n    const paragraphs = content.split(/\\n\\n+/);\n\n    return paragraphs.map((paragraph, pIndex) => {\n      // Check for bullet points\n      if (paragraph.includes(\"\\n- \") || paragraph.startsWith(\"- \")) {\n        const items = paragraph.split(\"\\n\").filter(Boolean);\n        return (\n          <ul key={pIndex} className=\"list-disc pl-4 space-y-1 my-2\">\n            {items.map((item, iIndex) => (\n              <li key={iIndex}>{item.replace(/^- /, \"\")}</li>\n            ))}\n          </ul>\n        );\n      }\n\n      // Check for numbered lists\n      if (/^\\d+\\. /.test(paragraph)) {\n        const items = paragraph.split(\"\\n\").filter(Boolean);\n        return (\n          <ol key={pIndex} className=\"list-decimal pl-4 space-y-1 my-2\">\n            {items.map((item, iIndex) => (\n              <li key={iIndex}>{item.replace(/^\\d+\\. /, \"\")}</li>\n            ))}\n          </ol>\n        );\n      }\n\n      // Check for headers (** at start)\n      if (paragraph.startsWith(\"**\") && paragraph.endsWith(\"**\")) {\n        return (\n          <p key={pIndex} className=\"font-semibold mt-3 mb-1\">\n            {paragraph.slice(2, -2)}\n          </p>\n        );\n      }\n\n      // Regular paragraph with bold text support\n      const parts = paragraph.split(/(\\*\\*[^*]+\\*\\*)/g);\n      return (\n        <p key={pIndex} className=\"my-1\">\n          {parts.map((part, partIndex) => {\n            if (part.startsWith(\"**\") && part.endsWith(\"**\")) {\n              return <strong key={partIndex}>{part.slice(2, -2)}</strong>;\n            }\n            return <span key={partIndex}>{part}</span>;\n          })}\n        </p>\n      );\n    });\n  };\n\n  return (\n    <>\n      {/* Chat button */}\n      <button\n        onClick={() => setIsOpen(true)}\n        className={cn(\n          \"fixed bottom-6 right-6 z-50 flex items-center justify-center\",\n          \"w-14 h-14 rounded-full bg-primary text-primary-foreground\",\n          \"shadow-lg hover:shadow-xl transition-all duration-200\",\n          \"hover:scale-105 active:scale-95\",\n          isOpen && \"opacity-0 pointer-events-none\"\n        )}\n        aria-label=\"Öppna chat\"\n      >\n        <MessageCircle className=\"w-6 h-6\" />\n      </button>\n\n      {/* Backdrop */}\n      <div\n        className={cn(\n          \"fixed inset-0 z-40 bg-black/20 backdrop-blur-sm transition-opacity duration-300\",\n          isOpen ? \"opacity-100\" : \"opacity-0 pointer-events-none\"\n        )}\n        aria-hidden=\"true\"\n      />\n\n      {/* Chat panel */}\n      <div\n        ref={panelRef}\n        className={cn(\n          \"fixed top-0 right-0 z-50 h-full w-full sm:w-[420px] max-w-full\",\n          \"bg-background border-l border-border shadow-2xl\",\n          \"flex flex-col transition-transform duration-300 ease-out\",\n          isOpen ? \"translate-x-0\" : \"translate-x-full\"\n        )}\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between px-5 py-4 border-b border-border\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center\">\n              <MessageCircle className=\"w-4 h-4 text-primary\" />\n            </div>\n            <div>\n              <h2 className=\"font-medium text-sm\">LoopDesk Assistant</h2>\n              <p className=\"text-xs text-muted-foreground\">AI med databasåtkomst</p>\n            </div>\n          </div>\n          <button\n            onClick={() => setIsOpen(false)}\n            className=\"p-2 rounded-lg hover:bg-secondary transition-colors\"\n            aria-label=\"Stäng chat\"\n          >\n            <X className=\"w-5 h-5 text-muted-foreground\" />\n          </button>\n        </div>\n\n        {/* Messages */}\n        <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n          {messages.length === 0 && (\n            <div className=\"text-center py-8\">\n              <div className=\"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4\">\n                <MessageCircle className=\"w-6 h-6 text-primary\" />\n              </div>\n              <h3 className=\"font-medium mb-2\">Hej!</h3>\n              <p className=\"text-sm text-muted-foreground max-w-[280px] mx-auto mb-4\">\n                Jag kan hjälpa dig med företagsinfo, nyheter, kungörelser och investerare.\n              </p>\n              <div className=\"flex flex-wrap justify-center gap-2 text-xs\">\n                <button\n                  onClick={() => setInput(\"Vilka cleantech-bolag finns i Stockholm?\")}\n                  className=\"px-3 py-1.5 rounded-full bg-secondary hover:bg-secondary/80 transition-colors\"\n                >\n                  Cleantech i Stockholm\n                </button>\n                <button\n                  onClick={() => setInput(\"Visa senaste kungörelserna\")}\n                  className=\"px-3 py-1.5 rounded-full bg-secondary hover:bg-secondary/80 transition-colors\"\n                >\n                  Senaste kungörelser\n                </button>\n                <button\n                  onClick={() => setInput(\"Vilka VC:s investerar i impact?\")}\n                  className=\"px-3 py-1.5 rounded-full bg-secondary hover:bg-secondary/80 transition-colors\"\n                >\n                  Impact-investerare\n                </button>\n              </div>\n            </div>\n          )}\n\n          {messages.map((message) => (\n            <div\n              key={message.id}\n              className={cn(\n                \"flex\",\n                message.role === \"user\" ? \"justify-end\" : \"justify-start\"\n              )}\n            >\n              <div\n                className={cn(\n                  \"max-w-[90%] rounded-2xl px-4 py-2.5 text-sm\",\n                  message.role === \"user\"\n                    ? \"bg-primary text-primary-foreground rounded-br-md\"\n                    : \"bg-secondary text-foreground rounded-bl-md\"\n                )}\n              >\n                {/* Tools used indicator */}\n                {message.role === \"assistant\" && message.toolsUsed && message.toolsUsed.length > 0 && (\n                  <div className=\"flex flex-wrap gap-1.5 mb-2 pb-2 border-b border-border/50\">\n                    {message.toolsUsed.map((tool) => {\n                      const toolInfo = TOOL_LABELS[tool] || { label: tool, icon: Search };\n                      const Icon = toolInfo.icon;\n                      return (\n                        <span\n                          key={tool}\n                          className=\"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-background/50 text-xs text-muted-foreground\"\n                        >\n                          <Icon className=\"w-3 h-3\" />\n                          {toolInfo.label}\n                        </span>\n                      );\n                    })}\n                  </div>\n                )}\n\n                {message.role === \"user\" ? (\n                  <p className=\"whitespace-pre-wrap\">{message.content}</p>\n                ) : (\n                  <div className=\"prose prose-sm dark:prose-invert max-w-none\">\n                    {formatContent(message.content)}\n                  </div>\n                )}\n              </div>\n            </div>\n          ))}\n\n          {/* Active tool indicator */}\n          {activeTool && (\n            <div className=\"flex justify-start\">\n              <div className=\"bg-secondary rounded-2xl rounded-bl-md px-4 py-3 flex items-center gap-2\">\n                <Loader2 className=\"w-4 h-4 animate-spin text-primary\" />\n                <span className=\"text-sm text-muted-foreground\">\n                  {TOOL_LABELS[activeTool]?.label || activeTool}...\n                </span>\n              </div>\n            </div>\n          )}\n\n          {/* Loading indicator (no tool active) */}\n          {isLoading && !activeTool && messages[messages.length - 1]?.content === \"\" && (\n            <div className=\"flex justify-start\">\n              <div className=\"bg-secondary rounded-2xl rounded-bl-md px-4 py-3\">\n                <Loader2 className=\"w-4 h-4 animate-spin text-muted-foreground\" />\n              </div>\n            </div>\n          )}\n\n          <div ref={messagesEndRef} />\n        </div>\n\n        {/* Input */}\n        <div className=\"p-4 border-t border-border\">\n          <div className=\"flex items-end gap-2\">\n            <textarea\n              ref={inputRef}\n              value={input}\n              onChange={(e) => setInput(e.target.value)}\n              onKeyDown={handleKeyDown}\n              placeholder=\"Fråga om företag, nyheter, investerare...\"\n              rows={1}\n              className={cn(\n                \"flex-1 resize-none rounded-xl border border-border bg-secondary/50\",\n                \"px-4 py-3 text-sm placeholder:text-muted-foreground\",\n                \"focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary\",\n                \"max-h-32 min-h-[48px]\"\n              )}\n              style={{\n                height: \"auto\",\n                minHeight: \"48px\",\n              }}\n              onInput={(e) => {\n                const target = e.target as HTMLTextAreaElement;\n                target.style.height = \"auto\";\n                target.style.height = Math.min(target.scrollHeight, 128) + \"px\";\n              }}\n            />\n            <button\n              onClick={sendMessage}\n              disabled={!input.trim() || isLoading}\n              className={cn(\n                \"flex items-center justify-center w-12 h-12 rounded-xl\",\n                \"bg-primary text-primary-foreground\",\n                \"hover:bg-primary/90 transition-colors\",\n                \"disabled:opacity-50 disabled:cursor-not-allowed\"\n              )}\n              aria-label=\"Skicka meddelande\"\n            >\n              <Send className=\"w-5 h-5\" />\n            </button>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}