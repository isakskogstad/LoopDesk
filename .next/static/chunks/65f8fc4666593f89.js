;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="1a636661-ac37-73a5-4e2b-ce9f6d04c6a6")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,114826,e=>{e.v({actionRow:"widget-styles-module__4VxjhW__actionRow",addBtn:"widget-styles-module__4VxjhW__addBtn",btn:"widget-styles-module__4VxjhW__btn",btnDanger:"widget-styles-module__4VxjhW__btnDanger",btnGhost:"widget-styles-module__4VxjhW__btnGhost",btnLogo:"widget-styles-module__4VxjhW__btnLogo",btnPrimary:"widget-styles-module__4VxjhW__btnPrimary",btnPrimaryBlue:"widget-styles-module__4VxjhW__btnPrimaryBlue",btnSubtitle:"widget-styles-module__4VxjhW__btnSubtitle",btnSuccess:"widget-styles-module__4VxjhW__btnSuccess",btnText:"widget-styles-module__4VxjhW__btnText",btnTitle:"widget-styles-module__4VxjhW__btnTitle",button:"widget-styles-module__4VxjhW__button",chevron:"widget-styles-module__4VxjhW__chevron",companyCheckbox:"widget-styles-module__4VxjhW__companyCheckbox",companyCheckboxChecked:"widget-styles-module__4VxjhW__companyCheckboxChecked",companyFilter:"widget-styles-module__4VxjhW__companyFilter",companyFilterAction:"widget-styles-module__4VxjhW__companyFilterAction",companyFilterActions:"widget-styles-module__4VxjhW__companyFilterActions",companyFilterHeader:"widget-styles-module__4VxjhW__companyFilterHeader",companyFilterTitle:"widget-styles-module__4VxjhW__companyFilterTitle",companyItem:"widget-styles-module__4VxjhW__companyItem",companyItemSelected:"widget-styles-module__4VxjhW__companyItemSelected",companyList:"widget-styles-module__4VxjhW__companyList",companyName:"widget-styles-module__4VxjhW__companyName",companyOrgNr:"widget-styles-module__4VxjhW__companyOrgNr",confirmActions:"widget-styles-module__4VxjhW__confirmActions",confirmDialog:"widget-styles-module__4VxjhW__confirmDialog",confirmMessage:"widget-styles-module__4VxjhW__confirmMessage",confirmOverlay:"widget-styles-module__4VxjhW__confirmOverlay",confirmTitle:"widget-styles-module__4VxjhW__confirmTitle",detailLabel:"widget-styles-module__4VxjhW__detailLabel",detailRow:"widget-styles-module__4VxjhW__detailRow",detailValue:"widget-styles-module__4VxjhW__detailValue",detailValueHighlight:"widget-styles-module__4VxjhW__detailValueHighlight",expanded:"widget-styles-module__4VxjhW__expanded",expandedBody:"widget-styles-module__4VxjhW__expandedBody",expandedHeader:"widget-styles-module__4VxjhW__expandedHeader",expandedTitle:"widget-styles-module__4VxjhW__expandedTitle",expandedVisible:"widget-styles-module__4VxjhW__expandedVisible",fadeIn:"widget-styles-module__4VxjhW__fadeIn",formActions:"widget-styles-module__4VxjhW__formActions",formLabel:"widget-styles-module__4VxjhW__formLabel",formRow:"widget-styles-module__4VxjhW__formRow",headerActions:"widget-styles-module__4VxjhW__headerActions",headerBtn:"widget-styles-module__4VxjhW__headerBtn",input:"widget-styles-module__4VxjhW__input",inputGroup:"widget-styles-module__4VxjhW__inputGroup",loadingSpinner:"widget-styles-module__4VxjhW__loadingSpinner",loadingSpinnerBlue:"widget-styles-module__4VxjhW__loadingSpinnerBlue",logClear:"widget-styles-module__4VxjhW__logClear",logContent:"widget-styles-module__4VxjhW__logContent",logEmpty:"widget-styles-module__4VxjhW__logEmpty",logHeader:"widget-styles-module__4VxjhW__logHeader",logIn:"widget-styles-module__4VxjhW__logIn",logLine:"widget-styles-module__4VxjhW__logLine",logLineError:"widget-styles-module__4VxjhW__logLineError",logLineInfo:"widget-styles-module__4VxjhW__logLineInfo",logLineStep:"widget-styles-module__4VxjhW__logLineStep",logLineSuccess:"widget-styles-module__4VxjhW__logLineSuccess",logLineWarning:"widget-styles-module__4VxjhW__logLineWarning",logMsg:"widget-styles-module__4VxjhW__logMsg",logPanel:"widget-styles-module__4VxjhW__logPanel",logTime:"widget-styles-module__4VxjhW__logTime",logTitle:"widget-styles-module__4VxjhW__logTitle",menu:"widget-styles-module__4VxjhW__menu",menuClose:"widget-styles-module__4VxjhW__menuClose",menuDesc:"widget-styles-module__4VxjhW__menuDesc",menuHeader:"widget-styles-module__4VxjhW__menuHeader",menuIcon:"widget-styles-module__4VxjhW__menuIcon",menuIconBlue:"widget-styles-module__4VxjhW__menuIconBlue",menuItem:"widget-styles-module__4VxjhW__menuItem",menuItems:"widget-styles-module__4VxjhW__menuItems",menuLabel:"widget-styles-module__4VxjhW__menuLabel",menuTitle:"widget-styles-module__4VxjhW__menuTitle",menuTitleIcon:"widget-styles-module__4VxjhW__menuTitleIcon",menuTitleIconBlue:"widget-styles-module__4VxjhW__menuTitleIconBlue",menuTitleIconGreen:"widget-styles-module__4VxjhW__menuTitleIconGreen",menuVisible:"widget-styles-module__4VxjhW__menuVisible",newSchedule:"widget-styles-module__4VxjhW__newSchedule",progress:"widget-styles-module__4VxjhW__progress",progressBar:"widget-styles-module__4VxjhW__progressBar",progressFill:"widget-styles-module__4VxjhW__progressFill",progressFillBlue:"widget-styles-module__4VxjhW__progressFillBlue",progressText:"widget-styles-module__4VxjhW__progressText",progressWithText:"widget-styles-module__4VxjhW__progressWithText",project:"widget-styles-module__4VxjhW__project",projectDetails:"widget-styles-module__4VxjhW__projectDetails",projectExpanded:"widget-styles-module__4VxjhW__projectExpanded",projectHeader:"widget-styles-module__4VxjhW__projectHeader",projectId:"widget-styles-module__4VxjhW__projectId",projectTitle:"widget-styles-module__4VxjhW__projectTitle",projects:"widget-styles-module__4VxjhW__projects",pulse:"widget-styles-module__4VxjhW__pulse",rateLimitWarning:"widget-styles-module__4VxjhW__rateLimitWarning",retryBtn:"widget-styles-module__4VxjhW__retryBtn",scheduleItem:"widget-styles-module__4VxjhW__scheduleItem",scheduleList:"widget-styles-module__4VxjhW__scheduleList",scheduleName:"widget-styles-module__4VxjhW__scheduleName",scheduleTime:"widget-styles-module__4VxjhW__scheduleTime",sectionTitle:"widget-styles-module__4VxjhW__sectionTitle",select:"widget-styles-module__4VxjhW__select",slideDown:"widget-styles-module__4VxjhW__slideDown",spin:"widget-styles-module__4VxjhW__spin",statCard:"widget-styles-module__4VxjhW__statCard",statContent:"widget-styles-module__4VxjhW__statContent",statLabel:"widget-styles-module__4VxjhW__statLabel",statValue:"widget-styles-module__4VxjhW__statValue",statValueOnline:"widget-styles-module__4VxjhW__statValueOnline",statValueSuccess:"widget-styles-module__4VxjhW__statValueSuccess",statsGrid:"widget-styles-module__4VxjhW__statsGrid",statusDot:"widget-styles-module__4VxjhW__statusDot",statusDotOnline:"widget-styles-module__4VxjhW__statusDotOnline",statusDotWorking:"widget-styles-module__4VxjhW__statusDotWorking",statusDotWorkingBlue:"widget-styles-module__4VxjhW__statusDotWorkingBlue",summary:"widget-styles-module__4VxjhW__summary",summaryItem:"widget-styles-module__4VxjhW__summaryItem",summaryItemError:"widget-styles-module__4VxjhW__summaryItemError",summaryItemSuccess:"widget-styles-module__4VxjhW__summaryItemSuccess",toggle:"widget-styles-module__4VxjhW__toggle",toggleActive:"widget-styles-module__4VxjhW__toggleActive",view:"widget-styles-module__4VxjhW__view",widget:"widget-styles-module__4VxjhW__widget",widgetContainer:"widget-styles-module__4VxjhW__widgetContainer"})},659836,e=>{"use strict";var s=e.i(206266),a=e.i(85781),t=e.i(247032),l=e.i(672332),n=e.i(715795),i=e.i(765597);function d(){let{data:e,status:d}=(0,l.useSession)(),[r,c]=(0,t.useState)([]),[o,u]=(0,t.useState)(!1),m=(0,t.useRef)(!1);return((0,t.useEffect)(()=>{(async()=>{if(c((0,i.getLocalFavorites)()),"authenticated"===d&&e?.user&&!m.current)try{let e=await fetch("/api/bolag/favorites");if(e.ok){let s=await e.json();s.favorites&&(c(s.favorites),function(e){try{localStorage.setItem("bolagsinfo_favorites",JSON.stringify(e))}catch{}}(s.favorites),m.current=!0)}}catch{}u(!0)})()},[e?.user,d]),(0,t.useEffect)(()=>{(async()=>{if("authenticated"!==d||!e?.user||m.current)return;let s=(0,i.getLocalFavorites)();if(0!==s.length)try{let e=await fetch("/api/bolag/favorites");if(e.ok){let s=await e.json();if(s.favorites&&s.favorites.length>0)return}for(let e of s)await fetch("/api/bolag/favorites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgNumber:e.orgNumber,name:e.name})})}catch{}})()},[e?.user,d]),o&&0!==r.length)?(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{className:"pb-3",children:(0,s.jsx)(a.CardTitle,{className:"text-lg",children:"Bevakade bolag"})}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)("div",{className:"space-y-2",children:r.map(e=>{var a;let t;return(0,s.jsxs)(n.default,{href:`/bolag/${e.orgNumber}`,className:"block p-2 rounded hover:bg-secondary dark:hover:bg-gray-800 transition-colors",children:[(0,s.jsx)("p",{className:"font-medium text-sm",children:e.name}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:10===(t=(a=e.orgNumber).replace(/\D/g,"")).length?`${t.slice(0,6)}-${t.slice(6)}`:a})]},e.orgNumber)})})})]}):null}let r="bolagsinfo-search-history";function c(){try{let e=localStorage.getItem(r);return e?JSON.parse(e):[]}catch{return[]}}function o(e){try{localStorage.setItem(r,JSON.stringify(e))}catch{}}function u({history:e,onClear:a}){return 0===e.length?null:(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Senaste sökningar"}),(0,s.jsx)("button",{onClick:a,className:"text-xs text-muted-foreground/70 hover:text-muted-foreground",children:"Rensa"})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(e=>{var a;let t;return(0,s.jsxs)(n.default,{href:`/bolag/${e.orgNr}`,className:"inline-flex items-center px-3 py-1.5 text-sm bg-secondary rounded-full hover:bg-secondary dark:hover:bg-gray-700 transition-colors",children:[(0,s.jsx)("span",{className:"font-medium truncate max-w-[150px]",children:e.name}),(0,s.jsx)("span",{className:"ml-2 text-muted-foreground/70 text-xs",children:10===(t=(a=e.orgNr).replace(/\D/g,"")).length?`${t.slice(0,6)}-${t.slice(6)}`:a})]},e.orgNr)})})]})}var m=e.i(176480),h=e.i(154349),g=e.i(569394),f=e.i(212298),x=e.i(541912),j=e.i(272683),p=e.i(136565),N=e.i(480967),v=e.i(660447);function b({placeholder:e="Sök företag...",recentSearches:a=[],onSelectResult:l,className:n}){let[i,d]=(0,t.useState)(""),[r,c]=(0,t.useState)([]),[o,u]=(0,t.useState)(!1),[b,y]=(0,t.useState)(!1),[_,w]=(0,t.useState)(-1),[k,S]=(0,t.useState)(null),$=(0,t.useRef)(null),C=(0,t.useRef)(null),L=(0,m.useRouter)();(0,t.useEffect)(()=>{let e=e=>{C.current&&!C.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,t.useEffect)(()=>{if(i.length<2){c([]),S(null);return}let e=new AbortController,s=setTimeout(async()=>{u(!0),S(null);try{let s=await fetch(`/api/bolag/search?q=${encodeURIComponent(i)}`,{signal:e.signal}),a=await s.json();s.ok?(c(a.results||[]),a.results?.length===0&&S("Inga företag hittades")):S(a.error||"Ett fel uppstod")}catch(e){"AbortError"!==e.name&&S("Ett fel uppstod vid sökning")}finally{u(!1)}},250);return()=>{e.abort(),clearTimeout(s)}},[i]);let T=(0,t.useCallback)(e=>{let s=i.length>=2?r:a;if("ArrowDown"===e.key)e.preventDefault(),w(e=>Math.min(e+1,s.length-1));else if("ArrowUp"===e.key)e.preventDefault(),w(e=>Math.max(e-1,-1));else if("Enter"===e.key){if(e.preventDefault(),_>=0&&s[_])V(s[_]);else if(i.length>=2){let e=i.replace(/\D/g,"");(10===e.length||12===e.length)&&(L.push(`/bolag/${e}`),y(!1))}}else"Escape"===e.key&&(y(!1),$.current?.blur())},[i,r,a,_,L]),V=e=>{l&&l(e),L.push(`/bolag/${e.orgNr}`),y(!1),d("")},I=b&&(i.length>=2||a.length>0),W=i.length>=2,E=W?r:a.slice(0,5);return(0,s.jsxs)("div",{ref:C,className:(0,p.cn)("relative",n),children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(h.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"}),(0,s.jsx)("input",{ref:$,type:"text",value:i,onChange:e=>{d(e.target.value),w(-1),y(!0)},onFocus:()=>y(!0),onKeyDown:T,placeholder:e,className:(0,p.cn)("w-full h-11 pl-10 pr-4 rounded-xl border border-border bg-background","text-sm placeholder:text-muted-foreground","focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent","transition-all duration-200",b&&"ring-2 ring-ring border-transparent")}),o&&(0,s.jsx)(f.Loader2,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground animate-spin"})]}),(0,s.jsx)(v.AnimatePresence,{children:I&&(0,s.jsxs)(N.motion.div,{initial:{opacity:0,y:-8,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.98},transition:{duration:.15,ease:[.25,.1,.25,1]},className:(0,p.cn)("absolute top-full left-0 right-0 mt-2 z-50","rounded-xl border border-border/50 shadow-xl overflow-hidden","bg-background/95 backdrop-blur-xl"),children:[(0,s.jsx)("div",{className:"px-3 py-2 border-b border-border/50",children:(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:W?o?"Söker...":k||`${r.length} tr\xe4ffar`:(0,s.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(x.Clock,{className:"h-3 w-3"}),"Senaste sökningar"]})})}),(0,s.jsx)("div",{className:"max-h-80 overflow-y-auto",children:E.length>0?(0,s.jsx)("div",{className:"py-1",children:E.map((e,a)=>{var t;let l;return(0,s.jsxs)("button",{onClick:()=>V(e),onMouseEnter:()=>w(a),className:(0,p.cn)("w-full px-3 py-2.5 flex items-center gap-3 text-left transition-colors",_===a?"bg-secondary":"hover:bg-secondary/50"),children:[(0,s.jsx)("div",{className:(0,p.cn)("w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0",_===a?"bg-foreground text-background":"bg-secondary"),children:(0,s.jsx)(g.Building2,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"font-medium text-sm truncate",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[10===(l=(t=e.orgNr).replace(/\D/g,"")).length?`${l.slice(0,6)}-${l.slice(6)}`:t,"location"in e&&e.location&&` • ${e.location}`]})]}),_===a&&(0,s.jsx)(j.ArrowRight,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"})]},e.orgNr)})}):!W||o||k?null:(0,s.jsx)("div",{className:"px-3 py-6 text-center text-sm text-muted-foreground",children:"Inga resultat"})}),(0,s.jsx)("div",{className:"px-3 py-2 border-t border-border/50 bg-secondary/30",children:(0,s.jsxs)("p",{className:"text-[11px] text-muted-foreground",children:[(0,s.jsx)("kbd",{className:"px-1.5 py-0.5 bg-background rounded text-[10px] font-mono",children:"↑↓"})," ","navigera",(0,s.jsx)("span",{className:"mx-2",children:"•"}),(0,s.jsx)("kbd",{className:"px-1.5 py-0.5 bg-background rounded text-[10px] font-mono",children:"↵"})," ","välj",(0,s.jsx)("span",{className:"mx-2",children:"•"}),(0,s.jsx)("kbd",{className:"px-1.5 py-0.5 bg-background rounded text-[10px] font-mono",children:"esc"})," ","stäng"]})})]})})]})}var y=e.i(693794),_=e.i(646905),w=e.i(731846),k=e.i(845914);function S(e,s,a=!0){(0,t.useEffect)(()=>{if(!a)return;function t(a){e.current&&!e.current.contains(a.target)&&s()}let l=setTimeout(()=>{document.addEventListener("mousedown",t)},10);return()=>{clearTimeout(l),document.removeEventListener("mousedown",t)}},[e,s,a])}var $=e.i(114826);function C(){let e=(0,m.useRouter)(),[a,l]=(0,t.useState)("button"),[n,i]=(0,t.useState)("search"),[d,r]=(0,t.useState)("online"),[c,o]=(0,t.useState)(!1),[u,f]=(0,t.useState)(!1),[j,p]=(0,t.useState)(""),[N,v]=(0,t.useState)([]),[b,C]=(0,t.useState)(!1),[L,T]=(0,t.useState)([]),[V,I]=(0,t.useState)([]),[W,E]=(0,t.useState)([]),[A,B]=(0,t.useState)(!1),[R,D]=(0,t.useState)(!1),F=(0,t.useRef)(0),H=(0,t.useRef)(null),P=(0,t.useRef)(null),O=(0,t.useRef)(null);S(P,()=>{"menu"===a&&U(),"expanded"===a&&X()},"button"!==a);let G=(0,t.useCallback)((e,s="info")=>{let a=new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),t={id:`log-${++F.current}`,time:a,message:e,type:s};T(e=>[...e.slice(-50),t])},[]);(0,t.useEffect)(()=>{H.current&&(H.current.scrollTop=H.current.scrollHeight)},[L]),(0,t.useEffect)(()=>{try{let e=localStorage.getItem("bolagsverket-recent-searches");if(e){let s=JSON.parse(e);I(s.slice(0,5))}}catch{}},[]),(0,t.useEffect)(()=>{D(b)},[b]);let K=(e,s)=>{let a={orgNr:e,name:s,timestamp:Date.now()};I(s=>{let t=[a,...s.filter(s=>s.orgNr!==e)].slice(0,5);try{localStorage.setItem("bolagsverket-recent-searches",JSON.stringify(t))}catch{}return t})},M=()=>T([]),U=()=>{o(!1),setTimeout(()=>l("button"),250)},z=e=>{o(!1),i(e),setTimeout(()=>{l("expanded"),setTimeout(()=>f(!0),10)},180),r("online")},J=(0,t.useCallback)(async()=>{B(!0);try{let e=await fetch("/api/bevakning");if(e.ok){let s=await e.json();E(s.companies||[])}}catch{}B(!1)},[]);(0,t.useEffect)(()=>{"expanded"===a&&"fetched"===n&&J()},[a,n,J]);let q=async()=>{G("Testar anslutning...","step"),r("working");try{let e=await fetch("/api/health");if(e.ok){let s=await e.json();G("API: OK","success"),G(`Databas: ${"connected"===s.database?"OK":"Fel"}`,"connected"===s.database?"success":"error"),s.proxy&&G(`Proxy: ${"active"===s.proxy.status?"OK":"Inaktiv"}`,"active"===s.proxy.status?"success":"warning"),G("Anslutning verifierad","success")}else G("Anslutning misslyckades","error")}catch{G("Kunde inte nå servern","error")}r("online")},X=()=>{f(!1),setTimeout(()=>l("button"),220)},Q=(0,t.useCallback)(async(e,s=0)=>{if(!e.trim()||e.length<2)return void v([]);C(!0),r("working"),G(`S\xf6ker: "${e}"...`,"step");try{let s=await fetch(`/api/bolag/search?q=${encodeURIComponent(e.trim())}`);if(!s.ok)throw Error(`API error: ${s.status}`);let a=await s.json();a.results&&a.results.length>0?(v(a.results.slice(0,8)),G(`Hittade ${a.results.length} bolag`,"success")):(v([]),G("Inga bolag hittades","warning"))}catch(t){let a=t instanceof Error?t.message:"Okänt fel";if(s<2)return G(`Fel: ${a}. F\xf6rs\xf6ker igen...`,"warning"),await new Promise(e=>setTimeout(e,1e3)),Q(e,s+1);G(`Fel: ${a}`,"error"),v([])}r("online"),C(!1)},[G]);return(0,s.jsxs)("div",{className:$.default.widget,ref:P,children:["button"===a&&(0,s.jsxs)("button",{className:$.default.button,onClick:()=>{l("menu"),setTimeout(()=>o(!0),10)},disabled:R,children:[(0,s.jsx)("div",{className:$.default.btnLogo,children:(0,s.jsx)("img",{src:"/logos/bolagsverket.png",alt:"Bolagsverket"})}),(0,s.jsx)("span",{className:$.default.btnSubtitle,children:"Bolagssök"}),(0,s.jsx)(y.ChevronRight,{className:`${$.default.chevron} w-4 h-4`}),R&&(0,s.jsx)("div",{className:$.default.loadingSpinner})]}),"menu"===a&&(0,s.jsxs)("div",{className:`${$.default.menu} ${c?$.default.menuVisible:""}`,children:[(0,s.jsxs)("div",{className:$.default.menuHeader,children:[(0,s.jsxs)("div",{className:$.default.menuTitle,children:[(0,s.jsx)("div",{className:`${$.default.menuTitleIcon} ${$.default.menuTitleIconGreen}`,children:(0,s.jsx)(g.Building2,{className:"w-3 h-3"})}),"Bolagsverket"]}),(0,s.jsx)("button",{className:$.default.menuClose,onClick:U,children:(0,s.jsx)(w.X,{className:"w-3.5 h-3.5"})})]}),(0,s.jsxs)("div",{className:$.default.menuItems,children:[(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>z("search"),children:[(0,s.jsx)("div",{className:$.default.menuIcon,children:(0,s.jsx)(h.Search,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Sök bolag"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"Sök på namn eller org.nr"})]})]}),(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>z("fetched"),children:[(0,s.jsx)("div",{className:$.default.menuIcon,children:(0,s.jsx)(g.Building2,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Hämtade bolag"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"Visa bevakade bolag"})]})]}),(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>z("status"),children:[(0,s.jsx)("div",{className:$.default.menuIcon,children:(0,s.jsx)(k.Activity,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Status"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"Anslutning och hälsa"})]})]})]})]}),"expanded"===a&&(0,s.jsxs)("div",{className:`${$.default.expanded} ${u?$.default.expandedVisible:""}`,children:[(0,s.jsxs)("div",{className:$.default.expandedHeader,children:[(0,s.jsxs)("div",{className:$.default.expandedTitle,children:[(0,s.jsx)("div",{className:`${$.default.statusDot} ${"online"===d?$.default.statusDotOnline:"working"===d?$.default.statusDotWorking:""}`}),(0,s.jsx)("span",{children:"search"===n?"Sök bolag":"fetched"===n?"Hämtade bolag":"Status"})]}),(0,s.jsxs)("div",{className:$.default.headerActions,children:[(0,s.jsx)("button",{className:$.default.headerBtn,onClick:()=>{f(!1),setTimeout(()=>{l("menu"),setTimeout(()=>o(!0),10)},220)},children:(0,s.jsx)(_.ChevronLeft,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{className:$.default.headerBtn,onClick:X,children:(0,s.jsx)(w.X,{className:"w-3.5 h-3.5"})})]})]}),(0,s.jsxs)("div",{className:$.default.expandedBody,children:["search"===n&&(0,s.jsxs)("div",{className:$.default.view,children:[(0,s.jsxs)("div",{className:$.default.inputGroup,children:[(0,s.jsx)("input",{type:"text",className:$.default.input,placeholder:"Företagsnamn eller org.nr...",value:j,onChange:e=>{var s;p(s=e.target.value),O.current&&clearTimeout(O.current),s.length>=2?O.current=setTimeout(()=>{Q(s)},300):v([])},onKeyDown:e=>"Enter"===e.key&&Q(j),autoFocus:!0}),(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnPrimary}`,onClick:()=>Q(j),disabled:b||j.length<2,children:b?"...":"Sök"})]}),N.length>0&&(0,s.jsxs)("div",{className:$.default.projects,children:[(0,s.jsxs)("div",{className:$.default.sectionTitle,children:[(0,s.jsx)(g.Building2,{className:"w-3.5 h-3.5"}),"Resultat (",N.length,")"]}),N.map(a=>(0,s.jsx)("div",{className:$.default.project,onClick:()=>{K(a.orgNr,a.name),G(`\xd6ppnar: ${a.name}`,"success"),X(),e.push(`/bolag/${a.orgNr}`)},children:(0,s.jsxs)("div",{className:$.default.projectHeader,children:[(0,s.jsx)("div",{className:$.default.projectTitle,children:a.name}),(0,s.jsx)("div",{className:$.default.projectId,children:a.orgNr})]})},a.orgNr))]}),0===N.length&&V.length>0&&!j&&(0,s.jsxs)("div",{className:$.default.projects,children:[(0,s.jsxs)("div",{className:$.default.sectionTitle,children:[(0,s.jsx)(x.Clock,{className:"w-3.5 h-3.5"}),"Senaste sökningar"]}),V.map(a=>(0,s.jsx)("div",{className:$.default.project,onClick:()=>{K(a.orgNr,a.name),X(),e.push(`/bolag/${a.orgNr}`)},children:(0,s.jsxs)("div",{className:$.default.projectHeader,children:[(0,s.jsx)("div",{className:$.default.projectTitle,children:a.name}),(0,s.jsx)("div",{className:$.default.projectId,children:a.orgNr})]})},a.orgNr))]}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),L.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:M,children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,ref:H,children:0===L.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Sök efter ett företag för att se aktivitet"}):L.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]}),"fetched"===n&&(0,s.jsxs)("div",{className:$.default.view,children:[A?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Laddar bolag..."}):0===W.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Inga bevakade bolag ännu"}):(0,s.jsxs)("div",{className:$.default.projects,children:[(0,s.jsxs)("div",{className:$.default.sectionTitle,children:[(0,s.jsx)(g.Building2,{className:"w-3.5 h-3.5"}),"Bevakade bolag (",W.length,")"]}),W.map(a=>(0,s.jsx)("div",{className:$.default.project,onClick:()=>{X(),e.push(`/bolag/${a.orgNumber}`)},children:(0,s.jsxs)("div",{className:$.default.projectHeader,children:[(0,s.jsx)("div",{className:$.default.projectTitle,children:a.name}),(0,s.jsx)("div",{className:$.default.projectId,children:a.orgNumber})]})},a.id))]}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),L.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:M,children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,ref:H,children:0===L.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Ingen aktivitet"}):L.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]}),"status"===n&&(0,s.jsxs)("div",{className:$.default.view,children:[(0,s.jsxs)("div",{className:$.default.statsGrid,children:[(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(k.Activity,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"API"}),(0,s.jsx)("div",{className:`${$.default.statValue} ${$.default.statValueOnline}`,children:"Ansluten"})]})]}),(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(g.Building2,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"Bevakade"}),(0,s.jsx)("div",{className:$.default.statValue,children:W.length})]})]})]}),(0,s.jsx)("div",{className:$.default.actionRow,children:(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnGhost}`,onClick:q,children:"Testa anslutning"})}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),L.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:M,children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,ref:H,children:0===L.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Ingen aktivitet"}):L.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]})]})]})]})}var L=e.i(431899);let T=(0,e.i(690972).default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var V=e.i(916092),I=e.i(862759),W=e.i(959968);function E(){let[e,a]=(0,t.useState)("button"),[l,n]=(0,t.useState)("search"),[i,d]=(0,t.useState)("online"),[r,c]=(0,t.useState)(!1),[o,u]=(0,t.useState)(!1),[m,f]=(0,t.useState)(""),[j,p]=(0,t.useState)([]),[N,v]=(0,t.useState)(0),[b,C]=(0,t.useState)(!1),[E,A]=(0,t.useState)([]),[B,R]=(0,t.useState)(null),[D,F]=(0,t.useState)(null),[H,P]=(0,t.useState)([]),[O,G]=(0,t.useState)(!1),[K,M]=(0,t.useState)(0),[U,z]=(0,t.useState)("--:--"),[J,q]=(0,t.useState)([]),[X,Q]=(0,t.useState)([]),[Z,Y]=(0,t.useState)(!1),ee=(0,t.useRef)(0),es=(0,t.useRef)(null),ea=(0,t.useRef)(null),et=(0,t.useRef)(!1);S(ea,()=>{"menu"===e&&ed(),"expanded"===e&&ec()},"button"!==e);let el=(0,t.useCallback)((e,s,a="info")=>{let t=new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),l={id:`log-${++ee.current}`,time:t,message:s,type:a};"search"===e?A(e=>[...e.slice(-50),l]):"batch"===e?P(e=>[...e.slice(-50),l]):Q(e=>[...e.slice(-50),l])},[]);(0,t.useEffect)(()=>{es.current&&(es.current.scrollTop=es.current.scrollHeight)},[E,H,X]);let en=(0,t.useCallback)(async()=>{try{let e=await fetch("/api/bevakning");if(e.ok){let s=await e.json();q(s.companies||[])}}catch(e){console.error("Failed to fetch watched companies:",e)}},[]);(0,t.useEffect)(()=>{"expanded"===e&&"batch"===l&&en()},[e,l,en]),(0,t.useEffect)(()=>{Y(b||O)},[b,O]);let ei=e=>{"search"===e?A([]):"batch"===e?P([]):Q([])},ed=()=>{c(!1),setTimeout(()=>a("button"),250)},er=e=>{c(!1),n(e),setTimeout(()=>{a("expanded"),setTimeout(()=>u(!0),10)},180),d("online")},ec=()=>{u(!1),setTimeout(()=>a("button"),220)},eo=async(e=0)=>{if(m.trim()){C(!0),d("working"),p([]),R(null),v(0),F(null),el("search",`Initierar s\xf6kning...`,"step"),await eu(200),v(10),el("search","Ansluter till Vinnova API...","step"),await eu(300),v(25),el("search",`S\xf6ker: "${m}"`,"info"),v(40);try{let e=new URLSearchParams;e.set("company",m.trim()),el("search",`H\xe4mtar projektdata...`,"step");let s=await fetch(`/api/bolag/vinnova?${e.toString()}`);if(v(70),!s.ok)throw Error(`API error: ${s.status}`);el("search","Bearbetar resultat...","step");let a=await s.json();if(v(90),await eu(200),a.projects&&a.projects.length>0){let e=a.projects.slice(0,10);p(e);let s=e.reduce((e,s)=>e+(s.vinnovaBidrag||0),0);el("search",`Hittade ${a.projects.length} projekt`,"success"),s>0&&el("search",`Total finansiering: ${em(s)}`,"info")}else el("search","Inga Vinnova-projekt hittades för detta bolag","warning");v(100)}catch(a){let s=a instanceof Error?a.message:"Okänt fel";if(e<2)return el("search",`Fel: ${s}. F\xf6rs\xf6ker igen...`,"warning"),await eu(1e3),eo(e+1);el("search",`Fel: ${s}`,"error"),F(s)}await eu(300),d("online"),C(!1),setTimeout(()=>v(0),500)}},eu=e=>new Promise(s=>setTimeout(s,e)),em=e=>e>=1e6?`${(e/1e6).toFixed(1)} MSEK`:new Intl.NumberFormat("sv-SE",{style:"currency",currency:"SEK",maximumFractionDigits:0}).format(e),eh=async()=>{el("status","Testar anslutning...","step"),d("working"),await eu(500);try{(await fetch("/api/health")).ok?(el("status","API: OK","success"),el("status","Databas: OK","success"),el("status","Anslutning verifierad","success")):el("status","Anslutning misslyckades","error")}catch{el("status","Kunde inte nå servern","error")}d("online")},eg=async()=>{if(O){et.current=!1,G(!1),el("batch","Avbruten av användare","warning"),d("online"),M(0);return}let e=J;if(0===e.length){el("batch","Hämtar bevakade bolag...","step");try{let s=await fetch("/api/bevakning");s.ok&&(e=(await s.json()).companies||[],q(e))}catch{el("batch","Kunde inte hämta bevakade bolag","error");return}}if(0===e.length)return void el("batch","Inga bevakade bolag att söka","warning");et.current=!0,G(!0),el("batch",`Startar s\xf6kning f\xf6r ${e.length} bolag...`,"step"),d("working"),M(0);let s=0,a=0;for(let t=0;t<e.length&&et.current;t++){let l=e[t],n=(t+1)/e.length*100;el("batch",`S\xf6ker: ${l.name}...`,"info"),M(n-5);try{let e=await fetch(`/api/bolag/vinnova?company=${encodeURIComponent(l.name)}`);if(!et.current)break;if(e.ok){let t=await e.json(),n=t.projects?.length||0;n>0?(el("batch",`${l.name}: ${n} projekt`,"success"),a+=n):el("batch",`${l.name}: Inga projekt`,"info"),s++}else el("batch",`${l.name}: API-fel`,"warning")}catch{el("batch",`${l.name}: Misslyckades`,"error")}M(n),et.current&&t<e.length-1&&await eu(500)}et.current&&(el("batch",`K\xf6rning slutf\xf6rd: ${s}/${e.length} bolag, ${a} projekt`,"success"),z(new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"}))),et.current=!1,G(!1),d("online"),setTimeout(()=>M(0),1e3)};return(0,t.useEffect)(()=>()=>{et.current=!1},[]),(0,s.jsxs)("div",{className:$.default.widget,ref:ea,children:["button"===e&&(0,s.jsxs)("button",{className:$.default.button,onClick:()=>{a("menu"),setTimeout(()=>c(!0),10)},disabled:Z,children:[(0,s.jsx)("div",{className:$.default.btnLogo,children:(0,s.jsx)("img",{src:"/logos/vinnova.png",alt:"Vinnova"})}),(0,s.jsx)("span",{className:$.default.btnSubtitle,children:"Innovationsprojekt"}),(0,s.jsx)(y.ChevronRight,{className:`${$.default.chevron} w-4 h-4`}),Z&&(0,s.jsx)("div",{className:$.default.loadingSpinner})]}),"menu"===e&&(0,s.jsxs)("div",{className:`${$.default.menu} ${r?$.default.menuVisible:""}`,children:[(0,s.jsxs)("div",{className:$.default.menuHeader,children:[(0,s.jsxs)("div",{className:$.default.menuTitle,children:[(0,s.jsx)("div",{className:`${$.default.menuTitleIcon} ${$.default.menuTitleIconGreen}`,children:(0,s.jsx)(V.Zap,{className:"w-3 h-3"})}),"Vinnova Scraper"]}),(0,s.jsx)("button",{className:$.default.menuClose,onClick:ed,children:(0,s.jsx)(w.X,{className:"w-3.5 h-3.5"})})]}),(0,s.jsxs)("div",{className:$.default.menuItems,children:[(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>er("search"),children:[(0,s.jsx)("div",{className:$.default.menuIcon,children:(0,s.jsx)(h.Search,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Sök projekt"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"Hitta Vinnova-projekt för företag"})]})]}),(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>er("batch"),children:[(0,s.jsx)("div",{className:$.default.menuIcon,children:(0,s.jsx)(W.RefreshCw,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Sök alla bevakade"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"Kör sökning för alla bevakade bolag"})]})]}),(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>er("status"),children:[(0,s.jsx)("div",{className:$.default.menuIcon,children:(0,s.jsx)(k.Activity,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Status"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"Anslutning och hälsa"})]})]})]})]}),"expanded"===e&&(0,s.jsxs)("div",{className:`${$.default.expanded} ${o?$.default.expandedVisible:""}`,children:[(0,s.jsxs)("div",{className:$.default.expandedHeader,children:[(0,s.jsxs)("div",{className:$.default.expandedTitle,children:[(0,s.jsx)("div",{className:`${$.default.statusDot} ${"online"===i?$.default.statusDotOnline:"working"===i?$.default.statusDotWorking:""}`}),(0,s.jsx)("span",{children:{search:"Sök projekt",batch:"Sök alla bevakade",status:"Status"}[l]})]}),(0,s.jsxs)("div",{className:$.default.headerActions,children:[(0,s.jsx)("button",{className:$.default.headerBtn,onClick:()=>{u(!1),setTimeout(()=>{a("menu"),setTimeout(()=>c(!0),10)},220)},children:(0,s.jsx)(_.ChevronLeft,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{className:$.default.headerBtn,onClick:ec,children:(0,s.jsx)(w.X,{className:"w-3.5 h-3.5"})})]})]}),(0,s.jsxs)("div",{className:$.default.expandedBody,children:["search"===l&&(0,s.jsxs)("div",{className:$.default.view,children:[(0,s.jsxs)("div",{className:$.default.inputGroup,children:[(0,s.jsx)("input",{type:"text",className:$.default.input,placeholder:"Sök bolagsnamn...",value:m,onChange:e=>f(e.target.value),onKeyDown:e=>"Enter"===e.key&&eo()}),(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnPrimary}`,onClick:()=>eo(),disabled:b,children:b?"...":"Sök"})]}),D&&(0,s.jsxs)("button",{className:$.default.retryBtn,onClick:()=>{F(null),eo()},children:[(0,s.jsx)(W.RefreshCw,{className:"w-3.5 h-3.5"}),"Försök igen"]}),N>0&&(0,s.jsx)("div",{className:$.default.progress,children:(0,s.jsx)("div",{className:$.default.progressBar,children:(0,s.jsx)("div",{className:$.default.progressFill,style:{width:`${N}%`}})})}),j.length>0&&(0,s.jsxs)("div",{className:$.default.projects,children:[(0,s.jsxs)("div",{className:$.default.sectionTitle,children:[(0,s.jsx)(I.FileText,{className:"w-3.5 h-3.5"}),"Projekt (",j.length,")"]}),j.map(e=>(0,s.jsxs)("div",{className:`${$.default.project} ${B===e.diarienummer?$.default.projectExpanded:""}`,onClick:()=>R(B===e.diarienummer?null:e.diarienummer),children:[(0,s.jsxs)("div",{className:$.default.projectHeader,children:[(0,s.jsx)("div",{className:$.default.projectTitle,children:e.titel||e.diarienummer}),(0,s.jsx)("div",{className:$.default.projectId,children:e.diarienummer})]}),B===e.diarienummer&&(0,s.jsxs)("div",{className:$.default.projectDetails,children:[e.programnamn&&(0,s.jsxs)("div",{className:$.default.detailRow,children:[(0,s.jsx)("span",{className:$.default.detailLabel,children:"Program"}),(0,s.jsx)("span",{className:$.default.detailValue,children:e.programnamn})]}),e.koordinator&&(0,s.jsxs)("div",{className:$.default.detailRow,children:[(0,s.jsx)("span",{className:$.default.detailLabel,children:"Koordinator"}),(0,s.jsx)("span",{className:$.default.detailValue,children:e.koordinator})]}),e.vinnovaBidrag&&(0,s.jsxs)("div",{className:$.default.detailRow,children:[(0,s.jsx)("span",{className:$.default.detailLabel,children:"Bidrag"}),(0,s.jsx)("span",{className:`${$.default.detailValue} ${$.default.detailValueHighlight}`,children:em(e.vinnovaBidrag)})]}),e.totalbudget&&(0,s.jsxs)("div",{className:$.default.detailRow,children:[(0,s.jsx)("span",{className:$.default.detailLabel,children:"Total budget"}),(0,s.jsx)("span",{className:$.default.detailValue,children:em(e.totalbudget)})]})]})]},e.diarienummer))]}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),E.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:()=>ei("search"),children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,ref:es,children:0===E.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Sök efter ett bolag för att se aktivitet"}):E.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]}),"batch"===l&&(0,s.jsxs)("div",{className:$.default.view,children:[(0,s.jsxs)("div",{className:$.default.statsGrid,children:[(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(g.Building2,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"Bevakade"}),(0,s.jsx)("div",{className:$.default.statValue,children:J.length||"..."})]})]}),(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(x.Clock,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"Senaste"}),(0,s.jsx)("div",{className:$.default.statValue,children:U})]})]})]}),(0,s.jsx)("div",{className:$.default.actionRow,children:(0,s.jsx)("button",{className:`${$.default.btn} ${O?$.default.btnDanger:$.default.btnSuccess}`,onClick:eg,style:{flex:1},children:O?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T,{className:"w-3.5 h-3.5"}),"Stoppa"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(L.Play,{className:"w-3.5 h-3.5"}),"Starta sökning"]})})}),K>0&&(0,s.jsx)("div",{className:$.default.progress,children:(0,s.jsx)("div",{className:$.default.progressBar,children:(0,s.jsx)("div",{className:$.default.progressFill,style:{width:`${K}%`}})})}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),H.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:()=>ei("batch"),children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,children:0===H.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Starta sökning för att se aktivitet"}):H.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]}),"status"===l&&(0,s.jsxs)("div",{className:$.default.view,children:[(0,s.jsxs)("div",{className:$.default.statsGrid,children:[(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(k.Activity,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"API"}),(0,s.jsx)("div",{className:`${$.default.statValue} ${$.default.statValueOnline}`,children:"Ansluten"})]})]}),(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(g.Building2,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"Bevakade"}),(0,s.jsx)("div",{className:$.default.statValue,children:J.length})]})]})]}),(0,s.jsx)("div",{className:$.default.actionRow,children:(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnGhost}`,onClick:eh,children:"Testa anslutning"})}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),X.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:()=>ei("status"),children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,ref:es,children:0===X.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Starta en körning för att se aktivitet"}):X.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]})]})]})]})}var A=e.i(245982),B=e.i(166286),R=e.i(970177),D=e.i(850354);function F(){let e=(0,m.useRouter)(),[a,l]=(0,t.useState)("button"),[n,i]=(0,t.useState)("search"),[d,r]=(0,t.useState)("online"),[c,o]=(0,t.useState)(!1),[u,f]=(0,t.useState)(!1),[j,p]=(0,t.useState)(""),[N,v]=(0,t.useState)([]),[b,C]=(0,t.useState)(!1),[V,I]=(0,t.useState)([]),E=(0,t.useRef)(null),[F,H]=(0,t.useState)(!1),[P,O]=(0,t.useState)(0),[G,K]=(0,t.useState)([]),[M,U]=(0,t.useState)({total:0,enriched:0,failed:0,skipped:0}),[z,J]=(0,t.useState)("--:--"),[q,X]=(0,t.useState)([]),[Q,Z]=(0,t.useState)(new Set),[Y,ee]=(0,t.useState)(!1),[es,ea]=(0,t.useState)(!1),[et,el]=(0,t.useState)(!1),[en,ei]=(0,t.useState)(null),[ed,er]=(0,t.useState)(!1),ec=(0,t.useRef)(0),eo=(0,t.useRef)(null),eu=(0,t.useRef)(null),em=(0,t.useRef)(null);S(em,()=>{"menu"===a&&ep(),"expanded"===a&&ev()},"button"!==a);let eh=(0,t.useCallback)((e,s="info")=>{let a=new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),t={id:`log-${++ec.current}`,time:a,message:e,type:s};K(e=>[...e.slice(-100),t])},[]);(0,t.useEffect)(()=>{eo.current&&(eo.current.scrollTop=eo.current.scrollHeight)},[G]),(0,t.useEffect)(()=>{er(F||b)},[F,b]),(0,t.useEffect)(()=>{try{let e=localStorage.getItem("allabolag-recent-searches");if(e){let s=JSON.parse(e);I(s.slice(0,5))}}catch{}},[]);let eg=(e,s)=>{let a={orgNr:e,name:s,timestamp:Date.now()};I(s=>{let t=[a,...s.filter(s=>s.orgNr!==e)].slice(0,5);try{localStorage.setItem("allabolag-recent-searches",JSON.stringify(t))}catch{}return t})},ef=(0,t.useCallback)(async(e,s=0)=>{if(!e.trim()||e.length<2)return void v([]);C(!0),r("working"),eh(`S\xf6ker: "${e}"...`,"step");try{let s=await fetch(`/api/bolag/search?q=${encodeURIComponent(e.trim())}`);if(!s.ok)throw Error(`API error: ${s.status}`);let a=await s.json();a.results&&a.results.length>0?(v(a.results.slice(0,8)),eh(`Hittade ${a.results.length} bolag`,"success")):(v([]),eh("Inga bolag hittades","warning"))}catch(t){let a=t instanceof Error?t.message:"Okänt fel";if(s<2)return eh(`Fel: ${a}. F\xf6rs\xf6ker igen...`,"warning"),await new Promise(e=>setTimeout(e,1e3)),ef(e,s+1);eh(`Fel: ${a}`,"error"),v([])}r("online"),C(!1)},[eh]),ex=(0,t.useCallback)(async()=>{ee(!0);try{let e=await fetch("/api/bevakning");if(e.ok){let s=(await e.json()).companies||[];X(s),Z(new Set(s.map(e=>e.id)))}}catch{}ee(!1)},[]);(0,t.useEffect)(()=>{"expanded"===a&&"enrich"===n&&ex()},[a,n,ex]);let ej=()=>K([]),ep=()=>{o(!1),setTimeout(()=>l("button"),250)},eN=e=>{o(!1),i(e),setTimeout(()=>{l("expanded"),setTimeout(()=>f(!0),10)},180),r("online")},ev=()=>{f(!1),setTimeout(()=>l("button"),220)},eb=async(e=0)=>{H(!0),r("working"),O(0),U({total:0,enriched:0,failed:0,skipped:0}),el(!1),ei(null);let s=q.filter(e=>Q.has(e.id));eh(`Startar berikning av ${s.length} bolag...`,"step");try{eu.current=new AbortController;let s=await fetch("/api/bevakning/enrich/stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({batchSize:50,companyIds:Array.from(Q)}),signal:eu.current.signal});if(429===s.status){let a=s.headers.get("Retry-After"),t=a?parseInt(a,10):60;if(el(!0),ei(t),eh(`Rate limited. V\xe4nta ${t} sekunder...`,"warning"),e<2)return await e_(1e3*t),el(!1),eb(e+1);H(!1),r("online");return}if(!s.ok)throw Error(`API error: ${s.status}`);let a=s.body?.getReader();if(!a)throw Error("No response body");let t=new TextDecoder;for(;;){let{done:e,value:s}=await a.read();if(e)break;for(let e of t.decode(s).split("\n").filter(Boolean))if(e.startsWith("data: "))try{let s=JSON.parse(e.slice(6));ey(s)}catch{}}J(new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"})),eh("Berikning slutförd","success")}catch(s){if(s instanceof Error&&"AbortError"===s.name);else{let a=s instanceof Error?s.message:"Okänt fel";if(e<2)return eh(`Fel: ${a}. F\xf6rs\xf6ker igen...`,"warning"),await e_(1e3),eb(e+1);eh(`Fel: ${a}`,"error")}}H(!1),r("online"),eu.current=null,setTimeout(()=>O(0),1e3)},ey=e=>{switch(e.type){case"start":eh(e.message||"Startar...","step"),e.total&&U(s=>({...s,total:e.total}));break;case"progress":void 0!==e.progress&&O(e.progress),e.company&&eh(`Bearbetar: ${e.company}`,"info");break;case"success":eh(e.message||`${e.company}: OK`,"success"),U(e=>({...e,enriched:e.enriched+1}));break;case"skip":eh(e.message||`${e.company}: Hoppades \xf6ver`,"info"),U(e=>({...e,skipped:e.skipped+1}));break;case"warning":eh(e.message||"Varning","warning");break;case"error":eh(e.message||`${e.company}: Misslyckades`,"error"),U(e=>({...e,failed:e.failed+1}));break;case"complete":void 0!==e.enriched&&U({total:e.total||0,enriched:e.enriched||0,failed:e.failed||0,skipped:e.skipped||0}),O(100)}},e_=e=>new Promise(s=>setTimeout(s,e)),ew=async()=>{eh("Testar anslutning...","step"),r("working");try{let e=await fetch("/api/health");if(e.ok){let s=await e.json();eh("API: OK","success"),eh(`Databas: ${"connected"===s.database?"OK":"Fel"}`,"connected"===s.database?"success":"error"),eh("Anslutning verifierad","success")}else eh("Anslutning misslyckades","error")}catch{eh("Kunde inte nå servern","error")}r("online")};return(0,s.jsxs)("div",{className:$.default.widget,ref:em,children:[es&&(0,s.jsx)("div",{className:$.default.confirmOverlay,onClick:()=>ea(!1),children:(0,s.jsxs)("div",{className:$.default.confirmDialog,onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:$.default.confirmTitle,children:"Bekräfta berikning"}),(0,s.jsxs)("div",{className:$.default.confirmMessage,children:["Du håller på att berika ",Q.size," bolag med data från Allabolag. Detta kan ta några minuter beroende på antalet bolag."]}),(0,s.jsxs)("div",{className:$.default.confirmActions,children:[(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnGhost}`,onClick:()=>ea(!1),children:"Avbryt"}),(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnPrimaryBlue}`,onClick:()=>{ea(!1),eb()},children:"Starta berikning"})]})]})}),"button"===a&&(0,s.jsxs)("button",{className:$.default.button,onClick:()=>{l("menu"),setTimeout(()=>o(!0),10)},disabled:ed,children:[(0,s.jsx)("div",{className:$.default.btnLogo,children:(0,s.jsx)("img",{src:"/logos/allabolag.png",alt:"Allabolag"})}),(0,s.jsx)("span",{className:$.default.btnSubtitle,children:"Bolagsdata"}),(0,s.jsx)(y.ChevronRight,{className:`${$.default.chevron} w-4 h-4`}),ed&&(0,s.jsx)("div",{className:`${$.default.loadingSpinner} ${$.default.loadingSpinnerBlue}`})]}),"menu"===a&&(0,s.jsxs)("div",{className:`${$.default.menu} ${c?$.default.menuVisible:""}`,children:[(0,s.jsxs)("div",{className:$.default.menuHeader,children:[(0,s.jsxs)("div",{className:$.default.menuTitle,children:[(0,s.jsx)("div",{className:`${$.default.menuTitleIcon} ${$.default.menuTitleIconBlue}`,children:(0,s.jsx)(A.Database,{className:"w-3 h-3"})}),"Berika data"]}),(0,s.jsx)("button",{className:$.default.menuClose,onClick:ep,children:(0,s.jsx)(w.X,{className:"w-3.5 h-3.5"})})]}),(0,s.jsxs)("div",{className:$.default.menuItems,children:[(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>eN("search"),children:[(0,s.jsx)("div",{className:`${$.default.menuIcon} ${$.default.menuIconBlue}`,children:(0,s.jsx)(h.Search,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Sök bolag"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"Sök på namn eller org.nr"})]})]}),(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>eN("enrich"),children:[(0,s.jsx)("div",{className:`${$.default.menuIcon} ${$.default.menuIconBlue}`,children:(0,s.jsx)(W.RefreshCw,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Berika bolag"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:q.length>0?`Uppdatera ${q.length} bolag fr\xe5n Allabolag`:"Hämta data från Allabolag"})]})]}),(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>eN("status"),children:[(0,s.jsx)("div",{className:`${$.default.menuIcon} ${$.default.menuIconBlue}`,children:(0,s.jsx)(k.Activity,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Status"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"Anslutning och hälsa"})]})]})]})]}),"expanded"===a&&(0,s.jsxs)("div",{className:`${$.default.expanded} ${u?$.default.expandedVisible:""}`,children:[(0,s.jsxs)("div",{className:$.default.expandedHeader,children:[(0,s.jsxs)("div",{className:$.default.expandedTitle,children:[(0,s.jsx)("div",{className:`${$.default.statusDot} ${"online"===d?$.default.statusDotOnline:"working"===d?$.default.statusDotWorkingBlue:""}`}),(0,s.jsx)("span",{children:{search:"Sök bolag",enrich:"Berika bolag",status:"Status"}[n]})]}),(0,s.jsxs)("div",{className:$.default.headerActions,children:[(0,s.jsx)("button",{className:$.default.headerBtn,onClick:()=>{f(!1),setTimeout(()=>{l("menu"),setTimeout(()=>o(!0),10)},220)},children:(0,s.jsx)(_.ChevronLeft,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{className:$.default.headerBtn,onClick:ev,children:(0,s.jsx)(w.X,{className:"w-3.5 h-3.5"})})]})]}),(0,s.jsxs)("div",{className:$.default.expandedBody,children:["search"===n&&(0,s.jsxs)("div",{className:$.default.view,children:[(0,s.jsxs)("div",{className:$.default.inputGroup,children:[(0,s.jsx)("input",{type:"text",className:$.default.input,placeholder:"Företagsnamn eller org.nr...",value:j,onChange:e=>{var s;p(s=e.target.value),E.current&&clearTimeout(E.current),s.length>=2?E.current=setTimeout(()=>{ef(s)},300):v([])},onKeyDown:e=>"Enter"===e.key&&ef(j),autoFocus:!0}),(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnPrimaryBlue}`,onClick:()=>ef(j),disabled:b||j.length<2,children:b?"...":"Sök"})]}),N.length>0&&(0,s.jsxs)("div",{className:$.default.projects,children:[(0,s.jsxs)("div",{className:$.default.sectionTitle,children:[(0,s.jsx)(g.Building2,{className:"w-3.5 h-3.5"}),"Resultat (",N.length,")"]}),N.map(a=>(0,s.jsx)("div",{className:$.default.project,onClick:()=>{eg(a.orgNr,a.name),eh(`\xd6ppnar: ${a.name}`,"success"),ev(),e.push(`/bolag/${a.orgNr}`)},children:(0,s.jsxs)("div",{className:$.default.projectHeader,children:[(0,s.jsx)("div",{className:$.default.projectTitle,children:a.name}),(0,s.jsx)("div",{className:$.default.projectId,children:a.orgNr})]})},a.orgNr))]}),0===N.length&&V.length>0&&!j&&(0,s.jsxs)("div",{className:$.default.projects,children:[(0,s.jsxs)("div",{className:$.default.sectionTitle,children:[(0,s.jsx)(x.Clock,{className:"w-3.5 h-3.5"}),"Senaste sökningar"]}),V.map(a=>(0,s.jsx)("div",{className:$.default.project,onClick:()=>{eg(a.orgNr,a.name),ev(),e.push(`/bolag/${a.orgNr}`)},children:(0,s.jsxs)("div",{className:$.default.projectHeader,children:[(0,s.jsx)("div",{className:$.default.projectTitle,children:a.name}),(0,s.jsx)("div",{className:$.default.projectId,children:a.orgNr})]})},a.orgNr))]}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),G.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:ej,children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,ref:eo,children:0===G.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Sök efter ett företag för att se aktivitet"}):G.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]}),"enrich"===n&&(0,s.jsxs)("div",{className:$.default.view,children:[et&&(0,s.jsxs)("div",{className:$.default.rateLimitWarning,children:[(0,s.jsx)(R.AlertTriangle,{className:"w-4 h-4"}),(0,s.jsxs)("span",{children:["Rate limited. ",en?`F\xf6rs\xf6ker igen om ${en}s...`:"Vänta innan du försöker igen."]})]}),(0,s.jsxs)("div",{className:$.default.statsGrid,children:[(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(g.Building2,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"Valda"}),(0,s.jsxs)("div",{className:$.default.statValue,children:[Q.size," / ",q.length]})]})]}),(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(B.CheckCircle,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"Berikade"}),(0,s.jsx)("div",{className:`${$.default.statValue} ${$.default.statValueSuccess}`,children:M.enriched})]})]})]}),!F&&(0,s.jsxs)("div",{className:$.default.companyFilter,children:[(0,s.jsxs)("div",{className:$.default.companyFilterHeader,children:[(0,s.jsx)("span",{className:$.default.companyFilterTitle,children:"Välj bolag"}),(0,s.jsxs)("div",{className:$.default.companyFilterActions,children:[(0,s.jsx)("button",{className:$.default.companyFilterAction,onClick:()=>{Z(new Set(q.map(e=>e.id)))},children:"Alla"}),(0,s.jsx)("button",{className:$.default.companyFilterAction,onClick:()=>{Z(new Set)},children:"Inga"})]})]}),Y?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Laddar bolag..."}):(0,s.jsx)("div",{className:$.default.companyList,children:q.map(e=>(0,s.jsxs)("div",{className:`${$.default.companyItem} ${Q.has(e.id)?$.default.companyItemSelected:""}`,onClick:()=>{var s;return s=e.id,void Z(e=>{let a=new Set(e);return a.has(s)?a.delete(s):a.add(s),a})},children:[(0,s.jsx)("div",{className:`${$.default.companyCheckbox} ${Q.has(e.id)?$.default.companyCheckboxChecked:""}`,children:Q.has(e.id)&&(0,s.jsx)(D.Check,{className:"w-3 h-3 text-white"})}),(0,s.jsx)("span",{className:$.default.companyName,children:e.name}),(0,s.jsx)("span",{className:$.default.companyOrgNr,children:e.orgNumber})]},e.id))})]}),(0,s.jsx)("div",{className:$.default.actionRow,children:(0,s.jsx)("button",{className:`${$.default.btn} ${F?$.default.btnDanger:$.default.btnPrimaryBlue}`,onClick:()=>{if(F){eu.current&&eu.current.abort(),H(!1),r("online"),eh("Avbruten av användare","warning");return}0===Q.size?eh("Inga bolag valda","warning"):ea(!0)},style:{flex:1},disabled:et,children:F?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T,{className:"w-3.5 h-3.5"}),"Stoppa"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(L.Play,{className:"w-3.5 h-3.5"}),"Starta berikning"]})})}),P>0&&(0,s.jsxs)("div",{className:`${$.default.progress} ${$.default.progressWithText}`,children:[(0,s.jsx)("div",{className:$.default.progressBar,children:(0,s.jsx)("div",{className:`${$.default.progressFill} ${$.default.progressFillBlue}`,style:{width:`${P}%`}})}),(0,s.jsxs)("span",{className:$.default.progressText,children:[Math.round(P),"%"]})]}),(M.enriched>0||M.failed>0||M.skipped>0)&&(0,s.jsxs)("div",{className:$.default.summary,children:[(0,s.jsxs)("span",{className:`${$.default.summaryItem} ${$.default.summaryItemSuccess}`,children:[M.enriched," berikade"]}),M.skipped>0&&(0,s.jsxs)("span",{className:$.default.summaryItem,children:[M.skipped," hoppades över"]}),M.failed>0&&(0,s.jsxs)("span",{className:`${$.default.summaryItem} ${$.default.summaryItemError}`,children:[M.failed," misslyckades"]})]}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),G.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:ej,children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,ref:eo,children:0===G.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Starta berikning för att se aktivitet"}):G.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]}),"status"===n&&(0,s.jsxs)("div",{className:$.default.view,children:[(0,s.jsxs)("div",{className:$.default.statsGrid,children:[(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(k.Activity,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"API"}),(0,s.jsx)("div",{className:`${$.default.statValue} ${$.default.statValueOnline}`,children:"Ansluten"})]})]}),(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(x.Clock,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"Senaste"}),(0,s.jsx)("div",{className:$.default.statValue,children:z})]})]})]}),(0,s.jsx)("div",{className:$.default.actionRow,children:(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnGhost}`,onClick:ew,children:"Testa anslutning"})}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),G.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:ej,children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,children:0===G.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Ingen aktivitet"}):G.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]})]})]})]})}var H=e.i(542960),P=e.i(520932),O=e.i(954434),G=e.i(970652);function K(){let[e,a]=(0,t.useState)("button"),[l,n]=(0,t.useState)("search"),[i,d]=(0,t.useState)("online"),[r,c]=(0,t.useState)(!1),[o,u]=(0,t.useState)(!1),[m,f]=(0,t.useState)(""),[j,p]=(0,t.useState)(null),[N,v]=(0,t.useState)(!1),[b,C]=(0,t.useState)([]),[V,I]=(0,t.useState)([]),[E,A]=(0,t.useState)(!1),[B,R]=(0,t.useState)(0),[D,F]=(0,t.useState)("--:--"),[K,M]=(0,t.useState)([]),[U,z]=(0,t.useState)([]),[J,q]=(0,t.useState)([]),[X,Q]=(0,t.useState)({}),[Z,Y]=(0,t.useState)(""),[ee,es]=(0,t.useState)(null),[ea,et]=(0,t.useState)([]),[el,en]=(0,t.useState)(!1),[ei,ed]=(0,t.useState)(!1),er=(0,t.useRef)(0),ec=(0,t.useRef)(null),eo=(0,t.useRef)(null),eu=(0,t.useRef)(!1);S(eo,()=>{"menu"===e&&ef(),"expanded"===e&&ej()},"button"!==e);let em=(0,t.useCallback)((e,s,a="info")=>{let t=new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),l={id:`log-${++er.current}`,time:t,message:s,type:a};"search"===e?C(e=>[...e.slice(-50),l]):"batch"===e?I(e=>[...e.slice(-50),l]):"linkedin"===e?et(e=>[...e.slice(-50),l]):q(e=>[...e.slice(-50),l])},[]);(0,t.useEffect)(()=>{ec.current&&(ec.current.scrollTop=ec.current.scrollHeight)},[b,V,J,ea]);let eh=(0,t.useCallback)(async()=>{try{let e=await fetch("/api/bevakning");if(e.ok){let s=await e.json();M(s.companies||[])}}catch(e){console.error("Failed to fetch watched companies:",e)}},[]);(0,t.useEffect)(()=>{"expanded"===e&&"batch"===l&&eh()},[e,l,eh]),(0,t.useEffect)(()=>{ed(N||E||el)},[N,E,el]);let eg=e=>{"search"===e?C([]):"batch"===e?I([]):"linkedin"===e?et([]):q([])},ef=()=>{c(!1),setTimeout(()=>a("button"),250)},ex=e=>{c(!1),n(e),setTimeout(()=>{a("expanded"),setTimeout(()=>u(!0),10)},180),d("online")},ej=()=>{u(!1),setTimeout(()=>a("button"),220)},ep=async(e=0)=>{if(m.trim()){v(!0),d("working"),p(null),em("search",`S\xf6ker logo f\xf6r: "${m}"...`,"step");try{let e=await fetch(`/api/media/logo?domain=${encodeURIComponent(m.trim())}&all=true`);if(!e.ok)throw Error(`API error: ${e.status}`);let s=await e.json();if(s.success&&s.files.length>0)for(let e of(p(s),em("search",`Hittade ${s.files.length} logotyp(er) via ${s.source}`,"success"),s.files)){let s=e.width?`${e.width}x${e.height}`:"okänd storlek";em("search",`  ${e.format.toUpperCase()} (${e.type}) - ${s}`,"info")}else em("search",s.error||"Ingen logo hittades","warning")}catch(a){let s=a instanceof Error?a.message:"Okänt fel";if(e<2)return em("search",`Fel: ${s}. F\xf6rs\xf6ker igen...`,"warning"),await eb(1e3),ep(e+1);em("search",`Fel: ${s}`,"error")}d("online"),v(!1)}},eN=async()=>{if(E){eu.current=!1,A(!1),em("batch","Avbruten av användare","warning"),d("online"),R(0);return}let e=K;if(0===e.length){em("batch","Hämtar bevakade bolag...","step");try{let s=await fetch("/api/bevakning");s.ok&&(e=(await s.json()).companies||[],M(e))}catch{em("batch","Kunde inte hämta bevakade bolag","error");return}}if(0===e.length)return void em("batch","Inga bevakade bolag att hämta logos för","warning");eu.current=!0,A(!0),z([]),em("batch",`Startar logo-h\xe4mtning f\xf6r ${e.length} bolag...`,"step"),d("working"),R(0);let s=0,a=[],t={};for(let l=0;l<e.length&&eu.current;l++){let n=e[l],i=(l+1)/e.length*100,d=n.domain||e_(n.name);em("batch",`S\xf6ker: ${n.name} (${d})...`,"info"),R(i-5);try{let e=await fetch(`/api/media/logo?domain=${encodeURIComponent(d)}`);if(!eu.current)break;if(e.ok){let l=await e.json();if(a.push(l),l.success){em("batch",`${n.name}: OK (${l.source})`,"success"),s++;let e=l.source||"unknown";t[e]||(t[e]={success:0,fail:0}),t[e].success++}else em("batch",`${n.name}: Ingen logo`,"warning")}else em("batch",`${n.name}: API-fel`,"warning")}catch{em("batch",`${n.name}: Misslyckades`,"error")}R(i),eu.current&&l<e.length-1&&await eb(300)}eu.current&&(z(a),Q(t),em("batch",`K\xf6rning slutf\xf6rd: ${s}/${e.length} logos h\xe4mtade`,"success"),F(new Date().toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"}))),eu.current=!1,A(!1),d("online"),setTimeout(()=>R(0),1e3)},ev=async()=>{for(let e of(em("status","Testar API-anslutningar...","step"),d("working"),[{name:"Brandfetch API",domain:"google.com"},{name:"Unavatar",domain:"spotify.com"},{name:"Google Favicons",domain:"github.com"}])){em("status",`Testar ${e.name}...`,"info"),await eb(300);try{let s=await fetch(`/api/media/logo?domain=${e.domain}`);if(s.ok){let a=await s.json();a.success?em("status",`${e.name}: OK (${a.source})`,"success"):em("status",`${e.name}: Ingen logo`,"warning")}else em("status",`${e.name}: Fel (${s.status})`,"error")}catch{em("status",`${e.name}: Kunde inte n\xe5`,"error")}}em("status","Test slutfört","success"),d("online")},eb=e=>new Promise(s=>setTimeout(s,e)),ey=async()=>{if(Z.trim()){en(!0),d("working"),es(null),em("linkedin",`S\xf6ker LinkedIn-profil f\xf6r: "${Z}"...`,"step");try{let e=await fetch(`/api/media/linkedin?company=${encodeURIComponent(Z.trim())}`);if(!e.ok)throw Error(`API error: ${e.status}`);let s=await e.json();s.success&&s.data?(es(s),em("linkedin",`Hittade: ${s.data.name||Z}`,"success"),s.data.industry&&em("linkedin",`Bransch: ${s.data.industry}`,"info"),s.data.company_size&&em("linkedin",`Storlek: ${s.data.company_size}`,"info"),s.data.headquarters&&em("linkedin",`HQ: ${s.data.headquarters}`,"info")):em("linkedin",s.error||"Ingen LinkedIn-profil hittades","warning")}catch(s){let e=s instanceof Error?s.message:"Okänt fel";em("linkedin",`Fel: ${e}`,"error")}d("online"),en(!1)}},e_=e=>{let s=e.toLowerCase().replace(/\s*(ab|aktiebolag|hb|kb|ek\.?\s*för\.?|ekonomisk förening)\s*$/i,"").trim().replace(/\s+/g,"").replace(/[åä]/g,"a").replace(/ö/g,"o").replace(/[^a-z0-9]/g,"");return`${s}.se`},ew=async(e,s)=>{try{let a=await fetch(e.url),t=await a.blob(),l=window.URL.createObjectURL(t),n=document.createElement("a");n.href=l,n.download=`${s.replace(/\./g,"_")}_logo.${e.format}`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(l),em("search",`Laddade ner ${e.format.toUpperCase()} logo`,"success")}catch{em("search","Kunde inte ladda ner logo","error")}};return(0,t.useEffect)(()=>()=>{eu.current=!1},[]),(0,s.jsxs)("div",{className:$.default.widget,ref:eo,children:["button"===e&&(0,s.jsxs)("button",{className:$.default.button,onClick:()=>{a("menu"),setTimeout(()=>c(!0),10)},disabled:ei,children:[(0,s.jsx)("div",{className:$.default.btnLogo,children:(0,s.jsx)(H.Image,{className:"w-8 h-8",strokeWidth:1.5})}),(0,s.jsx)("span",{className:$.default.btnSubtitle,children:"Media & Logos"}),(0,s.jsx)(y.ChevronRight,{className:`${$.default.chevron} w-4 h-4`}),ei&&(0,s.jsx)("div",{className:$.default.loadingSpinner})]}),"menu"===e&&(0,s.jsxs)("div",{className:`${$.default.menu} ${r?$.default.menuVisible:""}`,children:[(0,s.jsxs)("div",{className:$.default.menuHeader,children:[(0,s.jsxs)("div",{className:$.default.menuTitle,children:[(0,s.jsx)("div",{className:`${$.default.menuTitleIcon} ${$.default.menuTitleIconGreen}`,children:(0,s.jsx)(H.Image,{className:"w-3 h-3"})}),"Media"]}),(0,s.jsx)("button",{className:$.default.menuClose,onClick:ef,children:(0,s.jsx)(w.X,{className:"w-3.5 h-3.5"})})]}),(0,s.jsxs)("div",{className:$.default.menuItems,children:[(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>ex("search"),children:[(0,s.jsx)("div",{className:$.default.menuIcon,children:(0,s.jsx)(h.Search,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Hämta logo"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"Sök på domän eller bolagsnamn"})]})]}),(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>ex("batch"),children:[(0,s.jsx)("div",{className:$.default.menuIcon,children:(0,s.jsx)(W.RefreshCw,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Batch-hämtning"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"Hämta logos för alla bevakade bolag"})]})]}),(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>ex("linkedin"),children:[(0,s.jsx)("div",{className:$.default.menuIcon,children:(0,s.jsx)(G.Linkedin,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"LinkedIn"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"Hämta bolagsprofil från LinkedIn"})]})]}),(0,s.jsxs)("div",{className:$.default.menuItem,onClick:()=>ex("status"),children:[(0,s.jsx)("div",{className:$.default.menuIcon,children:(0,s.jsx)(k.Activity,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:$.default.menuLabel,children:"Status"}),(0,s.jsx)("div",{className:$.default.menuDesc,children:"API-status och statistik"})]})]})]})]}),"expanded"===e&&(0,s.jsxs)("div",{className:`${$.default.expanded} ${o?$.default.expandedVisible:""}`,children:[(0,s.jsxs)("div",{className:$.default.expandedHeader,children:[(0,s.jsxs)("div",{className:$.default.expandedTitle,children:[(0,s.jsx)("div",{className:`${$.default.statusDot} ${"online"===i?$.default.statusDotOnline:"working"===i?$.default.statusDotWorking:""}`}),(0,s.jsx)("span",{children:{search:"Hämta logo",batch:"Batch-hämtning",status:"Status",linkedin:"LinkedIn"}[l]})]}),(0,s.jsxs)("div",{className:$.default.headerActions,children:[(0,s.jsx)("button",{className:$.default.headerBtn,onClick:()=>{u(!1),setTimeout(()=>{a("menu"),setTimeout(()=>c(!0),10)},220)},children:(0,s.jsx)(_.ChevronLeft,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{className:$.default.headerBtn,onClick:ej,children:(0,s.jsx)(w.X,{className:"w-3.5 h-3.5"})})]})]}),(0,s.jsxs)("div",{className:$.default.expandedBody,children:["search"===l&&(0,s.jsxs)("div",{className:$.default.view,children:[(0,s.jsxs)("div",{className:$.default.inputGroup,children:[(0,s.jsx)("input",{type:"text",className:$.default.input,placeholder:"Domän (t.ex. volvo.com)...",value:m,onChange:e=>f(e.target.value),onKeyDown:e=>"Enter"===e.key&&ep(),autoFocus:!0}),(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnPrimary}`,onClick:()=>ep(),disabled:N,children:N?"...":"Sök"})]}),j&&j.success&&j.files.length>0&&(0,s.jsxs)("div",{className:$.default.projects,children:[(0,s.jsxs)("div",{className:$.default.sectionTitle,children:[(0,s.jsx)(H.Image,{className:"w-3.5 h-3.5"}),"Resultat (",j.files.length,")"]}),(0,s.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"12px"},children:j.files.slice(0,4).map((e,a)=>(0,s.jsxs)("div",{style:{background:"var(--widget-surface)",borderRadius:"8px",padding:"12px",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",flex:"1 1 calc(50% - 4px)",minWidth:"120px"},children:[(0,s.jsx)("div",{style:{width:"80px",height:"60px",display:"flex",alignItems:"center",justifyContent:"center",background:"white",borderRadius:"4px",padding:"8px"},children:(0,s.jsx)("img",{src:e.url,alt:`Logo ${e.type}`,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"},onError:e=>{e.target.style.display="none"}})}),(0,s.jsxs)("div",{style:{fontSize:"10px",color:"var(--widget-text-dim)",textAlign:"center"},children:[e.format.toUpperCase()," ",e.width?`(${e.width}px)`:""]}),(0,s.jsxs)("div",{style:{display:"flex",gap:"4px"},children:[(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnGhost}`,style:{padding:"4px 8px",fontSize:"10px"},onClick:()=>ew(e,j.domain),children:(0,s.jsx)(P.Download,{className:"w-3 h-3"})}),(0,s.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:`${$.default.btn} ${$.default.btnGhost}`,style:{padding:"4px 8px",fontSize:"10px"},children:(0,s.jsx)(O.ExternalLink,{className:"w-3 h-3"})})]})]},a))})]}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),b.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:()=>eg("search"),children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,ref:ec,children:0===b.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Sök efter en domän för att hämta logo"}):b.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]}),"batch"===l&&(0,s.jsxs)("div",{className:$.default.view,children:[(0,s.jsxs)("div",{className:$.default.statsGrid,children:[(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(g.Building2,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"Bevakade"}),(0,s.jsx)("div",{className:$.default.statValue,children:K.length||"..."})]})]}),(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(x.Clock,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"Senaste"}),(0,s.jsx)("div",{className:$.default.statValue,children:D})]})]})]}),(0,s.jsx)("div",{className:$.default.actionRow,children:(0,s.jsx)("button",{className:`${$.default.btn} ${E?$.default.btnDanger:$.default.btnSuccess}`,onClick:eN,style:{flex:1},children:E?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T,{className:"w-3.5 h-3.5"}),"Stoppa"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(L.Play,{className:"w-3.5 h-3.5"}),"Starta hämtning"]})})}),B>0&&(0,s.jsx)("div",{className:$.default.progress,children:(0,s.jsx)("div",{className:$.default.progressBar,children:(0,s.jsx)("div",{className:$.default.progressFill,style:{width:`${B}%`}})})}),U.length>0&&!E&&(0,s.jsxs)("div",{className:$.default.summary,children:[(0,s.jsxs)("span",{className:`${$.default.summaryItem} ${$.default.summaryItemSuccess}`,children:[U.filter(e=>e.success).length," hämtade"]}),(0,s.jsxs)("span",{className:$.default.summaryItem,children:[U.filter(e=>!e.success).length," missade"]})]}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),V.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:()=>eg("batch"),children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,children:0===V.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Starta hämtning för att se aktivitet"}):V.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]}),"linkedin"===l&&(0,s.jsxs)("div",{className:$.default.view,children:[(0,s.jsxs)("div",{className:$.default.inputGroup,children:[(0,s.jsx)("input",{type:"text",className:$.default.input,placeholder:"Bolagsnamn (t.ex. volvo, klarna)...",value:Z,onChange:e=>Y(e.target.value),onKeyDown:e=>"Enter"===e.key&&ey(),autoFocus:!0}),(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnPrimary}`,onClick:ey,disabled:el,children:el?"...":"Sök"})]}),ee&&ee.success&&ee.data&&(0,s.jsxs)("div",{className:$.default.projects,children:[(0,s.jsxs)("div",{className:$.default.sectionTitle,children:[(0,s.jsx)(G.Linkedin,{className:"w-3.5 h-3.5"}),ee.data.name||ee.company]}),(0,s.jsxs)("div",{style:{background:"var(--widget-surface)",borderRadius:"8px",padding:"12px",marginBottom:"12px"},children:[ee.data.about_us&&(0,s.jsx)("p",{style:{fontSize:"12px",color:"var(--widget-text)",lineHeight:"1.5",marginBottom:"12px"},children:ee.data.about_us.length>200?ee.data.about_us.slice(0,200)+"...":ee.data.about_us}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",fontSize:"11px"},children:[ee.data.industry&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"Bransch:"})," ",(0,s.jsx)("span",{style:{color:"var(--widget-text)"},children:ee.data.industry})]}),ee.data.company_size&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"Storlek:"})," ",(0,s.jsx)("span",{style:{color:"var(--widget-text)"},children:ee.data.company_size})]}),ee.data.headquarters&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"HQ:"})," ",(0,s.jsx)("span",{style:{color:"var(--widget-text)"},children:ee.data.headquarters})]}),ee.data.founded&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"Grundat:"})," ",(0,s.jsx)("span",{style:{color:"var(--widget-text)"},children:ee.data.founded})]}),ee.data.headcount&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"Anställda:"})," ",(0,s.jsx)("span",{style:{color:"var(--widget-text)"},children:ee.data.headcount.toLocaleString()})]}),ee.data.website&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{style:{color:"var(--widget-text-dim)"},children:"Webb:"})," ",(0,s.jsx)("a",{href:ee.data.website,target:"_blank",rel:"noopener noreferrer",style:{color:"var(--widget-accent)"},children:ee.data.website.replace(/^https?:\/\//,"")})]})]}),ee.data.specialties&&ee.data.specialties.length>0&&(0,s.jsx)("div",{style:{marginTop:"8px",display:"flex",flexWrap:"wrap",gap:"4px"},children:ee.data.specialties.slice(0,5).map((e,a)=>(0,s.jsx)("span",{style:{background:"var(--widget-bg)",padding:"2px 6px",borderRadius:"4px",fontSize:"10px",color:"var(--widget-text-dim)"},children:e},a))}),ee.linkedinUrl&&(0,s.jsx)("div",{style:{marginTop:"12px"},children:(0,s.jsxs)("a",{href:ee.linkedinUrl,target:"_blank",rel:"noopener noreferrer",className:`${$.default.btn} ${$.default.btnGhost}`,style:{fontSize:"11px"},children:[(0,s.jsx)(O.ExternalLink,{className:"w-3 h-3"}),"Öppna på LinkedIn"]})})]})]}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),ea.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:()=>eg("linkedin"),children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,ref:ec,children:0===ea.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Sök efter ett bolag för att hämta LinkedIn-profil"}):ea.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]}),"status"===l&&(0,s.jsxs)("div",{className:$.default.view,children:[(0,s.jsxs)("div",{className:$.default.statsGrid,children:[(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(k.Activity,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"API"}),(0,s.jsx)("div",{className:`${$.default.statValue} ${$.default.statValueOnline}`,children:"6 källor"})]})]}),(0,s.jsxs)("div",{className:$.default.statCard,children:[(0,s.jsx)(H.Image,{className:"w-4 h-4"}),(0,s.jsxs)("div",{className:$.default.statContent,children:[(0,s.jsx)("div",{className:$.default.statLabel,children:"Format"}),(0,s.jsx)("div",{className:$.default.statValue,children:"SVG, PNG"})]})]})]}),(0,s.jsxs)("div",{className:$.default.projects,style:{marginBottom:"12px"},children:[(0,s.jsxs)("div",{className:$.default.sectionTitle,children:[(0,s.jsx)(k.Activity,{className:"w-3.5 h-3.5"}),"API-källor (prioritetsordning)"]}),[{name:"Brandfetch API",desc:"SVG/PNG, flera storlekar"},{name:"Brandfetch CDN",desc:"Snabb, en fil"},{name:"Unavatar",desc:"Aggregerar källor"},{name:"Google Favicons",desc:"128px ikoner"},{name:"DuckDuckGo",desc:"ICO-ikoner"},{name:"Logo.dev",desc:"Backup"}].map((e,a)=>(0,s.jsx)("div",{className:$.default.project,style:{cursor:"default"},children:(0,s.jsxs)("div",{className:$.default.projectHeader,children:[(0,s.jsxs)("div",{className:$.default.projectTitle,children:[a+1,". ",e.name]}),(0,s.jsx)("div",{className:$.default.projectId,children:e.desc})]})},a))]}),(0,s.jsx)("div",{className:$.default.actionRow,children:(0,s.jsx)("button",{className:`${$.default.btn} ${$.default.btnGhost}`,onClick:ev,children:"Testa anslutningar"})}),(0,s.jsxs)("div",{className:$.default.logPanel,children:[(0,s.jsxs)("div",{className:$.default.logHeader,children:[(0,s.jsx)("span",{className:$.default.logTitle,children:"Aktivitet"}),J.length>0&&(0,s.jsx)("button",{className:$.default.logClear,onClick:()=>eg("status"),children:"Rensa"})]}),(0,s.jsx)("div",{className:$.default.logContent,ref:ec,children:0===J.length?(0,s.jsx)("div",{className:$.default.logEmpty,children:"Testa anslutningar för att se status"}):J.map(e=>(0,s.jsxs)("div",{className:`${$.default.logLine} ${"success"===e.type?$.default.logLineSuccess:"warning"===e.type?$.default.logLineWarning:"error"===e.type?$.default.logLineError:"step"===e.type?$.default.logLineStep:$.default.logLineInfo}`,children:[(0,s.jsx)("span",{className:$.default.logTime,children:e.time}),(0,s.jsx)("span",{className:$.default.logMsg,children:e.message})]},e.id))})]})]})]})]})]})}var M=e.i(855869),U=e.i(530698);function z(){let{history:e,addToHistory:n,clearHistory:i}=function(){let{data:e,status:s}=(0,l.useSession)(),[a,n]=(0,t.useState)([]),[i,d]=(0,t.useState)(!1),u=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{(async()=>{if(n(c()),"authenticated"===s&&e?.user&&!u.current)try{let e=await fetch("/api/bolag/history");if(e.ok){let s=await e.json();s.history&&s.history.length>0&&(n(s.history),o(s.history),u.current=!0)}}catch{}d(!0)})()},[e?.user,s]),(0,t.useEffect)(()=>{(async()=>{if("authenticated"!==s||!e?.user||u.current)return;let a=c();if(0!==a.length)try{let e=await fetch("/api/bolag/history");if(e.ok){let s=await e.json();if(s.history&&s.history.length>0)return}for(let e of a)await fetch("/api/bolag/history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgNr:e.orgNr,name:e.name})})}catch{}})()},[e?.user,s]),{history:a,addToHistory:(0,t.useCallback)(async(s,a)=>{let t={orgNr:s,name:a,timestamp:Date.now()};if(n(e=>{let a=[t,...e.filter(e=>e.orgNr!==s)].slice(0,8);return o(a),a}),e?.user)try{await fetch("/api/bolag/history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgNr:s,name:a})})}catch{}},[e?.user]),clearHistory:(0,t.useCallback)(async()=>{if(n([]),localStorage.removeItem(r),e?.user)try{await fetch("/api/bolag/history",{method:"DELETE"})}catch{}},[e?.user]),isLoaded:i}}();return(0,s.jsx)("main",{className:"min-h-screen bg-background text-foreground",children:(0,s.jsxs)("div",{className:"page-wrapper page-content",children:[(0,s.jsxs)("header",{className:"page-header text-center max-w-2xl mx-auto",children:[(0,s.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 text-white mb-6 shadow-lg",children:(0,s.jsx)(g.Building2,{className:"w-8 h-8"})}),(0,s.jsx)("h1",{className:"page-title",children:"Bolagsinfo"}),(0,s.jsx)("p",{className:"page-subtitle",children:"Utforska svenska bolag med data från flera officiella källor"})]}),(0,s.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,s.jsxs)(a.Card,{className:"shadow-lg border-2 border-border/50 hover:border-blue-200 dark:hover:border-blue-800/50 transition-colors",children:[(0,s.jsxs)(a.CardHeader,{className:"text-center pb-2",children:[(0,s.jsxs)("div",{className:"inline-flex items-center justify-center gap-2 text-muted-foreground mb-2",children:[(0,s.jsx)(h.Search,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-xs font-medium uppercase tracking-wider",children:"Sök företag"})]}),(0,s.jsx)(a.CardDescription,{className:"text-base",children:"Sök på företagsnamn eller organisationsnummer"})]}),(0,s.jsxs)(a.CardContent,{className:"pt-0",children:[(0,s.jsx)(b,{placeholder:"T.ex. Spotify eller 556703-7485...",recentSearches:e,onSelectResult:e=>n(e.orgNr,e.name)}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(u,{history:e,onClear:i})})]})]}),(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsxs)("h2",{className:"text-section mb-4 flex items-center gap-2",children:[(0,s.jsx)(A.Database,{className:"w-4 h-4 text-muted-foreground"}),"Verktyg"]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[(0,s.jsx)(C,{}),(0,s.jsx)(E,{}),(0,s.jsx)(F,{}),(0,s.jsx)(K,{})]})]}),(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)(d,{})})]}),(0,s.jsxs)("div",{className:"mt-16",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h2",{className:"section-title mb-2",children:"Datakällor"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Information aggregeras från flera officiella källor"})]}),(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4 max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"source-card group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-emerald-500/10 dark:bg-emerald-500/20 flex items-center justify-center group-hover:scale-110 transition-transform",children:(0,s.jsx)(I.FileText,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-400"})}),(0,s.jsx)("h3",{className:"font-semibold text-foreground",children:"Bolagsverket"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Officiell registreringsinformation, styrelse och kungörelser"})]}),(0,s.jsxs)("div",{className:"source-card group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-orange-500/10 dark:bg-orange-500/20 flex items-center justify-center group-hover:scale-110 transition-transform",children:(0,s.jsx)(U.TrendingUp,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),(0,s.jsx)("h3",{className:"font-semibold text-foreground",children:"Allabolag"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Bokslut, nyckeltal, ägare och befattningshavare"})]}),(0,s.jsxs)("div",{className:"source-card group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-green-500/10 dark:bg-green-500/20 flex items-center justify-center group-hover:scale-110 transition-transform",children:(0,s.jsx)(M.Lightbulb,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,s.jsx)("h3",{className:"font-semibold text-foreground",children:"Vinnova"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Innovationsbidrag och forskningsprojekt"})]}),(0,s.jsxs)("div",{className:"source-card group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-purple-500/10 dark:bg-purple-500/20 flex items-center justify-center group-hover:scale-110 transition-transform",children:(0,s.jsx)(H.Image,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),(0,s.jsx)("h3",{className:"font-semibold text-foreground",children:"Media"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Logotyper och varumärken via 6 API-källor"})]})]})]}),(0,s.jsx)("div",{className:"mt-16 pt-8 border-t border-border",children:(0,s.jsxs)("div",{className:"flex flex-wrap justify-center gap-8 text-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-foreground font-mono",children:"1.2M+"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Registrerade bolag"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-foreground font-mono",children:"4"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Datakällor"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-foreground font-mono",children:"Realtid"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Uppdateringar"})]})]})})]})})}e.s(["default",()=>z],659836)}]);

//# debugId=1a636661-ac37-73a5-4e2b-ce9f6d04c6a6
//# sourceMappingURL=55c2fe2dbae7cc21.js.map