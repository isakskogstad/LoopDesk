;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="74c627e2-1d73-bec6-d54b-4a435cd27773")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,347712,e=>{"use strict";var t=e.i(206266),r=e.i(247032),a=e.i(176480),s=e.i(212298),n=e.i(892793),o=e.i(703712),i=e.i(154349),l=e.i(862759),d=e.i(380911);function c({icon:e=l.FileText,title:r,description:a,action:s,secondaryAction:n,children:o,className:i=""}){return(0,t.jsxs)("div",{className:`empty-state ${i}`,children:[(0,t.jsx)("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:(0,t.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-br from-secondary/50 to-transparent rounded-full blur-3xl"})}),(0,t.jsxs)("div",{className:"relative empty-state-icon",children:[(0,t.jsx)("div",{className:"absolute inset-0 rounded-full bg-secondary animate-pulse-soft"}),(0,t.jsx)("div",{className:"relative w-16 h-16 rounded-full bg-secondary flex items-center justify-center",children:(0,t.jsx)(e,{className:"w-8 h-8 text-muted-foreground"})})]}),(0,t.jsx)("h3",{className:"empty-state-title",children:r}),(0,t.jsx)("p",{className:"empty-state-description",children:a}),(s||n)&&(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[s&&(s.href?(0,t.jsx)(d.Button,{asChild:!0,variant:s.variant||"default",children:(0,t.jsx)("a",{href:s.href,children:s.label})}):(0,t.jsx)(d.Button,{onClick:s.onClick,variant:s.variant||"default",children:s.label})),n&&(0,t.jsx)(d.Button,{variant:"ghost",onClick:n.onClick,children:n.label})]}),o]})}function m({onAddFeed:e,hasFilters:r=!1}){return r?(0,t.jsx)(c,{icon:i.Search,title:"Inga matchande nyheter",description:"Prova att ändra dina filter eller sökning för att hitta fler nyheter."}):(0,t.jsx)(c,{icon:o.Newspaper,title:"Inga nyheter ännu",description:"Lägg till dina första RSS-källor för att börja följa nyheter från de medier du bryr dig om.",action:e?{label:"Lägg till källa",onClick:e}:void 0})}var u=e.i(213571),x=e.i(505265),h=e.i(690972);let g=(0,h.default)("image-off",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]]);var p=e.i(431899);let f=(0,h.default)("headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),b=(0,h.default)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),y=(0,h.default)("twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);var v=e.i(970652);let w=(0,h.default)("youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]);function k(e,t){if(!t.length)return e;let r=e;for(let e of t){let t=RegExp(`(${e.term.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi"),a=e.color||"#fbbf24";r=r.replace(t,`<mark style="background-color: ${a}30; color: inherit; padding: 0 2px; border-radius: 2px;">$1</mark>`)}return r}function j({article:e,onBookmark:a,onRead:s,onViewCompany:n,onOpen:o,layout:i="short",highlightKeywords:l=!0,isFocused:d=!1,showGradientLine:c=!0}){let[m,h]=(0,r.useState)(!1),[j,N]=(0,r.useState)(!1),[S,C]=(0,r.useState)(!1),D=(0,r.useRef)(null),T=e.description&&e.description.length>0,E=e.mediaThumbnail||e.imageUrl,L=E&&!m,R=e.mediaType&&"image"!==e.mediaType,I=function(e,t){try{let t=new URL(e).hostname;return`https://www.google.com/s2/favicons?domain=${t}&sz=32`}catch{return({"Dagens Industri":"https://www.google.com/s2/favicons?domain=di.se&sz=32","Svenska Dagbladet":"https://www.google.com/s2/favicons?domain=svd.se&sz=32",Aftonbladet:"https://www.google.com/s2/favicons?domain=aftonbladet.se&sz=32",Expressen:"https://www.google.com/s2/favicons?domain=expressen.se&sz=32","SVT Nyheter":"https://www.google.com/s2/favicons?domain=svt.se&sz=32",DN:"https://www.google.com/s2/favicons?domain=dn.se&sz=32",Breakit:"https://www.google.com/s2/favicons?domain=breakit.se&sz=32",Realtid:"https://www.google.com/s2/favicons?domain=realtid.se&sz=32","Privata Affärer":"https://www.google.com/s2/favicons?domain=privataaffarer.se&sz=32"})[t]||""}}(e.url,e.sourceName),{time:A,day:B}=function(e){let t=new Date(e),r=new Date,a=t.toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"});if(t.toDateString()===r.toDateString())return{time:a};let s=new Date(r);if(s.setDate(s.getDate()-1),t.toDateString()===s.toDateString())return{time:a,day:"Igår"};let n=new Date(r);if(n.setDate(n.getDate()-7),t>n){let e=t.toLocaleDateString("sv-SE",{weekday:"short"});return{time:a,day:e.charAt(0).toUpperCase()+e.slice(1)}}return{time:a,day:t.toLocaleDateString("sv-SE",{day:"numeric",month:"short"})}}(e.publishedAt),M=l?(e.keywordMatches||[]).map(e=>e.keyword):[],$=function(e){switch(e){case"youtube":return"bg-red-500";case"video":return"bg-purple-500";case"podcast":case"audio":return"bg-green-500";case"twitter":return"bg-sky-500";case"linkedin":return"bg-blue-600";default:return"bg-primary"}}(e.mediaType),U=R?function(e){switch(e){case"youtube":return(0,t.jsx)(w,{className:"w-5 h-5"});case"video":return(0,t.jsx)(b,{className:"w-5 h-5"});case"podcast":case"audio":return(0,t.jsx)(f,{className:"w-5 h-5"});case"twitter":return(0,t.jsx)(y,{className:"w-5 h-5"});case"linkedin":return(0,t.jsx)(v.Linkedin,{className:"w-5 h-5"});default:return(0,t.jsx)(p.Play,{className:"w-5 h-5"})}}(e.mediaType):null,O=function(e,t){if(t)return t;switch(e){case"youtube":return"YouTube";case"video":return"Video";case"podcast":return"Podcast";case"audio":return"Ljud";case"twitter":return"Twitter";case"linkedin":return"LinkedIn";default:return""}}(e.mediaType,e.mediaPlatform),z="media"===i;return(0,t.jsxs)("article",{ref:D,className:`
                group relative grid gap-3 sm:gap-4 md:gap-5 py-3 sm:py-4 md:py-5 cursor-pointer
                transition-all duration-200 ease-out
                ${z?"grid-cols-[40px_1fr] sm:grid-cols-[48px_1fr] md:grid-cols-[60px_1fr_160px] lg:grid-cols-[60px_1fr_180px]":"grid-cols-[40px_1fr] sm:grid-cols-[48px_1fr] md:grid-cols-[60px_1fr]"}
                ${e.isRead?"opacity-60":""}
                ${d?"ring-2 ring-primary ring-offset-2 ring-offset-background rounded-xl focus-ring":""}
                hover:bg-secondary/20 hover:-mx-2 sm:hover:-mx-3 md:hover:-mx-4 hover:px-2 sm:hover:px-3 md:hover:px-4 hover:rounded-xl
            `,style:{minHeight:"auto",alignItems:"start"},onClick:t=>{let r=t.target;r.closest("button")||r.closest("a")||o?.(e)},children:[c&&(0,t.jsx)("div",{className:"absolute bottom-0 left-[40px] sm:left-[48px] md:left-[60px] right-0 h-px opacity-50 bg-gradient-to-r from-border via-muted-foreground/30 to-transparent group-hover:opacity-0 transition-opacity"}),(0,t.jsxs)("div",{className:"absolute right-0 top-3 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),a?.(e.id)},className:"h-8 w-8 rounded-lg border border-border bg-background/80 text-muted-foreground hover:text-foreground hover:border-muted-foreground transition-colors",title:e.isBookmarked?"Ta bort Läs senare":"Läs senare",children:e.isBookmarked?(0,t.jsx)(x.BookmarkCheck,{className:"w-4 h-4 mx-auto"}):(0,t.jsx)(u.Bookmark,{className:"w-4 h-4 mx-auto"})}),(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),e.isRead||s?.(e.id)},className:"h-8 w-8 rounded-lg border border-border bg-background/80 text-muted-foreground hover:text-foreground hover:border-muted-foreground transition-colors",title:"Markera som läst",children:"✓"})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 sm:gap-3 pt-0.5 sm:pt-1",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-mono text-[10px] sm:text-[11px] font-medium text-muted-foreground tabular-nums",children:A}),B&&(0,t.jsx)("div",{className:"font-mono text-[9px] sm:text-[10px] text-muted-foreground/70 mt-0.5 tabular-nums",children:B})]}),I&&!j&&(0,t.jsx)("div",{className:"w-5 h-5 sm:w-6 sm:h-6 md:w-7 md:h-7 rounded-md overflow-hidden transition-transform group-hover:scale-110",children:(0,t.jsx)("img",{src:I,alt:"",className:"w-full h-full object-cover",onError:()=>N(!0)})})]}),(0,t.jsxs)("div",{className:"min-w-0 flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2 mb-2 sm:mb-2.5",children:[R&&(0,t.jsx)("div",{className:`md:hidden flex-shrink-0 ${$} rounded p-1.5 text-white mt-0.5`,children:(0,t.jsx)("span",{className:"w-3.5 h-3.5 block [&>svg]:w-3.5 [&>svg]:h-3.5",children:U})}),(0,t.jsx)("h2",{className:`
                            ${"compact"===i?"text-[14px] sm:text-[15px]":"text-[15px] sm:text-[16px] md:text-[17px]"}
                            font-semibold leading-snug
                            transition-colors group-hover:text-foreground
                            ${e.isRead?"text-muted-foreground":"text-foreground"}
                        `,dangerouslySetInnerHTML:{__html:k(e.title,M)}})]}),"compact"!==i&&T&&(0,t.jsx)("p",{className:`
                            text-sm text-muted-foreground flex-1 prose-readable
                            line-clamp-3
                        `,dangerouslySetInnerHTML:{__html:k(e.description||"",M)}}),(e.keywordMatches?.length||e.companyMatches?.length)&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-1.5 mt-3",children:[e.keywordMatches?.map(e=>(0,t.jsx)("span",{className:"text-xs font-medium px-2 py-0.5 rounded-md",style:{backgroundColor:e.keyword.color?`${e.keyword.color}20`:"hsl(var(--secondary))",color:e.keyword.color||"hsl(var(--muted-foreground))"},children:e.keyword.term},e.keyword.id)),e.companyMatches?.map(e=>(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),n?.(e.company.orgNumber)},className:"text-xs font-medium px-2 py-0.5 rounded-md bg-blue-500/10 text-blue-600 dark:text-blue-400 hover:bg-blue-500/20 transition-colors",children:e.company.name},e.company.id))]})]}),z&&(L?(0,t.jsxs)("div",{className:"hidden md:block w-full rounded-xl overflow-hidden bg-secondary min-h-[100px] lg:min-h-[120px] relative",children:[(0,t.jsx)("img",{src:E,alt:"",className:`w-full h-full object-cover transition-all duration-300
                                       ${S?"blur-0":"blur-sm"}
                                       group-hover:scale-105 group-hover:brightness-105`,onError:()=>h(!0),onLoad:()=>C(!0),loading:"lazy",decoding:"async"}),R&&(0,t.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center",children:[(0,t.jsx)("div",{className:`${$} rounded-full p-3 text-white shadow-lg
                                                opacity-90 group-hover:opacity-100 group-hover:scale-110
                                                transition-all duration-200`,children:U}),e.mediaDuration&&(0,t.jsx)("div",{className:"absolute bottom-2 right-2 px-2 py-0.5 rounded bg-black/80 text-white text-xs font-mono",children:e.mediaDuration}),O&&(0,t.jsxs)("div",{className:`absolute top-2 left-2 px-2 py-0.5 rounded
                                                    ${$} text-white text-xs font-medium
                                                    flex items-center gap-1`,children:[U&&(0,t.jsx)("span",{className:"w-3 h-3",children:U}),O]})]})]}):R?(0,t.jsxs)("div",{className:`hidden md:flex w-full rounded-xl overflow-hidden min-h-[100px] lg:min-h-[120px]
                                    bg-gradient-to-br from-secondary to-border relative
                                    items-center justify-center transition-all duration-200
                                    group-hover:from-border group-hover:to-secondary`,children:[(0,t.jsx)("div",{className:`${$} rounded-full p-4 text-white shadow-lg
                                        opacity-80 group-hover:opacity-100 group-hover:scale-110
                                        transition-all duration-200`,children:U}),O&&(0,t.jsx)("div",{className:"absolute bottom-2 right-2 px-2 py-0.5 rounded bg-black/60 text-white/90 text-xs font-medium",children:O}),e.mediaDuration&&(0,t.jsx)("div",{className:"absolute top-2 right-2 px-2 py-0.5 rounded bg-black/60 text-white text-xs font-mono",children:e.mediaDuration})]}):(0,t.jsx)("div",{className:"hidden md:flex w-full rounded-xl overflow-hidden min-h-[100px] lg:min-h-[120px] bg-gradient-to-br from-secondary to-border items-center justify-center transition-all duration-200 group-hover:from-border group-hover:to-secondary",children:(0,t.jsx)(g,{className:"w-8 h-8 lg:w-10 lg:h-10 text-muted-foreground/40 transition-all duration-200 group-hover:text-muted-foreground/60"})}))]})}var N=e.i(731846),S=e.i(431038);let C=(0,h.default)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),D=(0,h.default)("text-align-justify",[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]]);var T=e.i(214634),E=e.i(542960),L=e.i(809e3);let R=(0,h.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var I=e.i(629574),A=e.i(656455);function B({sources:e,searchQuery:a="",onSearchChange:s,onToggleSource:n,onOpenRssTool:o,isOffline:l=!1,realtimeStatus:d="connecting",layout:c="short",onLayoutChange:m}){let[u,x]=(0,r.useState)(!1),[h,g]=(0,r.useState)(!1),[p,f]=(0,r.useState)(null),b=(0,r.useRef)(null),y=(0,r.useRef)(null),v=e.filter(e=>!e.isHidden),w=e.filter(e=>e.isHidden);(0,r.useEffect)(()=>{u&&b.current&&b.current.focus()},[u]),(0,r.useEffect)(()=>{let e=e=>{y.current&&!y.current.contains(e.target)&&g(!1)};return h&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[h]);let k=async(e,t)=>{if(n){f(e);try{await n(e,!t)}finally{f(null)}}};return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1.5 sm:gap-2 max-w-3xl mx-auto mb-4 sm:mb-6 px-1",children:[l&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-amber-500/10 border border-amber-500/20 text-amber-600 dark:text-amber-400 text-xs font-medium animate-in fade-in duration-300",children:[(0,t.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"}),(0,t.jsx)(C,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:"Offline"})]}),!l&&(0,t.jsxs)("div",{className:`inline-flex items-center gap-1 px-2.5 py-1.5 rounded-lg text-xs font-medium
                               ${"connected"===d?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"error"===d?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"}`,title:"connected"===d?"Uppdateras i realtid":"error"===d?"Realtidsanslutning misslyckades":"Ansluter...",children:[(0,t.jsx)("span",{className:`w-1.5 h-1.5 rounded-full ${"connected"===d?"bg-green-500 animate-pulse":"error"===d?"bg-red-500":"bg-yellow-500"}`}),"connected"===d?"Live":"error"===d?"Realtid fel":"..."]}),(0,t.jsx)("div",{className:"relative flex items-center",children:u?(0,t.jsxs)("div",{className:"flex items-center gap-1.5 sm:gap-2 animate-in slide-in-from-right-2 duration-200",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(A.Input,{ref:b,type:"text",placeholder:"Sök...",value:a,onChange:e=>s(e.target.value),className:"w-40 sm:w-64 h-8 sm:h-9 pl-3 pr-8 text-sm bg-secondary/50 border-0 focus:bg-background focus:ring-1 focus:ring-border"}),a&&(0,t.jsx)("button",{onClick:()=>s(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:(0,t.jsx)(N.X,{className:"w-3.5 h-3.5"})})]}),(0,t.jsx)("button",{onClick:()=>{x(!1),s("")},className:"p-2 text-muted-foreground hover:text-foreground transition-colors",children:(0,t.jsx)(N.X,{className:"w-4 h-4"})})]}):(0,t.jsx)("button",{onClick:()=>x(!0),className:"p-2.5 rounded-lg text-muted-foreground hover:text-foreground hover:bg-secondary transition-all duration-200",title:"Sök",children:(0,t.jsx)(i.Search,{className:"w-4 h-4"})})}),(0,t.jsxs)("div",{className:"relative",ref:y,children:[(0,t.jsx)("button",{onClick:()=>o?o():g(!h),className:`p-2.5 rounded-lg transition-all duration-200
                               ${h?"text-foreground bg-secondary":"text-muted-foreground hover:text-foreground hover:bg-secondary"}`,title:"Nyhetsflöde-inställningar",children:(0,t.jsx)(S.Settings,{className:`w-4 h-4 transition-transform duration-300 ${h?"rotate-90":""}`})}),h&&(0,t.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-[calc(100vw-2rem)] sm:w-80 max-w-80 p-3 sm:p-4 rounded-xl z-50 glass shadow-xl animate-in fade-in slide-in-from-top-2 duration-200",children:[(0,t.jsxs)("h3",{className:"font-mono text-[11px] font-semibold uppercase tracking-widest text-muted-foreground mb-2",children:["Nyhetskällor (",v.length,")"]}),v.length>0?(0,t.jsx)("div",{className:"max-h-48 overflow-y-auto space-y-0.5",children:v.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between px-2 py-1.5 rounded-lg hover:bg-secondary/50 group transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,t.jsx)("div",{className:"w-5 h-5 rounded bg-secondary flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(I.Rss,{className:"w-3 h-3 text-muted-foreground"})}),(0,t.jsx)("span",{className:"text-sm truncate",children:e.sourceName}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.count,")"]})]}),n&&(0,t.jsx)("button",{onClick:()=>k(e.sourceId,!1),disabled:p===e.sourceId,className:"p-1.5 rounded text-muted-foreground/50 opacity-0 group-hover:opacity-100 hover:text-orange-600 hover:bg-orange-500/10 transition-all duration-200 disabled:opacity-50",title:"Dölj källa",children:(0,t.jsx)(R,{className:"w-3.5 h-3.5"})})]},e.sourceId))}):(0,t.jsx)("p",{className:"text-xs text-muted-foreground py-2",children:"Inga aktiva källor"}),w.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("h3",{className:"font-mono text-[11px] font-semibold uppercase tracking-widest text-muted-foreground mb-2 mt-4 pt-3 border-t border-border/50",children:["Dolda källor (",w.length,")"]}),(0,t.jsx)("div",{className:"max-h-32 overflow-y-auto space-y-0.5",children:w.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between px-2 py-1.5 rounded-lg bg-secondary/30 group transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,t.jsx)("div",{className:"w-5 h-5 rounded bg-secondary/50 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(I.Rss,{className:"w-3 h-3 text-muted-foreground/50"})}),(0,t.jsx)("span",{className:"text-sm truncate text-muted-foreground",children:e.sourceName})]}),n&&(0,t.jsx)("button",{onClick:()=>k(e.sourceId,!0),disabled:p===e.sourceId,className:"p-1.5 rounded text-muted-foreground hover:text-green-600 hover:bg-green-500/10 transition-all duration-200 disabled:opacity-50",title:"Visa källa igen",children:(0,t.jsx)(L.Eye,{className:"w-3.5 h-3.5"})})]},e.sourceId))})]}),(0,t.jsx)("p",{className:"text-[10px] text-muted-foreground/60 mt-3 pt-2 border-t border-border/30",children:"Dölj källor för att anpassa ditt nyhetsflöde. Dolda källor påverkar bara din vy."})]})]}),m&&(0,t.jsxs)("div",{className:"flex items-center gap-1 rounded-lg bg-secondary/60 p-1",children:[(0,t.jsx)("button",{onClick:()=>m("compact"),className:`p-1.5 rounded-md transition-colors ${"compact"===c?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,title:"Kompakt",children:(0,t.jsx)(D,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>m("short"),className:`p-1.5 rounded-md transition-colors ${"short"===c?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,title:"Kort",children:(0,t.jsx)(T.LayoutList,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>m("media"),className:`p-1.5 rounded-md transition-colors ${"media"===c?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,title:"Kort + bild",children:(0,t.jsx)(E.Image,{className:"w-4 h-4"})})]})]})}var M=e.i(954434),$=e.i(917171),U=e.i(136565);function O({article:e,onClose:a,onBookmark:s,onRead:n,onFollowTopic:o,onIgnoreTopic:i,onIgnoreSource:l}){let[c,m]=(0,r.useState)(null),[h,g]=(0,r.useState)(""),[p,f]=(0,r.useState)(null),[b,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&a()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a]),(0,r.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]);let v=e.mediaThumbnail||e.imageUrl,w=(0,r.useMemo)(()=>{let t=(e.content||e.description||"").replace(/<\s*br\s*\/?>/gi,"\n").replace(/<\/p>/gi,"\n\n");return(0,U.stripHtml)(t)},[e.content,e.description]),k=w.length>0,j=()=>{e.isRead||n?.(e.id)},S=async()=>{l&&await l(e.sourceId)},C=async e=>{if(e.preventDefault(),h.trim()){f(null),y(!0);try{"follow"===c?await o?.(h.trim())||f("Kunde inte följa ämnet"):"ignore"===c&&(await i?.(h.trim())||f("Kunde inte ignorera ämnet")),g(""),m(null)}catch{f("Något gick fel")}finally{y(!1)}}},D=new Date(e.publishedAt),T=Number.isNaN(D.getTime())?"Okänt datum":D.toLocaleString("sv-SE",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"});return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:e=>{e.target===e.currentTarget&&a()},children:(0,t.jsxs)("div",{className:"w-full max-w-3xl max-h-[85vh] bg-background rounded-2xl shadow-2xl border border-border overflow-hidden animate-scaleIn",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-5 sm:px-6 py-4 border-b border-border/60",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-muted-foreground",children:[(0,t.jsx)("span",{className:"font-medium text-foreground",children:e.sourceName}),(0,t.jsx)("span",{children:"•"}),(0,t.jsx)("span",{children:T})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>{navigator.share?.({url:e.url,title:e.title})},className:"p-2 rounded-lg text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors",title:"Dela",children:(0,t.jsx)($.Share2,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>{s?.(e.id)},className:"p-2 rounded-lg text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors",title:e.isBookmarked?"Ta bort Läs senare":"Läs senare",children:e.isBookmarked?(0,t.jsx)(x.BookmarkCheck,{className:"w-4 h-4"}):(0,t.jsx)(u.Bookmark,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:a,className:"p-2 rounded-lg text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors",title:"Stäng",children:(0,t.jsx)(N.X,{className:"w-4 h-4"})})]})]}),(0,t.jsxs)("div",{className:"overflow-y-auto max-h-[calc(85vh-64px)]",children:[v&&(0,t.jsx)("div",{className:"w-full max-h-80 overflow-hidden bg-secondary",children:(0,t.jsx)("img",{src:v,alt:"",className:"w-full h-full object-cover",loading:"lazy",decoding:"async"})}),(0,t.jsxs)("div",{className:"p-5 sm:p-6 space-y-4",children:[(0,t.jsx)("h2",{className:"text-lg sm:text-xl font-semibold leading-snug text-foreground",children:e.title}),e.author&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Av ",e.author]}),k?(0,t.jsx)("p",{className:"text-sm sm:text-[15px] leading-relaxed whitespace-pre-wrap text-foreground/90",children:w}):(0,t.jsx)("div",{className:"text-sm text-muted-foreground italic",children:"Inget innehåll tillgängligt i flödet ännu."}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 pt-2",children:[(0,t.jsxs)(d.Button,{onClick:()=>{j(),window.open(e.url,"_blank")},className:"gap-2",children:["Läs hos källa",(0,t.jsx)(M.ExternalLink,{className:"w-4 h-4"})]}),(0,t.jsx)(d.Button,{variant:"outline",onClick:j,children:"Markera som läst"}),(0,t.jsx)(d.Button,{variant:"outline",onClick:S,children:"Ignorera källa"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>m("follow"),children:"Följ ämne"}),(0,t.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>m("ignore"),children:"Ignorera ämne"})]}),c&&(0,t.jsxs)("form",{onSubmit:C,className:"flex flex-wrap gap-2 items-center",children:[(0,t.jsx)(A.Input,{value:h,onChange:e=>g(e.target.value),placeholder:"follow"===c?"Ämne att följa":"Ämne att ignorera",className:"w-full sm:w-64"}),(0,t.jsx)(d.Button,{type:"submit",size:"sm",disabled:b||!h.trim(),children:b?"Sparar...":"Spara"}),(0,t.jsx)(d.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>m(null),children:"Avbryt"}),p&&(0,t.jsx)("span",{className:"text-xs text-destructive",children:p})]})]})]})]})})}function z({label:e,articleCount:r}){return(0,t.jsxs)("div",{className:"flex items-center gap-4 py-2 animate-in fade-in duration-500",children:[(0,t.jsx)("span",{className:"font-mono text-[11px] font-semibold uppercase tracking-widest text-muted-foreground",children:e}),void 0!==r&&(0,t.jsxs)("span",{className:"text-[10px] text-muted-foreground/60",children:[r," ",1===r?"artikel":"artiklar"]}),(0,t.jsx)("div",{className:"flex-1 h-px bg-gradient-to-r from-border to-transparent"})]})}var P=e.i(637747),_=e.i(318057),F=e.i(488069),K=e.i(569394);function V(e){return e.split(/(\*\*[^*]+\*\*)/g).map((e,r)=>e.startsWith("**")&&e.endsWith("**")?(0,t.jsx)("strong",{className:"font-semibold text-foreground",children:e.slice(2,-2)},r):e)}function H({announcement:e,onRead:a,onFollowUp:s,onViewCompany:n,showGradientLine:o=!0}){let[i,l]=(0,r.useState)(!1),{time:d,day:c}=function(e){let t=new Date(e),r=new Date,a=t.toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"});if(t.toDateString()===r.toDateString())return{time:a};let s=new Date(r);if(s.setDate(s.getDate()-1),t.toDateString()===s.toDateString())return{time:a,day:"Igår"};let n=new Date(r);if(n.setDate(n.getDate()-7),t>n){let e=t.toLocaleDateString("sv-SE",{weekday:"short"});return{time:a,day:e.charAt(0).toUpperCase()+e.slice(1)}}return{time:a,day:t.toLocaleDateString("sv-SE",{day:"numeric",month:"short"})}}(e.publishedAt),m=function(e){switch(e){case"nyemission":return"Möjlig nyemission";case"likvidation":return"Likvidation";case"fusion":return"Fusion";case"kallelse":return"Kallelse till stämma";default:return"Kungörelse"}}(e.announcementType);return(0,t.jsxs)("article",{className:`
        group relative py-3 sm:py-4 md:py-5
        transition-all duration-200 ease-out
        ${e.isRead?"opacity-60":""}
      `,children:[o&&!i&&(0,t.jsx)("div",{className:"absolute bottom-0 left-[40px] sm:left-[48px] md:left-[60px] right-0 h-px opacity-50 bg-gradient-to-r from-border via-muted-foreground/30 to-transparent group-hover:opacity-0 transition-opacity"}),(0,t.jsxs)("button",{onClick:()=>{l(!i),i||e.isRead||a?.(e.id)},className:"w-full text-left grid gap-3 sm:gap-4 md:gap-5 grid-cols-[40px_1fr] sm:grid-cols-[48px_1fr] md:grid-cols-[60px_1fr] hover:bg-amber-50/50 dark:hover:bg-amber-950/20 hover:-mx-2 sm:hover:-mx-3 md:hover:-mx-4 hover:px-2 sm:hover:px-3 md:hover:px-4 hover:rounded-xl transition-all",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 sm:gap-3 pt-0.5 sm:pt-1",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-mono text-[10px] sm:text-[11px] font-medium text-muted-foreground tabular-nums",children:d}),c&&(0,t.jsx)("div",{className:"font-mono text-[9px] sm:text-[10px] text-muted-foreground/70 mt-0.5 tabular-nums",children:c})]}),(0,t.jsx)("div",{className:"w-6 h-6 sm:w-7 sm:h-7 rounded-md overflow-hidden bg-amber-100 dark:bg-amber-900/40 flex items-center justify-center transition-transform group-hover:scale-110",children:(0,t.jsx)(F.Bell,{className:"w-3.5 h-3.5 text-amber-600 dark:text-amber-400"})})]}),(0,t.jsxs)("div",{className:"min-w-0 flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-1",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("span",{className:"inline-flex items-center gap-1 text-xs font-medium px-2 py-0.5 rounded-md bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300",children:m})}),(0,t.jsx)("div",{className:"flex-shrink-0 text-muted-foreground",children:i?(0,t.jsx)(_.ChevronUp,{className:"w-4 h-4"}):(0,t.jsx)(P.ChevronDown,{className:"w-4 h-4"})})]}),(0,t.jsx)("h2",{className:"text-[15px] sm:text-[16px] md:text-[17px] font-semibold leading-snug text-foreground",children:e.companyName}),!i&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-1",children:e.title})]})]}),i&&(0,t.jsxs)("div",{className:"mt-3 ml-[40px] sm:ml-[48px] md:ml-[60px] pl-3 sm:pl-4 md:pl-5 border-l-2 border-amber-200 dark:border-amber-800 bg-amber-50/30 dark:bg-amber-950/10 rounded-r-xl py-4 pr-4",children:[(0,t.jsx)("div",{className:"prose-sm",children:function(e){let r=e.split("\n"),a=[],s=0,n=0;for(;s<r.length;){let e=r[s],o=`md-${n++}`;if(""===e.trim()){s++;continue}if(e.startsWith("## ")){a.push((0,t.jsx)("h3",{className:"text-base font-semibold text-foreground mt-4 mb-2 first:mt-0",children:V(e.slice(3))},o)),s++;continue}if(e.startsWith("### ")){a.push((0,t.jsx)("h4",{className:"text-sm font-semibold text-foreground mt-3 mb-1.5",children:V(e.slice(4))},o)),s++;continue}if(e.includes("|")&&s+1<r.length&&r[s+1].includes("|")&&r[s+1].includes("-")){let n=[e],i=s+1;for(;i<r.length&&r[i].includes("|");)n.push(r[i]),i++;let l=n[0].split("|").map(e=>e.trim()).filter(e=>e),d=n.slice(2).map(e=>e.split("|").map(e=>e.trim()).filter(e=>e));a.push((0,t.jsx)("div",{className:"my-3 overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm border-collapse",children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{className:"border-b border-border",children:l.map((e,r)=>(0,t.jsx)("th",{className:"text-left py-1.5 px-2 font-medium text-muted-foreground",children:e},r))})}),(0,t.jsx)("tbody",{children:d.map((e,r)=>(0,t.jsx)("tr",{className:"border-b border-border/50",children:e.map((e,r)=>(0,t.jsx)("td",{className:"py-1.5 px-2 text-foreground/80",children:V(e)},r))},r))})]})},o)),s=i;continue}if(e.startsWith("- ")){let n=[e.slice(2)],i=s+1;for(;i<r.length&&r[i].startsWith("- ");)n.push(r[i].slice(2)),i++;a.push((0,t.jsx)("ul",{className:"my-2 space-y-1",children:n.map((e,r)=>(0,t.jsxs)("li",{className:"text-sm text-foreground/80 flex items-start gap-2",children:[(0,t.jsx)("span",{className:"text-amber-500 mt-1.5",children:"•"}),(0,t.jsx)("span",{children:V(e)})]},r))},o)),s=i;continue}a.push((0,t.jsx)("p",{className:"text-sm text-foreground/80 leading-relaxed my-2",children:V(e)},o)),s++}return a}(e.interpretation)}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-amber-200/50 dark:border-amber-800/50",children:[(0,t.jsxs)("a",{href:e.announcementUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-lg bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300 hover:bg-amber-200 dark:hover:bg-amber-900/60 transition-colors",children:[(0,t.jsx)(M.ExternalLink,{className:"w-3.5 h-3.5"}),"Öppna kungörelse"]}),s&&(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),s(e)},className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-lg bg-amber-600 text-white hover:bg-amber-700 transition-colors",children:"Följ upp"}),n&&(0,t.jsxs)("button",{onClick:t=>{t.stopPropagation(),n(e.orgNumber)},className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-lg bg-secondary text-secondary-foreground hover:bg-secondary/80 transition-colors",children:[(0,t.jsx)(K.Building2,{className:"w-3.5 h-3.5"}),"Visa bolag"]})]}),(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-3 text-xs text-muted-foreground",children:[(0,t.jsxs)("span",{children:["Kungörelse-ID: ",e.announcementId]}),(0,t.jsxs)("span",{children:["Org.nr: ",e.orgNumber]})]})]})]})}let W={id:"announcement-voi-k7420-26",type:"announcement",title:"Kallelse till extra bolagsstämma med förslag om nyemission",interpretation:`## Tolkning av kung\xf6relsen

**Voi Technology AB** kallar till **extra bolagsst\xe4mma** den 27 januari 2026 kl. 11.00 p\xe5 huvudkontoret i Stockholm.

### Huvud\xe4rende: Riktad nyemission

Styrelsen f\xf6resl\xe5r en riktad emission av **1 040 000 preferensaktier** (serie C SuperStam) till ledande befattningshavare:

| Mottagare | Antal aktier |
|-----------|--------------|
| CPO | 400 000 |
| CBO | 300 000 |
| Regionchef 1 | 150 000 |
| Regionchef 2 | 100 000 |
| F\xf6re detta marknadsanst\xe4lld | 50 000 |
| CTO | 40 000 |

**Teckningskurs:** 0,10 USD per aktie (totalt ~104 000 USD f\xf6r hela emissionen)

### V\xe4sentliga villkor

- Kr\xe4ver 90% majoritet (r\xf6ster och aktier) f\xf6r godk\xe4nnande
- Aktierna har hembudsf\xf6rbeh\xe5ll och omvandlingsf\xf6rbeh\xe5ll
- Teckning inom 15 arbetsdagar, betalning inom 4 veckor
- Aktiekapital\xf6kning: max 6 459,63 kr

### Noterbart

Detta \xe4r en incitamentsemission till ledningsgruppen. Den l\xe5ga teckningskursen (0,10 USD) kombinerat med preferensaktier av serie C SuperStam tyder p\xe5 ett optionslikt uppl\xe4gg d\xe4r v\xe4rdet realiseras vid framtida likviditetsevent (exit/b\xf6rsnotering). Att en f\xf6re detta anst\xe4lld inkluderas kan indikera en uppg\xf6relse eller tidigare utf\xe4stelse.`,companyName:"Voi Technology AB",orgNumber:"559160-8031",announcementUrl:"https://poit.bolagsverket.se/poit-app/kungorelse/K7420-26",announcementId:"K7420-26",announcementType:"nyemission",publishedAt:new Date,isRead:!1};var J=e.i(751987),q=e.i(275740);function X(){let e=(0,a.useRouter)(),[o,i]=(0,r.useState)([]),[l,c]=(0,r.useState)([]),[u,x]=(0,r.useState)([]),[h,g]=(0,r.useState)(null),[p,f]=(0,r.useState)(!0),[b,y]=(0,r.useState)(!1),[v,w]=(0,r.useState)(null),[k,N]=(0,r.useState)(null),[S,C]=(0,r.useState)(!1),[D,T]=(0,r.useState)(""),[E,L]=(0,r.useState)(),[R,I]=(0,r.useState)(),[A,M]=(0,r.useState)(!1),[$,U]=(0,r.useState)(!1),[P,_]=(0,r.useState)(-1),[F,K]=(0,r.useState)(!1),[V,X]=(0,r.useState)("connecting"),[Y,G]=(0,r.useState)("short"),[Q,Z]=(0,r.useState)(null),[ee,et]=(0,r.useState)(!1),er=(0,r.useRef)(null),ea=(0,r.useRef)(null),es=(0,r.useRef)([]),en=(0,r.useRef)(null),eo=(0,r.useCallback)(async(e,t=!1)=>{try{t?y(!0):f(!0),w(null);let r=new URLSearchParams;r.set("limit","30"),D&&r.set("query",D),E&&r.set("sourceId",E),R&&r.set("companyId",R),A&&r.set("isBookmarked","true"),$&&r.set("isRead","false"),e&&r.set("cursor",e),D||E||R||A||$||e?r.set("fast","false"):r.set("fast","true");let a=await fetch(`/api/nyheter?${r.toString()}`);if(!a.ok)throw Error("Failed to fetch articles");let s=await a.json();t?i(e=>[...e,...s.articles]):i(s.articles),c(s.sources||[]),g(s.stats||null),N(s.nextCursor),C(s.hasMore)}catch(e){w(e instanceof Error?e.message:"Unknown error")}finally{f(!1),y(!1)}},[D,E,R,A,$]),ei=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/bevakning?limit=200");if(e.ok){let t=await e.json();x(t.companies.map(e=>({id:e.id,name:e.name,orgNumber:e.orgNumber})))}}catch{}},[]);(0,r.useEffect)(()=>{eo(),ei()},[]),(0,r.useEffect)(()=>{let e=()=>K(!1),t=()=>K(!0);return K(!navigator.onLine),window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]),(0,r.useEffect)(()=>{let e=window.localStorage.getItem("newsLayout");e&&G(e)},[]),(0,r.useEffect)(()=>{window.localStorage.setItem("newsLayout",Y)},[Y]),(0,r.useEffect)(()=>{F?X("error"):X("connecting")},[F]);let el=(0,r.useCallback)(e=>{if(R)return!1;if(D){let t=D.toLowerCase();if(!`${e.title} ${e.description||""}`.toLowerCase().includes(t))return!1}return(!E||e.sourceId===E)&&(!A||!!e.isBookmarked)&&(!$||!e.isRead)},[D,R,E,A,$]),ed=(0,r.useCallback)(e=>{g(t=>{if(!t)return t;let r=new Date(e.publishedAt),a=new Date,s=r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()&&r.getDate()===a.getDate();return{...t,total:t.total+1,unread:t.unread+ +!e.isRead,bookmarked:t.bookmarked+ +!!e.isBookmarked,today:t.today+ +!!s}}),c(t=>{let r=t.findIndex(t=>t.sourceId===e.sourceId);return -1===r?t:t.map((e,t)=>t===r?{...e,count:e.count+1}:e)})},[]),ec=(0,r.useCallback)(e=>({id:e.id,url:e.url,title:e.title,description:e.description,content:void 0,author:void 0,imageUrl:e.imageUrl,mediaThumbnail:null,publishedAt:e.publishedAt,sourceName:e.sourceName,sourceId:e.sourceId,sourceType:e.sourceType,sourceColor:e.sourceColor??null,isRead:e.isRead??!1,isBookmarked:e.isBookmarked??!1,keywordMatches:void 0,companyMatches:void 0}),[]);!function({onNewArticle:e,onArticleDeleted:t,onArticleUpdated:a,onNewArticlesCount:s,onStatusChange:n,enabled:o=!0}={}){let[i,l]=(0,r.useState)(null),d=(0,r.useRef)(null),c=(0,r.useRef)(0),m=(0,r.useRef)(null),u=(0,r.useCallback)(()=>{c.current>0&&s&&(s(c.current),c.current=0)},[s]);(0,r.useEffect)(()=>{if(!o)return;let e=!0;return n?.("connecting"),async function(){let t=await (0,q.getSupabaseClient)();e&&t?l(t):e&&(console.warn("[Realtime] Supabase not configured, skipping realtime subscription"),n?.("error"))}(),()=>{e=!1}},[o,n]),(0,r.useEffect)(()=>{if(!o||!i)return;let r=!0;return d.current=i.channel("article-changes").on("postgres_changes",{event:"*",schema:"public",table:"Article"},r=>{let s=r.eventType;"INSERT"===s?(console.log("[Realtime] New article:",r.new?.title),e&&r.new&&e(r.new),c.current++,m.current&&clearTimeout(m.current),m.current=setTimeout(u,2e3)):"DELETE"===s?(console.log("[Realtime] Article deleted:",r.old?.id),t&&r.old?.id&&t(r.old.id)):"UPDATE"===s&&(console.log("[Realtime] Article updated:",r.new?.title),a&&r.new&&a(r.new))}).subscribe(e=>{r&&("SUBSCRIBED"===e?(console.log("[Realtime] Subscribed to Article changes (INSERT/UPDATE/DELETE)"),n?.("connected")):"CHANNEL_ERROR"===e?(console.error("[Realtime] Failed to subscribe to Article changes"),n?.("error")):("TIMED_OUT"===e||"CLOSED"===e)&&n?.("error"))}),()=>{r=!1,m.current&&clearTimeout(m.current),d.current&&i&&(i.removeChannel(d.current),d.current=null)}},[o,i,e,t,a,u,n])}({enabled:!F,onStatusChange:X,onNewArticle:(0,r.useCallback)(e=>{let t=ec(e),r=el(t);ed(t),r&&i(e=>e.some(e=>e.id===t.id)?e:[t,...e])},[el,ec,ed]),onArticleDeleted:(0,r.useCallback)(e=>{console.log("[Realtime] Removing article from feed:",e),i(t=>t.filter(t=>t.id!==e))},[]),onArticleUpdated:(0,r.useCallback)(e=>{console.log("[Realtime] Updating article in feed:",e.title),i(t=>t.map(t=>t.id===e.id?{...t,...e}:t))},[])}),(0,r.useEffect)(()=>(ea.current&&clearTimeout(ea.current),ea.current=setTimeout(()=>{eo(),_(-1)},300),()=>{ea.current&&clearTimeout(ea.current)}),[D,E,R,A,$]),(0,r.useEffect)(()=>{let e=new IntersectionObserver(e=>{e[0].isIntersecting&&S&&!b&&k&&eo(k,!0)},{threshold:.1});return er.current&&e.observe(er.current),()=>e.disconnect()},[S,b,k,eo]),(0,r.useEffect)(()=>{let e=e=>{if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement))switch(e.key){case"ArrowDown":case"j":e.preventDefault(),_(e=>{let t=e+1;return t<o.length?(es.current[t]?.scrollIntoView({behavior:"smooth",block:"center"}),t):e});break;case"ArrowUp":case"k":e.preventDefault(),_(e=>{let t=e-1;return t>=0?(es.current[t]?.scrollIntoView({behavior:"smooth",block:"center"}),t):-1===e?-1:0});break;case"Enter":case"o":if(P>=0&&P<o.length){e.preventDefault();let t=o[P];ep(t.id),window.open(t.url,"_blank")}break;case"b":P>=0&&P<o.length&&(e.preventDefault(),eg(o[P].id));break;case"r":P>=0&&P<o.length&&(e.preventDefault(),ep(o[P].id));break;case"Escape":_(-1)}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[o,P]);let em=async e=>{try{if((await fetch("/api/nyheter/keywords",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({term:e})})).ok)return await eo(),!0;return!1}catch{return!1}},eu=async e=>{try{if((await fetch("/api/nyheter/ignore/terms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({term:e})})).ok)return await eo(),!0;return!1}catch{return!1}},ex=async e=>{try{if((await fetch("/api/nyheter/ignore/sources",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceId:e})})).ok)return await eo(),!0;return!1}catch{return!1}},eh=async(e,t)=>{try{t?await fetch("/api/nyheter/ignore/sources",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceId:e})}):await fetch("/api/nyheter/ignore/sources",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceId:e})}),await eo()}catch{}},eg=async e=>{i(t=>t.map(t=>t.id===e?{...t,isBookmarked:!t.isBookmarked}:t));try{await fetch(`/api/nyheter/${e}/bookmark`,{method:"POST"})}catch{i(t=>t.map(t=>t.id===e?{...t,isBookmarked:!t.isBookmarked}:t))}},ep=async e=>{i(t=>t.map(t=>t.id===e?{...t,isRead:!0}:t));try{await fetch(`/api/nyheter/${e}/read`,{method:"POST"})}catch{}},ef=t=>{e.push(`/bolag/${t}`)},eb=async e=>{if(Z(e),et(!0),e.isRead||await ep(e.id),void 0===e.content)try{let t=await fetch(`/api/nyheter/${e.id}`);if(t.ok){let r=await t.json();Z(t=>t&&t.id===e.id?{...t,...r}:t)}}catch{}};if(p)return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(B,{sources:[],onSearchChange:()=>{},onSourceChange:()=>{},onBookmarkedChange:()=>{},onUnreadChange:()=>{},isOffline:F,realtimeStatus:V,layout:Y,onLayoutChange:G}),(0,t.jsx)("div",{className:"flex flex-col gap-6 max-w-3xl mx-auto",children:Array.from({length:4}).map((e,r)=>(0,t.jsxs)("div",{className:"bg-card rounded-2xl border p-6 space-y-4 animate-in fade-in duration-300",style:{animationDelay:`${100*r}ms`},children:[(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)(J.Skeleton,{shimmer:!0,className:"w-16 h-16 rounded-lg flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(J.Skeleton,{shimmer:!0,className:"h-5 w-24"}),(0,t.jsx)(J.Skeleton,{shimmer:!0,className:"h-4 w-20"})]}),(0,t.jsx)(J.Skeleton,{shimmer:!0,className:"h-6 w-full"}),(0,t.jsx)(J.Skeleton,{shimmer:!0,className:"h-6 w-4/5"})]})]}),(0,t.jsx)(J.Skeleton,{shimmer:!0,className:"h-20 w-full"})]},r))})]});if(v)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,t.jsx)(n.AlertCircle,{className:"w-12 h-12 text-destructive mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Kunde inte ladda nyheter"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:v}),(0,t.jsx)(d.Button,{onClick:()=>eo(),children:"Försök igen"})]});if(0===o.length){let e=!!(D||E||R||A||$);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(B,{sources:l,searchQuery:D,onSearchChange:T,onSourceChange:L,onBookmarkedChange:M,onUnreadChange:U,onToggleSource:eh,isOffline:F,realtimeStatus:V,layout:Y,onLayoutChange:G}),(0,t.jsx)(m,{hasFilters:e})]})}return(0,t.jsxs)("div",{className:"space-y-6",ref:en,children:[(0,t.jsx)(B,{sources:l,searchQuery:D,onSearchChange:T,onSourceChange:L,onBookmarkedChange:M,onUnreadChange:U,onToggleSource:eh,isOffline:F,realtimeStatus:V,layout:Y,onLayoutChange:G}),(0,t.jsx)("div",{className:"flex flex-col max-w-3xl mx-auto",children:(function(e){let t=new Date,r=t.toDateString(),a=new Date(t);a.setDate(a.getDate()-1);let s=a.toDateString(),n=new Date(t);n.setDate(n.getDate()-7);let o=new Map;for(let a of e){let e,i,l=new Date(a.publishedAt),d=l.toDateString();if(d===r)e="Idag",i=0;else if(d===s)e="Igår",i=1;else if(l>n)e="Denna vecka",i=2;else{let r=l.toLocaleDateString("sv-SE",{month:"long",year:"numeric"});e=r.charAt(0).toUpperCase()+r.slice(1),i=100-Math.floor((t.getTime()-l.getTime())/2592e6)}o.has(e)||o.set(e,{label:e,articles:[],sortKey:i}),o.get(e).articles.push(a)}return Array.from(o.values()).sort((e,t)=>e.sortKey-t.sortKey).map(({label:e,articles:t})=>({label:e,articles:t}))})([...o.map(e=>({...e,type:"article"})),W].sort((e,t)=>new Date(t.publishedAt).getTime()-new Date(e.publishedAt).getTime())).map(e=>(0,t.jsxs)("div",{children:[(0,t.jsx)(z,{label:e.label,articleCount:e.articles.length}),(0,t.jsx)("div",{className:"flex flex-col",children:e.articles.map(e=>{if("announcement"===e.type)return(0,t.jsx)(H,{announcement:e,onRead:ep,onViewCompany:ef,onFollowUp:e=>{console.log("Följ upp:",e.companyName)},showGradientLine:!0},e.id);let r=o.findIndex(t=>t.id===e.id);return(0,t.jsx)("div",{ref:e=>{es.current[r]=e},children:(0,t.jsx)(j,{article:e,onBookmark:eg,onRead:ep,onViewCompany:ef,onOpen:eb,layout:Y,isFocused:P===r,showGradientLine:!0})},e.id)})})]},e.label))}),S&&(0,t.jsx)("div",{ref:er,className:"flex justify-center py-8",children:b?(0,t.jsx)(s.Loader2,{className:"w-6 h-6 animate-spin text-muted-foreground"}):(0,t.jsx)(d.Button,{variant:"outline",onClick:()=>eo(k,!0),children:"Ladda fler"})}),ee&&Q&&(0,t.jsx)(O,{article:Q,onClose:()=>{et(!1),Z(null)},onBookmark:eg,onRead:ep,onFollowTopic:em,onIgnoreTopic:eu,onIgnoreSource:ex})]})}e.s(["NewsFeed",()=>X],347712)}]);

//# debugId=74c627e2-1d73-bec6-d54b-4a435cd27773
//# sourceMappingURL=43c6b947e68e8af8.js.map